<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>pymatgen.io.tests.test_qchem &#8212; pymatgen 4.5.2 documentation</title>
    
    <link rel="stylesheet" href="../../../../_static/proBlue.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../../',
        VERSION:     '4.5.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="../../../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="top" title="pymatgen 4.5.2 documentation" href="../../../../index.html" />
    <link rel="up" title="Module code" href="../../../index.html" />
 
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-33990148-1']);
  _gaq.push(['_trackPageview']);
</script>

  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../../index.html">pymatgen 4.5.2 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../../index.html" accesskey="U">Module code</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for pymatgen.io.tests.test_qchem</h1><div class="highlight"><pre>
<span></span><span class="c1"># coding: utf-8</span>
<span class="c1"># Copyright (c) Pymatgen Development Team.</span>
<span class="c1"># Distributed under the terms of the MIT License.</span>

<span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">unicode_literals</span>

<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">unittest</span> <span class="k">import</span> <span class="n">TestCase</span>
<span class="kn">import</span> <span class="nn">unittest2</span> <span class="k">as</span> <span class="nn">unittest</span>

<span class="kn">from</span> <span class="nn">pymatgen</span> <span class="k">import</span> <span class="n">Molecule</span>
<span class="kn">from</span> <span class="nn">pymatgen.io.qchem</span> <span class="k">import</span> <span class="n">QcTask</span><span class="p">,</span> <span class="n">QcInput</span><span class="p">,</span> <span class="n">QcOutput</span>
<span class="kn">from</span> <span class="nn">pymatgen.util.testing</span> <span class="k">import</span> <span class="n">PymatgenTest</span>

<span class="n">__author__</span> <span class="o">=</span> <span class="s1">&#39;xiaohuiqu&#39;</span>


<span class="n">test_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">__file__</span><span class="p">),</span> <span class="s2">&quot;..&quot;</span><span class="p">,</span> <span class="s2">&quot;..&quot;</span><span class="p">,</span> <span class="s2">&quot;..&quot;</span><span class="p">,</span>
                        <span class="s1">&#39;test_files&#39;</span><span class="p">,</span> <span class="s2">&quot;molecules&quot;</span><span class="p">)</span>


<span class="n">coords</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.000000</span><span class="p">,</span> <span class="mf">0.000000</span><span class="p">,</span> <span class="mf">0.000000</span><span class="p">],</span>
          <span class="p">[</span><span class="mf">0.000000</span><span class="p">,</span> <span class="mf">0.000000</span><span class="p">,</span> <span class="mf">1.089000</span><span class="p">],</span>
          <span class="p">[</span><span class="mf">1.026719</span><span class="p">,</span> <span class="mf">0.000000</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.363000</span><span class="p">],</span>
          <span class="p">[</span><span class="o">-</span><span class="mf">0.513360</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.889165</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.363000</span><span class="p">],</span>
          <span class="p">[</span><span class="o">-</span><span class="mf">0.513360</span><span class="p">,</span> <span class="mf">0.889165</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.363000</span><span class="p">]]</span>
<span class="n">mol</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">([</span><span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="s2">&quot;H&quot;</span><span class="p">,</span> <span class="s2">&quot;H&quot;</span><span class="p">,</span> <span class="s2">&quot;H&quot;</span><span class="p">,</span> <span class="s2">&quot;Cl&quot;</span><span class="p">],</span> <span class="n">coords</span><span class="p">)</span>

<span class="n">coords2</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.4</span><span class="p">],</span>
           <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
           <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">2.4</span><span class="p">]]</span>
<span class="n">heavy_mol</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">([</span><span class="s2">&quot;Br&quot;</span><span class="p">,</span> <span class="s2">&quot;Cd&quot;</span><span class="p">,</span> <span class="s2">&quot;Br&quot;</span><span class="p">],</span> <span class="n">coords2</span><span class="p">)</span>

<span class="n">coords3</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">2.632273</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.313504</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.750376</span><span class="p">],</span>
           <span class="p">[</span><span class="mf">3.268182</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.937310</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.431464</span><span class="p">],</span>
           <span class="p">[</span><span class="mf">2.184198</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.753305</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.469059</span><span class="p">]]</span>

<span class="n">water_mol</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">([</span><span class="s2">&quot;O&quot;</span><span class="p">,</span> <span class="s2">&quot;H&quot;</span><span class="p">,</span> <span class="s2">&quot;H&quot;</span><span class="p">],</span> <span class="n">coords3</span><span class="p">)</span>


<div class="viewcode-block" id="QcTaskTest"><a class="viewcode-back" href="../../../../pymatgen.io.tests.test_qchem.html#pymatgen.io.tests.test_qchem.QcTaskTest">[docs]</a><span class="k">class</span> <span class="nc">QcTaskTest</span><span class="p">(</span><span class="n">PymatgenTest</span><span class="p">):</span>

<div class="viewcode-block" id="QcTaskTest.elementary_io_verify"><a class="viewcode-back" href="../../../../pymatgen.io.tests.test_qchem.html#pymatgen.io.tests.test_qchem.QcTaskTest.elementary_io_verify">[docs]</a>    <span class="k">def</span> <span class="nf">elementary_io_verify</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">qctask</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">to_and_from_dict_verify</span><span class="p">(</span><span class="n">qctask</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">from_string_verify</span><span class="p">(</span><span class="n">contents</span><span class="o">=</span><span class="n">text</span><span class="p">,</span> <span class="n">ref_dict</span><span class="o">=</span><span class="n">qctask</span><span class="o">.</span><span class="n">as_dict</span><span class="p">())</span></div>

<div class="viewcode-block" id="QcTaskTest.to_and_from_dict_verify"><a class="viewcode-back" href="../../../../pymatgen.io.tests.test_qchem.html#pymatgen.io.tests.test_qchem.QcTaskTest.to_and_from_dict_verify">[docs]</a>    <span class="k">def</span> <span class="nf">to_and_from_dict_verify</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">qctask</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Helper function. This function should be called in each specific test.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">d1</span> <span class="o">=</span> <span class="n">qctask</span><span class="o">.</span><span class="n">as_dict</span><span class="p">()</span>
        <span class="n">qc2</span> <span class="o">=</span> <span class="n">QcTask</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">d1</span><span class="p">)</span>
        <span class="n">d2</span> <span class="o">=</span> <span class="n">qc2</span><span class="o">.</span><span class="n">as_dict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d1</span><span class="p">,</span> <span class="n">d2</span><span class="p">)</span></div>

<div class="viewcode-block" id="QcTaskTest.from_string_verify"><a class="viewcode-back" href="../../../../pymatgen.io.tests.test_qchem.html#pymatgen.io.tests.test_qchem.QcTaskTest.from_string_verify">[docs]</a>    <span class="k">def</span> <span class="nf">from_string_verify</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">contents</span><span class="p">,</span> <span class="n">ref_dict</span><span class="p">):</span>
        <span class="n">qctask</span> <span class="o">=</span> <span class="n">QcTask</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="n">contents</span><span class="p">)</span>
        <span class="n">d2</span> <span class="o">=</span> <span class="n">qctask</span><span class="o">.</span><span class="n">as_dict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ref_dict</span><span class="p">,</span> <span class="n">d2</span><span class="p">)</span></div>

<div class="viewcode-block" id="QcTaskTest.test_read_zmatrix"><a class="viewcode-back" href="../../../../pymatgen.io.tests.test_qchem.html#pymatgen.io.tests.test_qchem.QcTaskTest.test_read_zmatrix">[docs]</a>    <span class="k">def</span> <span class="nf">test_read_zmatrix</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">contents</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;$moLEcule</span>

<span class="s1"> 1 2</span>

<span class="s1"> S</span>
<span class="s1"> C  1 1.726563</span>
<span class="s1"> H  2 1.085845 1 119.580615</span>
<span class="s1"> C  2 1.423404 1 114.230851 3 -180.000000 0</span>
<span class="s1"> H  4 1.084884 2 122.286346 1 -180.000000 0</span>
<span class="s1"> C  4 1.381259 2 112.717365 1 0.000000 0</span>
<span class="s1"> H  6 1.084731 4 127.143779 2 -180.000000 0</span>
<span class="s1"> C  6 1.415867 4 110.076147 2 0.000000 0</span>
<span class="s1"> F  8 1.292591 6 124.884374 4 -180.000000 0</span>
<span class="s1">$end</span>

<span class="s1">$reM</span>
<span class="s1">   BASIS  =  6-31+G*</span>
<span class="s1">   EXCHANGE  =  B3LYP</span>
<span class="s1">   jobtype  =  freq</span>
<span class="s1">$end</span>

<span class="s1">&#39;&#39;&#39;</span>
        <span class="n">qctask</span> <span class="o">=</span> <span class="n">QcTask</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="n">contents</span><span class="p">)</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;$molecule</span>
<span class="s1"> 1  2</span>
<span class="s1"> S           0.00000000        0.00000000        0.00000000</span>
<span class="s1"> C           0.00000000        0.00000000        1.72656300</span>
<span class="s1"> H          -0.94431813        0.00000000        2.26258784</span>
<span class="s1"> C           1.29800105       -0.00000002        2.31074808</span>
<span class="s1"> H           1.45002821       -0.00000002        3.38492732</span>
<span class="s1"> C           2.30733813       -0.00000003        1.36781908</span>
<span class="s1"> H           3.37622632       -0.00000005        1.55253338</span>
<span class="s1"> C           1.75466906       -0.00000003        0.06427152</span>
<span class="s1"> F           2.44231414       -0.00000004       -1.03023099</span>
<span class="s1">$end</span>


<span class="s1">$rem</span>
<span class="s1">   jobtype = freq</span>
<span class="s1">  exchange = b3lyp</span>
<span class="s1">     basis = 6-31+g*</span>
<span class="s1">$end</span>

<span class="s1">&#39;&#39;&#39;</span>
        <span class="n">ans_tokens</span> <span class="o">=</span> <span class="n">ans</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">ans_text_part</span> <span class="o">=</span> <span class="n">ans_tokens</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">ans_tokens</span><span class="p">[</span><span class="mi">11</span><span class="p">:]</span>
        <span class="n">ans_coords_part</span> <span class="o">=</span> <span class="n">ans_tokens</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">11</span><span class="p">]</span>
        <span class="n">converted_tokens</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">qctask</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">converted_text_part</span> <span class="o">=</span> <span class="n">converted_tokens</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">converted_tokens</span><span class="p">[</span><span class="mi">11</span><span class="p">:]</span>
        <span class="n">converted_coords_part</span> <span class="o">=</span> <span class="n">converted_tokens</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">11</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ans_text_part</span><span class="p">,</span> <span class="n">converted_text_part</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">ans_coords</span><span class="p">,</span> <span class="n">converted_coords</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ans_coords_part</span><span class="p">,</span>
                                                <span class="n">converted_coords_part</span><span class="p">):</span>
            <span class="n">ans_coords_tokens</span> <span class="o">=</span> <span class="n">ans_coords</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
            <span class="n">converted_coords_tokens</span> <span class="o">=</span> <span class="n">converted_coords</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ans_coords_tokens</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">converted_coords_tokens</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">xyz1</span> <span class="o">=</span> <span class="n">ans_coords_tokens</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
            <span class="n">xyz2</span> <span class="o">=</span> <span class="n">converted_coords_tokens</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
            <span class="k">for</span> <span class="n">t1</span><span class="p">,</span> <span class="n">t2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">xyz1</span><span class="p">,</span> <span class="n">xyz2</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">t1</span><span class="p">)</span><span class="o">-</span><span class="nb">float</span><span class="p">(</span><span class="n">t2</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mf">0.0001</span><span class="p">)</span></div>

<div class="viewcode-block" id="QcTaskTest.test_no_mol"><a class="viewcode-back" href="../../../../pymatgen.io.tests.test_qchem.html#pymatgen.io.tests.test_qchem.QcTaskTest.test_no_mol">[docs]</a>    <span class="k">def</span> <span class="nf">test_no_mol</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;$comment</span>
<span class="s1"> Test Methane</span>
<span class="s1">$end</span>


<span class="s1">$molecule</span>
<span class="s1"> -1  2</span>
<span class="s1"> read</span>
<span class="s1">$end</span>


<span class="s1">$rem</span>
<span class="s1">   jobtype = sp</span>
<span class="s1">  exchange = b3lyp</span>
<span class="s1">     basis = 6-31+g*</span>
<span class="s1">$end</span>

<span class="s1">&#39;&#39;&#39;</span>
        <span class="n">qctask</span> <span class="o">=</span> <span class="n">QcTask</span><span class="p">(</span><span class="n">molecule</span><span class="o">=</span><span class="s2">&quot;READ&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Test Methane&quot;</span><span class="p">,</span>
                        <span class="n">exchange</span><span class="o">=</span><span class="s2">&quot;B3LYP&quot;</span><span class="p">,</span> <span class="n">jobtype</span><span class="o">=</span><span class="s2">&quot;SP&quot;</span><span class="p">,</span> <span class="n">charge</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
                        <span class="n">spin_multiplicity</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                        <span class="n">basis_set</span><span class="o">=</span><span class="s2">&quot;6-31+G*&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">qctask</span><span class="p">),</span> <span class="n">ans</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">elementary_io_verify</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="n">qctask</span><span class="p">)</span></div>

<div class="viewcode-block" id="QcTaskTest.test_simple_basis_str"><a class="viewcode-back" href="../../../../pymatgen.io.tests.test_qchem.html#pymatgen.io.tests.test_qchem.QcTaskTest.test_simple_basis_str">[docs]</a>    <span class="k">def</span> <span class="nf">test_simple_basis_str</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;$comment</span>
<span class="s1"> Test Methane</span>
<span class="s1">$end</span>


<span class="s1">$molecule</span>
<span class="s1"> 0  1</span>
<span class="s1"> C           0.00000000        0.00000000        0.00000000</span>
<span class="s1"> H           0.00000000        0.00000000        1.08900000</span>
<span class="s1"> H           1.02671900        0.00000000       -0.36300000</span>
<span class="s1"> H          -0.51336000       -0.88916500       -0.36300000</span>
<span class="s1"> Cl         -0.51336000        0.88916500       -0.36300000</span>
<span class="s1">$end</span>


<span class="s1">$rem</span>
<span class="s1">   jobtype = sp</span>
<span class="s1">  exchange = b3lyp</span>
<span class="s1">     basis = 6-31+g*</span>
<span class="s1">$end</span>

<span class="s1">&#39;&#39;&#39;</span>
        <span class="n">qctask</span> <span class="o">=</span> <span class="n">QcTask</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Test Methane&quot;</span><span class="p">,</span> <span class="n">exchange</span><span class="o">=</span><span class="s2">&quot;B3LYP&quot;</span><span class="p">,</span>
                        <span class="n">jobtype</span><span class="o">=</span><span class="s2">&quot;SP&quot;</span><span class="p">,</span>
                        <span class="n">basis_set</span><span class="o">=</span><span class="s2">&quot;6-31+G*&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">qctask</span><span class="p">),</span> <span class="n">ans</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">elementary_io_verify</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="n">qctask</span><span class="p">)</span></div>

<div class="viewcode-block" id="QcTaskTest.test_fragmented_molecule"><a class="viewcode-back" href="../../../../pymatgen.io.tests.test_qchem.html#pymatgen.io.tests.test_qchem.QcTaskTest.test_fragmented_molecule">[docs]</a>    <span class="k">def</span> <span class="nf">test_fragmented_molecule</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">mol1</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
        <span class="n">mol1</span><span class="o">.</span><span class="n">set_charge_and_spin</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">mol2</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">water_mol</span><span class="p">)</span>
        <span class="n">mol2</span><span class="o">.</span><span class="n">set_charge_and_spin</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">qctask</span> <span class="o">=</span> <span class="n">QcTask</span><span class="p">([</span><span class="n">mol1</span><span class="p">,</span> <span class="n">mol2</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Test Fragments&quot;</span><span class="p">,</span> <span class="n">exchange</span><span class="o">=</span><span class="s2">&quot;B3LYP&quot;</span><span class="p">,</span>
                        <span class="n">jobtype</span><span class="o">=</span><span class="s2">&quot;bsse&quot;</span><span class="p">,</span> <span class="n">charge</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">spin_multiplicity</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">basis_set</span><span class="o">=</span><span class="s2">&quot;6-31++G**&quot;</span><span class="p">)</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;$comment</span>
<span class="s2"> Test Fragments</span>
<span class="s2">$end</span>


<span class="s2">$molecule</span>
<span class="s2"> 0  3</span>
<span class="s2">--</span>
<span class="s2"> 1  2</span>
<span class="s2"> C           0.00000000        0.00000000        0.00000000</span>
<span class="s2"> H           0.00000000        0.00000000        1.08900000</span>
<span class="s2"> H           1.02671900        0.00000000       -0.36300000</span>
<span class="s2"> H          -0.51336000       -0.88916500       -0.36300000</span>
<span class="s2"> Cl         -0.51336000        0.88916500       -0.36300000</span>
<span class="s2">--</span>
<span class="s2"> -1  2</span>
<span class="s2"> O           2.63227300       -0.31350400       -0.75037600</span>
<span class="s2"> H           3.26818200       -0.93731000       -0.43146400</span>
<span class="s2"> H           2.18419800       -0.75330500       -1.46905900</span>
<span class="s2">$end</span>


<span class="s2">$rem</span>
<span class="s2">   jobtype = bsse</span>
<span class="s2">  exchange = b3lyp</span>
<span class="s2">     basis = 6-31++g**</span>
<span class="s2">$end</span>

<span class="s2">&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">qctask</span><span class="p">),</span> <span class="n">ans</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">elementary_io_verify</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="n">qctask</span><span class="p">)</span></div>

<div class="viewcode-block" id="QcTaskTest.test_mixed_basis_str"><a class="viewcode-back" href="../../../../pymatgen.io.tests.test_qchem.html#pymatgen.io.tests.test_qchem.QcTaskTest.test_mixed_basis_str">[docs]</a>    <span class="k">def</span> <span class="nf">test_mixed_basis_str</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">qctask</span> <span class="o">=</span> <span class="n">QcTask</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Test Methane&quot;</span><span class="p">,</span> <span class="n">exchange</span><span class="o">=</span><span class="s2">&quot;B3LYP&quot;</span><span class="p">,</span>
                        <span class="n">jobtype</span><span class="o">=</span><span class="s2">&quot;SP&quot;</span><span class="p">,</span>
                        <span class="n">basis_set</span><span class="o">=</span><span class="p">[(</span><span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="s2">&quot;6-311G*&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;H&quot;</span><span class="p">,</span> <span class="s2">&quot;6-31g(d,p)&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;H&quot;</span><span class="p">,</span> <span class="s2">&quot;6-31g(d,p)&quot;</span><span class="p">),</span>
                                   <span class="p">(</span><span class="s2">&quot;H&quot;</span><span class="p">,</span> <span class="s2">&quot;6-31g*&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;cl&quot;</span><span class="p">,</span> <span class="s2">&quot;6-31+g*&quot;</span><span class="p">)])</span>
        <span class="n">ans_mixed</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;$comment</span>
<span class="s2"> Test Methane</span>
<span class="s2">$end</span>


<span class="s2">$molecule</span>
<span class="s2"> 0  1</span>
<span class="s2"> C           0.00000000        0.00000000        0.00000000</span>
<span class="s2"> H           0.00000000        0.00000000        1.08900000</span>
<span class="s2"> H           1.02671900        0.00000000       -0.36300000</span>
<span class="s2"> H          -0.51336000       -0.88916500       -0.36300000</span>
<span class="s2"> Cl         -0.51336000        0.88916500       -0.36300000</span>
<span class="s2">$end</span>


<span class="s2">$rem</span>
<span class="s2">   jobtype = sp</span>
<span class="s2">  exchange = b3lyp</span>
<span class="s2">     basis = mixed</span>
<span class="s2">$end</span>


<span class="s2">$basis</span>
<span class="s2"> C    1</span>
<span class="s2"> 6-311g*</span>
<span class="s2"> ****</span>
<span class="s2"> H    2</span>
<span class="s2"> 6-31g(d,p)</span>
<span class="s2"> ****</span>
<span class="s2"> H    3</span>
<span class="s2"> 6-31g(d,p)</span>
<span class="s2"> ****</span>
<span class="s2"> H    4</span>
<span class="s2"> 6-31g*</span>
<span class="s2"> ****</span>
<span class="s2"> Cl   5</span>
<span class="s2"> 6-31+g*</span>
<span class="s2"> ****</span>
<span class="s2">$end</span>

<span class="s2">&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ans_mixed</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">qctask</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">elementary_io_verify</span><span class="p">(</span><span class="n">ans_mixed</span><span class="p">,</span> <span class="n">qctask</span><span class="p">)</span>
        <span class="n">qctask</span><span class="o">.</span><span class="n">set_basis_set</span><span class="p">(</span><span class="s2">&quot;6-31+G*&quot;</span><span class="p">)</span>
        <span class="n">ans_simple</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;$comment</span>
<span class="s2"> Test Methane</span>
<span class="s2">$end</span>


<span class="s2">$molecule</span>
<span class="s2"> 0  1</span>
<span class="s2"> C           0.00000000        0.00000000        0.00000000</span>
<span class="s2"> H           0.00000000        0.00000000        1.08900000</span>
<span class="s2"> H           1.02671900        0.00000000       -0.36300000</span>
<span class="s2"> H          -0.51336000       -0.88916500       -0.36300000</span>
<span class="s2"> Cl         -0.51336000        0.88916500       -0.36300000</span>
<span class="s2">$end</span>


<span class="s2">$rem</span>
<span class="s2">   jobtype = sp</span>
<span class="s2">  exchange = b3lyp</span>
<span class="s2">     basis = 6-31+g*</span>
<span class="s2">$end</span>

<span class="s2">&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">qctask</span><span class="p">),</span> <span class="n">ans_simple</span><span class="p">)</span>
        <span class="n">qctask</span><span class="o">.</span><span class="n">set_basis_set</span><span class="p">([(</span><span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="s2">&quot;6-311G*&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;H&quot;</span><span class="p">,</span> <span class="s2">&quot;6-31g(d,p)&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;H&quot;</span><span class="p">,</span> <span class="s2">&quot;6-31g(d,p)&quot;</span><span class="p">),</span>
                              <span class="p">(</span><span class="s2">&quot;H&quot;</span><span class="p">,</span> <span class="s2">&quot;6-31g*&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;cl&quot;</span><span class="p">,</span> <span class="s2">&quot;6-31+g*&quot;</span><span class="p">)])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">qctask</span><span class="p">),</span> <span class="n">ans_mixed</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">elementary_io_verify</span><span class="p">(</span><span class="n">ans_mixed</span><span class="p">,</span> <span class="n">qctask</span><span class="p">)</span></div>

<div class="viewcode-block" id="QcTaskTest.test_partial_hessian"><a class="viewcode-back" href="../../../../pymatgen.io.tests.test_qchem.html#pymatgen.io.tests.test_qchem.QcTaskTest.test_partial_hessian">[docs]</a>    <span class="k">def</span> <span class="nf">test_partial_hessian</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">qcinp1</span> <span class="o">=</span> <span class="n">QcInput</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">test_dir</span><span class="p">,</span> <span class="s2">&quot;partial_hessian.qcinp&quot;</span><span class="p">))</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;$molecule</span>
<span class="s2"> 0  1</span>
<span class="s2"> C          -1.76827000        0.46495000        0.28695000</span>
<span class="s2"> O           1.78497000       -0.42034000       -0.39845000</span>
<span class="s2"> H          -0.77736000        0.78961000        0.66548000</span>
<span class="s2"> H          -1.75896000        0.46604000       -0.82239000</span>
<span class="s2"> H          -2.54983000        1.16313000        0.65101000</span>
<span class="s2"> H          -1.98693000       -0.55892000        0.65381000</span>
<span class="s2"> H           2.14698000       -0.07173000        0.45530000</span>
<span class="s2"> H           1.25596000       -1.21510000       -0.13726000</span>
<span class="s2">$end</span>


<span class="s2">$rem</span>
<span class="s2">   jobtype = freq</span>
<span class="s2">  exchange = b3lyp</span>
<span class="s2">     basis = 6-31g*</span>
<span class="s2">     n_sol = 3</span>
<span class="s2">     phess = true</span>
<span class="s2">$end</span>


<span class="s2">$alist</span>
<span class="s2"> 3</span>
<span class="s2"> 7</span>
<span class="s2"> 8</span>
<span class="s2">$end</span>

<span class="s2">&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">qcinp1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">elementary_io_verify</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="n">qcinp1</span><span class="o">.</span><span class="n">jobs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">qcinp1</span><span class="o">.</span><span class="n">jobs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;rem&quot;</span><span class="p">][</span><span class="s2">&quot;jobtype&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;sp&quot;</span>
        <span class="n">qcinp1</span><span class="o">.</span><span class="n">jobs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;rem&quot;</span><span class="p">][</span><span class="s2">&quot;phess&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span>
        <span class="n">qcinp1</span><span class="o">.</span><span class="n">jobs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_partial_hessian_atoms</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;$molecule</span>
<span class="s2"> 0  1</span>
<span class="s2"> C          -1.76827000        0.46495000        0.28695000</span>
<span class="s2"> O           1.78497000       -0.42034000       -0.39845000</span>
<span class="s2"> H          -0.77736000        0.78961000        0.66548000</span>
<span class="s2"> H          -1.75896000        0.46604000       -0.82239000</span>
<span class="s2"> H          -2.54983000        1.16313000        0.65101000</span>
<span class="s2"> H          -1.98693000       -0.55892000        0.65381000</span>
<span class="s2"> H           2.14698000       -0.07173000        0.45530000</span>
<span class="s2"> H           1.25596000       -1.21510000       -0.13726000</span>
<span class="s2">$end</span>


<span class="s2">$rem</span>
<span class="s2">   jobtype = freq</span>
<span class="s2">  exchange = b3lyp</span>
<span class="s2">     basis = 6-31g*</span>
<span class="s2">     n_sol = 5</span>
<span class="s2">     phess = True</span>
<span class="s2">$end</span>


<span class="s2">$alist</span>
<span class="s2"> 2</span>
<span class="s2"> 3</span>
<span class="s2"> 4</span>
<span class="s2"> 5</span>
<span class="s2"> 6</span>
<span class="s2">$end</span>

<span class="s2">&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">qcinp1</span><span class="p">))</span></div>

<div class="viewcode-block" id="QcTaskTest.test_basis2_mixed"><a class="viewcode-back" href="../../../../pymatgen.io.tests.test_qchem.html#pymatgen.io.tests.test_qchem.QcTaskTest.test_basis2_mixed">[docs]</a>    <span class="k">def</span> <span class="nf">test_basis2_mixed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">qcinp1</span> <span class="o">=</span> <span class="n">QcInput</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">test_dir</span><span class="p">,</span> <span class="s2">&quot;basis2_mixed.inp&quot;</span><span class="p">))</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;$molecule</span>
<span class="s2"> 0  1</span>
<span class="s2"> C          -1.76827000        0.46495000        0.28695000</span>
<span class="s2"> O           1.78497000       -0.42034000       -0.39845000</span>
<span class="s2"> H          -0.77736000        0.78961000        0.66548000</span>
<span class="s2"> H          -1.75896000        0.46604000       -0.82239000</span>
<span class="s2"> H          -2.54983000        1.16313000        0.65101000</span>
<span class="s2"> H          -1.98693000       -0.55892000        0.65381000</span>
<span class="s2"> H           2.14698000       -0.07173000        0.45530000</span>
<span class="s2"> H           1.25596000       -1.21510000       -0.13726000</span>
<span class="s2">$end</span>


<span class="s2">$rem</span>
<span class="s2">   jobtype = sp</span>
<span class="s2">  exchange = b3lyp</span>
<span class="s2">     basis = mixed</span>
<span class="s2">    basis2 = basis2_mixed</span>
<span class="s2">  purecart = 1111</span>
<span class="s2">$end</span>


<span class="s2">$basis</span>
<span class="s2"> C    1</span>
<span class="s2"> 6-311+g(3df)</span>
<span class="s2"> ****</span>
<span class="s2"> O    2</span>
<span class="s2"> aug-cc-pvtz</span>
<span class="s2"> ****</span>
<span class="s2"> H    3</span>
<span class="s2"> 6-31g*</span>
<span class="s2"> ****</span>
<span class="s2"> H    4</span>
<span class="s2"> 6-31g*</span>
<span class="s2"> ****</span>
<span class="s2"> H    5</span>
<span class="s2"> 6-31g*</span>
<span class="s2"> ****</span>
<span class="s2"> H    6</span>
<span class="s2"> 6-31g*</span>
<span class="s2"> ****</span>
<span class="s2"> H    7</span>
<span class="s2"> cc-pvdz</span>
<span class="s2"> ****</span>
<span class="s2"> H    8</span>
<span class="s2"> cc-pvdz</span>
<span class="s2"> ****</span>
<span class="s2">$end</span>


<span class="s2">$basis2</span>
<span class="s2"> C    1</span>
<span class="s2"> sto-3g</span>
<span class="s2"> ****</span>
<span class="s2"> O    2</span>
<span class="s2"> sto-3g</span>
<span class="s2"> ****</span>
<span class="s2"> H    3</span>
<span class="s2"> sto-3g</span>
<span class="s2"> ****</span>
<span class="s2"> H    4</span>
<span class="s2"> sto-3g</span>
<span class="s2"> ****</span>
<span class="s2"> H    5</span>
<span class="s2"> sto-3g</span>
<span class="s2"> ****</span>
<span class="s2"> H    6</span>
<span class="s2"> sto-3g</span>
<span class="s2"> ****</span>
<span class="s2"> H    7</span>
<span class="s2"> sto-3g</span>
<span class="s2"> ****</span>
<span class="s2"> H    8</span>
<span class="s2"> sto-3g</span>
<span class="s2"> ****</span>
<span class="s2">$end</span>

<span class="s2">&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">qcinp1</span><span class="p">),</span> <span class="n">ans</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">elementary_io_verify</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="n">qcinp1</span><span class="o">.</span><span class="n">jobs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">basis2</span> <span class="o">=</span> <span class="n">qcinp1</span><span class="o">.</span><span class="n">jobs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;basis2&quot;</span><span class="p">]</span>
        <span class="n">qcinp2</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">qcinp1</span><span class="p">)</span>
        <span class="n">qcinp2</span><span class="o">.</span><span class="n">jobs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_basis2</span><span class="p">(</span><span class="s2">&quot;3-21g&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">qcinp2</span><span class="o">.</span><span class="n">jobs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;rem&quot;</span><span class="p">][</span><span class="s2">&quot;basis2&quot;</span><span class="p">],</span> <span class="s2">&quot;3-21g&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="s2">&quot;basis2&quot;</span> <span class="ow">in</span> <span class="n">qcinp2</span><span class="o">.</span><span class="n">jobs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">params</span><span class="p">)</span>
        <span class="n">qcinp2</span><span class="o">.</span><span class="n">jobs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_basis2</span><span class="p">(</span><span class="n">basis2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">qcinp2</span><span class="p">),</span> <span class="n">ans</span><span class="p">)</span></div>

<div class="viewcode-block" id="QcTaskTest.test_aux_basis_str"><a class="viewcode-back" href="../../../../pymatgen.io.tests.test_qchem.html#pymatgen.io.tests.test_qchem.QcTaskTest.test_aux_basis_str">[docs]</a>    <span class="k">def</span> <span class="nf">test_aux_basis_str</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ans_gen</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;$comment</span>
<span class="s1"> Test Methane</span>
<span class="s1">$end</span>


<span class="s1">$molecule</span>
<span class="s1"> 0  1</span>
<span class="s1"> C           0.00000000        0.00000000        0.00000000</span>
<span class="s1"> H           0.00000000        0.00000000        1.08900000</span>
<span class="s1"> H           1.02671900        0.00000000       -0.36300000</span>
<span class="s1"> H          -0.51336000       -0.88916500       -0.36300000</span>
<span class="s1"> Cl         -0.51336000        0.88916500       -0.36300000</span>
<span class="s1">$end</span>


<span class="s1">$rem</span>
<span class="s1">    jobtype = freq</span>
<span class="s1">   exchange = xygjos</span>
<span class="s1">      basis = gen</span>
<span class="s1">  aux_basis = gen</span>
<span class="s1">$end</span>


<span class="s1">$aux_basis</span>
<span class="s1"> C</span>
<span class="s1"> rimp2-cc-pvdz</span>
<span class="s1"> ****</span>
<span class="s1"> Cl</span>
<span class="s1"> rimp2-aug-cc-pvdz</span>
<span class="s1"> ****</span>
<span class="s1"> H</span>
<span class="s1"> rimp2-cc-pvdz</span>
<span class="s1"> ****</span>
<span class="s1">$end</span>


<span class="s1">$basis</span>
<span class="s1"> C</span>
<span class="s1"> 6-31g*</span>
<span class="s1"> ****</span>
<span class="s1"> Cl</span>
<span class="s1"> 6-31+g*</span>
<span class="s1"> ****</span>
<span class="s1"> H</span>
<span class="s1"> 6-31g*</span>
<span class="s1"> ****</span>
<span class="s1">$end</span>

<span class="s1">&#39;&#39;&#39;</span>
        <span class="n">qctask</span> <span class="o">=</span> <span class="n">QcTask</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Test Methane&quot;</span><span class="p">,</span> <span class="n">exchange</span><span class="o">=</span><span class="s2">&quot;xygjos&quot;</span><span class="p">,</span>
                        <span class="n">jobtype</span><span class="o">=</span><span class="s2">&quot;Freq&quot;</span><span class="p">,</span>
                        <span class="n">basis_set</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;C&quot;</span><span class="p">:</span> <span class="s2">&quot;6-31G*&quot;</span><span class="p">,</span> <span class="s2">&quot;h&quot;</span><span class="p">:</span> <span class="s2">&quot;6-31g*&quot;</span><span class="p">,</span>
                                   <span class="s2">&quot;CL&quot;</span><span class="p">:</span> <span class="s2">&quot;6-31+g*&quot;</span><span class="p">},</span>
                        <span class="n">aux_basis_set</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;c&quot;</span><span class="p">:</span> <span class="s2">&quot;rimp2-cc-pvdz&quot;</span><span class="p">,</span>
                                       <span class="s2">&quot;H&quot;</span><span class="p">:</span> <span class="s2">&quot;rimp2-cc-pvdz&quot;</span><span class="p">,</span>
                                       <span class="s2">&quot;Cl&quot;</span><span class="p">:</span> <span class="s2">&quot;rimp2-aug-cc-pvdz&quot;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">qctask</span><span class="p">),</span> <span class="n">ans_gen</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">elementary_io_verify</span><span class="p">(</span><span class="n">ans_gen</span><span class="p">,</span> <span class="n">qctask</span><span class="p">)</span>
        <span class="n">qctask</span><span class="o">.</span><span class="n">set_auxiliary_basis_set</span><span class="p">([(</span><span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="s2">&quot;aug-cc-pvdz&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;H&quot;</span><span class="p">,</span> <span class="s2">&quot;cc-pvdz&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;H&quot;</span><span class="p">,</span> <span class="s2">&quot;cc-pvdz&quot;</span><span class="p">),</span>
                                        <span class="p">(</span><span class="s2">&quot;H&quot;</span><span class="p">,</span> <span class="s2">&quot;cc-pvdz&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;cl&quot;</span><span class="p">,</span> <span class="s2">&quot;rimp2-aug-cc-pvdz&quot;</span><span class="p">)])</span>
        <span class="n">ans_mixed_aux</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;$comment</span>
<span class="s2"> Test Methane</span>
<span class="s2">$end</span>


<span class="s2">$molecule</span>
<span class="s2"> 0  1</span>
<span class="s2"> C           0.00000000        0.00000000        0.00000000</span>
<span class="s2"> H           0.00000000        0.00000000        1.08900000</span>
<span class="s2"> H           1.02671900        0.00000000       -0.36300000</span>
<span class="s2"> H          -0.51336000       -0.88916500       -0.36300000</span>
<span class="s2"> Cl         -0.51336000        0.88916500       -0.36300000</span>
<span class="s2">$end</span>


<span class="s2">$rem</span>
<span class="s2">    jobtype = freq</span>
<span class="s2">   exchange = xygjos</span>
<span class="s2">      basis = gen</span>
<span class="s2">  aux_basis = mixed</span>
<span class="s2">$end</span>


<span class="s2">$aux_basis</span>
<span class="s2"> C    1</span>
<span class="s2"> aug-cc-pvdz</span>
<span class="s2"> ****</span>
<span class="s2"> H    2</span>
<span class="s2"> cc-pvdz</span>
<span class="s2"> ****</span>
<span class="s2"> H    3</span>
<span class="s2"> cc-pvdz</span>
<span class="s2"> ****</span>
<span class="s2"> H    4</span>
<span class="s2"> cc-pvdz</span>
<span class="s2"> ****</span>
<span class="s2"> Cl   5</span>
<span class="s2"> rimp2-aug-cc-pvdz</span>
<span class="s2"> ****</span>
<span class="s2">$end</span>


<span class="s2">$basis</span>
<span class="s2"> C</span>
<span class="s2"> 6-31g*</span>
<span class="s2"> ****</span>
<span class="s2"> Cl</span>
<span class="s2"> 6-31+g*</span>
<span class="s2"> ****</span>
<span class="s2"> H</span>
<span class="s2"> 6-31g*</span>
<span class="s2"> ****</span>
<span class="s2">$end</span>

<span class="s2">&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ans_mixed_aux</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">qctask</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">elementary_io_verify</span><span class="p">(</span><span class="n">ans_mixed_aux</span><span class="p">,</span> <span class="n">qctask</span><span class="p">)</span>
        <span class="n">qctask</span><span class="o">.</span><span class="n">set_basis_set</span><span class="p">(</span><span class="s2">&quot;6-31+G*&quot;</span><span class="p">)</span>
        <span class="n">qctask</span><span class="o">.</span><span class="n">set_auxiliary_basis_set</span><span class="p">(</span><span class="s2">&quot;rimp2-cc-pvdz&quot;</span><span class="p">)</span>
        <span class="n">ans_simple</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;$comment</span>
<span class="s2"> Test Methane</span>
<span class="s2">$end</span>


<span class="s2">$molecule</span>
<span class="s2"> 0  1</span>
<span class="s2"> C           0.00000000        0.00000000        0.00000000</span>
<span class="s2"> H           0.00000000        0.00000000        1.08900000</span>
<span class="s2"> H           1.02671900        0.00000000       -0.36300000</span>
<span class="s2"> H          -0.51336000       -0.88916500       -0.36300000</span>
<span class="s2"> Cl         -0.51336000        0.88916500       -0.36300000</span>
<span class="s2">$end</span>


<span class="s2">$rem</span>
<span class="s2">    jobtype = freq</span>
<span class="s2">   exchange = xygjos</span>
<span class="s2">      basis = 6-31+g*</span>
<span class="s2">  aux_basis = rimp2-cc-pvdz</span>
<span class="s2">$end</span>

<span class="s2">&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ans_simple</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">qctask</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">elementary_io_verify</span><span class="p">(</span><span class="n">ans_simple</span><span class="p">,</span> <span class="n">qctask</span><span class="p">)</span>
        <span class="n">qctask</span><span class="o">.</span><span class="n">set_basis_set</span><span class="p">({</span><span class="s2">&quot;C&quot;</span><span class="p">:</span> <span class="s2">&quot;6-31G*&quot;</span><span class="p">,</span> <span class="s2">&quot;h&quot;</span><span class="p">:</span> <span class="s2">&quot;6-31g*&quot;</span><span class="p">,</span>
                              <span class="s2">&quot;CL&quot;</span><span class="p">:</span> <span class="s2">&quot;6-31+g*&quot;</span><span class="p">})</span>
        <span class="n">qctask</span><span class="o">.</span><span class="n">set_auxiliary_basis_set</span><span class="p">([(</span><span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="s2">&quot;aug-cc-pvdz&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;H&quot;</span><span class="p">,</span> <span class="s2">&quot;cc-pvdz&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;H&quot;</span><span class="p">,</span> <span class="s2">&quot;cc-pvdz&quot;</span><span class="p">),</span>
                                        <span class="p">(</span><span class="s2">&quot;H&quot;</span><span class="p">,</span> <span class="s2">&quot;cc-pvdz&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;cl&quot;</span><span class="p">,</span> <span class="s2">&quot;rimp2-aug-cc-pvdz&quot;</span><span class="p">)])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ans_mixed_aux</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">qctask</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">elementary_io_verify</span><span class="p">(</span><span class="n">ans_mixed_aux</span><span class="p">,</span> <span class="n">qctask</span><span class="p">)</span></div>

<div class="viewcode-block" id="QcTaskTest.test_ecp_str"><a class="viewcode-back" href="../../../../pymatgen.io.tests.test_qchem.html#pymatgen.io.tests.test_qchem.QcTaskTest.test_ecp_str">[docs]</a>    <span class="k">def</span> <span class="nf">test_ecp_str</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;$comment</span>
<span class="s1"> Test ECP</span>
<span class="s1">$end</span>


<span class="s1">$molecule</span>
<span class="s1"> 0  1</span>
<span class="s1"> Br          0.00000000        0.00000000       -2.40000000</span>
<span class="s1"> Cd          0.00000000        0.00000000        0.00000000</span>
<span class="s1"> Br          0.00000000        0.00000000        2.40000000</span>
<span class="s1">$end</span>


<span class="s1">$rem</span>
<span class="s1">   jobtype = opt</span>
<span class="s1">  exchange = b3lyp</span>
<span class="s1">     basis = gen</span>
<span class="s1">       ecp = gen</span>
<span class="s1">$end</span>


<span class="s1">$basis</span>
<span class="s1"> Br</span>
<span class="s1"> srlc</span>
<span class="s1"> ****</span>
<span class="s1"> Cd</span>
<span class="s1"> srsc</span>
<span class="s1"> ****</span>
<span class="s1">$end</span>


<span class="s1">$ecp</span>
<span class="s1"> Br</span>
<span class="s1"> srlc</span>
<span class="s1"> ****</span>
<span class="s1"> Cd</span>
<span class="s1"> srsc</span>
<span class="s1"> ****</span>
<span class="s1">$end</span>

<span class="s1">&#39;&#39;&#39;</span>
        <span class="n">qctask</span> <span class="o">=</span> <span class="n">QcTask</span><span class="p">(</span><span class="n">heavy_mol</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Test ECP&quot;</span><span class="p">,</span> <span class="n">exchange</span><span class="o">=</span><span class="s2">&quot;B3LYP&quot;</span><span class="p">,</span>
                        <span class="n">jobtype</span><span class="o">=</span><span class="s2">&quot;Opt&quot;</span><span class="p">,</span>
                        <span class="n">basis_set</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Br&quot;</span><span class="p">:</span> <span class="s2">&quot;srlc&quot;</span><span class="p">,</span> <span class="s2">&quot;Cd&quot;</span><span class="p">:</span> <span class="s2">&quot;srsc&quot;</span><span class="p">},</span>
                        <span class="n">ecp</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Br&quot;</span><span class="p">:</span> <span class="s2">&quot;SrlC&quot;</span><span class="p">,</span> <span class="s2">&quot;Cd&quot;</span><span class="p">:</span> <span class="s2">&quot;srsc&quot;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">qctask</span><span class="p">),</span> <span class="n">ans</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">elementary_io_verify</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="n">qctask</span><span class="p">)</span></div>

<div class="viewcode-block" id="QcTaskTest.test_set_memory"><a class="viewcode-back" href="../../../../pymatgen.io.tests.test_qchem.html#pymatgen.io.tests.test_qchem.QcTaskTest.test_set_memory">[docs]</a>    <span class="k">def</span> <span class="nf">test_set_memory</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;$comment</span>
<span class="s1"> Test Methane</span>
<span class="s1">$end</span>


<span class="s1">$molecule</span>
<span class="s1"> 0  1</span>
<span class="s1"> C           0.00000000        0.00000000        0.00000000</span>
<span class="s1"> H           0.00000000        0.00000000        1.08900000</span>
<span class="s1"> H           1.02671900        0.00000000       -0.36300000</span>
<span class="s1"> H          -0.51336000       -0.88916500       -0.36300000</span>
<span class="s1"> Cl         -0.51336000        0.88916500       -0.36300000</span>
<span class="s1">$end</span>


<span class="s1">$rem</span>
<span class="s1">     jobtype = sp</span>
<span class="s1">    exchange = b3lyp</span>
<span class="s1">       basis = 6-31+g*</span>
<span class="s1">  mem_static = 500</span>
<span class="s1">   mem_total = 18000</span>
<span class="s1">$end</span>

<span class="s1">&#39;&#39;&#39;</span>
        <span class="n">qctask</span> <span class="o">=</span> <span class="n">QcTask</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Test Methane&quot;</span><span class="p">,</span> <span class="n">exchange</span><span class="o">=</span><span class="s2">&quot;B3LYP&quot;</span><span class="p">,</span>
                        <span class="n">jobtype</span><span class="o">=</span><span class="s2">&quot;SP&quot;</span><span class="p">,</span>
                        <span class="n">basis_set</span><span class="o">=</span><span class="s2">&quot;6-31+G*&quot;</span><span class="p">)</span>
        <span class="n">qctask</span><span class="o">.</span><span class="n">set_memory</span><span class="p">(</span><span class="n">total</span><span class="o">=</span><span class="mi">18000</span><span class="p">,</span> <span class="n">static</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">qctask</span><span class="p">),</span> <span class="n">ans</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">elementary_io_verify</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="n">qctask</span><span class="p">)</span></div>

<div class="viewcode-block" id="QcTaskTest.test_qc42_pcm_solvent_format"><a class="viewcode-back" href="../../../../pymatgen.io.tests.test_qchem.html#pymatgen.io.tests.test_qchem.QcTaskTest.test_qc42_pcm_solvent_format">[docs]</a>    <span class="k">def</span> <span class="nf">test_qc42_pcm_solvent_format</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;$molecule</span>
<span class="s1"> -1  2</span>
<span class="s1"> N          -0.00017869        0.00010707        0.20449990</span>
<span class="s1"> H           0.89201838        0.20268122       -0.29656572</span>
<span class="s1"> H          -0.62191133        0.67135171       -0.29649162</span>
<span class="s1"> H          -0.26987729       -0.87406458       -0.29659779</span>
<span class="s1">$end</span>


<span class="s1">$rem</span>
<span class="s1">         jobtype = sp</span>
<span class="s1">        exchange = b3lyp</span>
<span class="s1">           basis = 6-31+g*</span>
<span class="s1">  solvent_method = pcm</span>
<span class="s1">$end</span>


<span class="s1">$pcm</span>
<span class="s1">       theory   ssvpe</span>
<span class="s1">     vdwscale   1.1</span>
<span class="s1">$end</span>


<span class="s1">$pcm_solvent</span>
<span class="s1">  dielectric   78.3553</span>
<span class="s1">$end</span>

<span class="s1">&#39;&#39;&#39;</span>
        <span class="n">qctask_qc41</span> <span class="o">=</span> <span class="n">QcTask</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
        <span class="n">qctask_qc42</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">qctask_qc41</span><span class="p">)</span>
        <span class="n">solvent_params</span> <span class="o">=</span> <span class="n">qctask_qc42</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;pcm_solvent&quot;</span><span class="p">)</span>
        <span class="n">qctask_qc42</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;solvent&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">solvent_params</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;$molecule</span>
<span class="s1"> -1  2</span>
<span class="s1"> N          -0.00017869        0.00010707        0.20449990</span>
<span class="s1"> H           0.89201838        0.20268122       -0.29656572</span>
<span class="s1"> H          -0.62191133        0.67135171       -0.29649162</span>
<span class="s1"> H          -0.26987729       -0.87406458       -0.29659779</span>
<span class="s1">$end</span>


<span class="s1">$rem</span>
<span class="s1">         jobtype = sp</span>
<span class="s1">        exchange = b3lyp</span>
<span class="s1">           basis = 6-31+g*</span>
<span class="s1">  solvent_method = pcm</span>
<span class="s1">$end</span>


<span class="s1">$pcm</span>
<span class="s1">    theory   ssvpe</span>
<span class="s1">  vdwscale   1.1</span>
<span class="s1">$end</span>


<span class="s1">$solvent</span>
<span class="s1">  dielectric   78.3553</span>
<span class="s1">$end</span>

<span class="s1">&#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">qctask_qc42</span><span class="p">),</span> <span class="n">ans</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">elementary_io_verify</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="n">qctask_qc42</span><span class="p">)</span></div>

<div class="viewcode-block" id="QcTaskTest.test_set_max_num_of_scratch_files"><a class="viewcode-back" href="../../../../pymatgen.io.tests.test_qchem.html#pymatgen.io.tests.test_qchem.QcTaskTest.test_set_max_num_of_scratch_files">[docs]</a>    <span class="k">def</span> <span class="nf">test_set_max_num_of_scratch_files</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;$comment</span>
<span class="s1"> Test Methane</span>
<span class="s1">$end</span>


<span class="s1">$molecule</span>
<span class="s1"> 0  1</span>
<span class="s1"> C           0.00000000        0.00000000        0.00000000</span>
<span class="s1"> H           0.00000000        0.00000000        1.08900000</span>
<span class="s1"> H           1.02671900        0.00000000       -0.36300000</span>
<span class="s1"> H          -0.51336000       -0.88916500       -0.36300000</span>
<span class="s1"> Cl         -0.51336000        0.88916500       -0.36300000</span>
<span class="s1">$end</span>


<span class="s1">$rem</span>
<span class="s1">           jobtype = sp</span>
<span class="s1">          exchange = b3lyp</span>
<span class="s1">             basis = 6-31+g*</span>
<span class="s1">  max_sub_file_num = 500</span>
<span class="s1">$end</span>

<span class="s1">&#39;&#39;&#39;</span>
        <span class="n">qctask</span> <span class="o">=</span> <span class="n">QcTask</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Test Methane&quot;</span><span class="p">,</span> <span class="n">exchange</span><span class="o">=</span><span class="s2">&quot;B3LYP&quot;</span><span class="p">,</span>
                        <span class="n">jobtype</span><span class="o">=</span><span class="s2">&quot;SP&quot;</span><span class="p">,</span>
                        <span class="n">basis_set</span><span class="o">=</span><span class="s2">&quot;6-31+G*&quot;</span><span class="p">)</span>
        <span class="n">qctask</span><span class="o">.</span><span class="n">set_max_num_of_scratch_files</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">qctask</span><span class="p">),</span> <span class="n">ans</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">elementary_io_verify</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="n">qctask</span><span class="p">)</span></div>

<div class="viewcode-block" id="QcTaskTest.test_set_max_scf_iterations"><a class="viewcode-back" href="../../../../pymatgen.io.tests.test_qchem.html#pymatgen.io.tests.test_qchem.QcTaskTest.test_set_max_scf_iterations">[docs]</a>    <span class="k">def</span> <span class="nf">test_set_max_scf_iterations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;$comment</span>
<span class="s1"> Test Methane</span>
<span class="s1">$end</span>


<span class="s1">$molecule</span>
<span class="s1"> 0  1</span>
<span class="s1"> C           0.00000000        0.00000000        0.00000000</span>
<span class="s1"> H           0.00000000        0.00000000        1.08900000</span>
<span class="s1"> H           1.02671900        0.00000000       -0.36300000</span>
<span class="s1"> H          -0.51336000       -0.88916500       -0.36300000</span>
<span class="s1"> Cl         -0.51336000        0.88916500       -0.36300000</span>
<span class="s1">$end</span>


<span class="s1">$rem</span>
<span class="s1">         jobtype = sp</span>
<span class="s1">        exchange = b3lyp</span>
<span class="s1">           basis = 6-31+g*</span>
<span class="s1">  max_scf_cycles = 100</span>
<span class="s1">   scf_algorithm = diis_gdm</span>
<span class="s1">$end</span>

<span class="s1">&#39;&#39;&#39;</span>
        <span class="n">qctask</span> <span class="o">=</span> <span class="n">QcTask</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Test Methane&quot;</span><span class="p">,</span> <span class="n">exchange</span><span class="o">=</span><span class="s2">&quot;B3LYP&quot;</span><span class="p">,</span>
                        <span class="n">jobtype</span><span class="o">=</span><span class="s2">&quot;SP&quot;</span><span class="p">,</span>
                        <span class="n">basis_set</span><span class="o">=</span><span class="s2">&quot;6-31+G*&quot;</span><span class="p">)</span>
        <span class="n">qctask</span><span class="o">.</span><span class="n">set_scf_algorithm_and_iterations</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;diis_gdm&quot;</span><span class="p">,</span>
                                                <span class="n">iterations</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">qctask</span><span class="p">),</span> <span class="n">ans</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">elementary_io_verify</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="n">qctask</span><span class="p">)</span></div>

<div class="viewcode-block" id="QcTaskTest.test_set_scf_convergence_threshold"><a class="viewcode-back" href="../../../../pymatgen.io.tests.test_qchem.html#pymatgen.io.tests.test_qchem.QcTaskTest.test_set_scf_convergence_threshold">[docs]</a>    <span class="k">def</span> <span class="nf">test_set_scf_convergence_threshold</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;$comment</span>
<span class="s1"> Test Methane</span>
<span class="s1">$end</span>


<span class="s1">$molecule</span>
<span class="s1"> 0  1</span>
<span class="s1"> C           0.00000000        0.00000000        0.00000000</span>
<span class="s1"> H           0.00000000        0.00000000        1.08900000</span>
<span class="s1"> H           1.02671900        0.00000000       -0.36300000</span>
<span class="s1"> H          -0.51336000       -0.88916500       -0.36300000</span>
<span class="s1"> Cl         -0.51336000        0.88916500       -0.36300000</span>
<span class="s1">$end</span>


<span class="s1">$rem</span>
<span class="s1">          jobtype = sp</span>
<span class="s1">         exchange = b3lyp</span>
<span class="s1">            basis = 6-31+g*</span>
<span class="s1">  scf_convergence = 8</span>
<span class="s1">$end</span>

<span class="s1">&#39;&#39;&#39;</span>
        <span class="n">qctask</span> <span class="o">=</span> <span class="n">QcTask</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Test Methane&quot;</span><span class="p">,</span> <span class="n">exchange</span><span class="o">=</span><span class="s2">&quot;B3LYP&quot;</span><span class="p">,</span>
                        <span class="n">jobtype</span><span class="o">=</span><span class="s2">&quot;SP&quot;</span><span class="p">,</span>
                        <span class="n">basis_set</span><span class="o">=</span><span class="s2">&quot;6-31+G*&quot;</span><span class="p">)</span>
        <span class="n">qctask</span><span class="o">.</span><span class="n">set_scf_convergence_threshold</span><span class="p">(</span><span class="n">exponent</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">qctask</span><span class="p">),</span> <span class="n">ans</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">elementary_io_verify</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="n">qctask</span><span class="p">)</span></div>

<div class="viewcode-block" id="QcTaskTest.test_set_integral_threshold"><a class="viewcode-back" href="../../../../pymatgen.io.tests.test_qchem.html#pymatgen.io.tests.test_qchem.QcTaskTest.test_set_integral_threshold">[docs]</a>    <span class="k">def</span> <span class="nf">test_set_integral_threshold</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;$comment</span>
<span class="s1"> Test Methane</span>
<span class="s1">$end</span>


<span class="s1">$molecule</span>
<span class="s1"> 0  1</span>
<span class="s1"> C           0.00000000        0.00000000        0.00000000</span>
<span class="s1"> H           0.00000000        0.00000000        1.08900000</span>
<span class="s1"> H           1.02671900        0.00000000       -0.36300000</span>
<span class="s1"> H          -0.51336000       -0.88916500       -0.36300000</span>
<span class="s1"> Cl         -0.51336000        0.88916500       -0.36300000</span>
<span class="s1">$end</span>


<span class="s1">$rem</span>
<span class="s1">   jobtype = sp</span>
<span class="s1">  exchange = b3lyp</span>
<span class="s1">     basis = 6-31+g*</span>
<span class="s1">    thresh = 14</span>
<span class="s1">$end</span>

<span class="s1">&#39;&#39;&#39;</span>
        <span class="n">qctask</span> <span class="o">=</span> <span class="n">QcTask</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Test Methane&quot;</span><span class="p">,</span> <span class="n">exchange</span><span class="o">=</span><span class="s2">&quot;B3LYP&quot;</span><span class="p">,</span>
                        <span class="n">jobtype</span><span class="o">=</span><span class="s2">&quot;SP&quot;</span><span class="p">,</span>
                        <span class="n">basis_set</span><span class="o">=</span><span class="s2">&quot;6-31+G*&quot;</span><span class="p">)</span>
        <span class="n">qctask</span><span class="o">.</span><span class="n">set_integral_threshold</span><span class="p">(</span><span class="n">thresh</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">qctask</span><span class="p">),</span> <span class="n">ans</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">elementary_io_verify</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="n">qctask</span><span class="p">)</span></div>

<div class="viewcode-block" id="QcTaskTest.test_set_dft_grid"><a class="viewcode-back" href="../../../../pymatgen.io.tests.test_qchem.html#pymatgen.io.tests.test_qchem.QcTaskTest.test_set_dft_grid">[docs]</a>    <span class="k">def</span> <span class="nf">test_set_dft_grid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;$comment</span>
<span class="s1"> Test Methane</span>
<span class="s1">$end</span>


<span class="s1">$molecule</span>
<span class="s1"> 0  1</span>
<span class="s1"> C           0.00000000        0.00000000        0.00000000</span>
<span class="s1"> H           0.00000000        0.00000000        1.08900000</span>
<span class="s1"> H           1.02671900        0.00000000       -0.36300000</span>
<span class="s1"> H          -0.51336000       -0.88916500       -0.36300000</span>
<span class="s1"> Cl         -0.51336000        0.88916500       -0.36300000</span>
<span class="s1">$end</span>


<span class="s1">$rem</span>
<span class="s1">   jobtype = sp</span>
<span class="s1">  exchange = b3lyp</span>
<span class="s1">     basis = 6-31+g*</span>
<span class="s1">   xc_grid = 000110000590</span>
<span class="s1">$end</span>

<span class="s1">&#39;&#39;&#39;</span>
        <span class="n">qctask</span> <span class="o">=</span> <span class="n">QcTask</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Test Methane&quot;</span><span class="p">,</span> <span class="n">exchange</span><span class="o">=</span><span class="s2">&quot;B3LYP&quot;</span><span class="p">,</span>
                        <span class="n">jobtype</span><span class="o">=</span><span class="s2">&quot;SP&quot;</span><span class="p">,</span>
                        <span class="n">basis_set</span><span class="o">=</span><span class="s2">&quot;6-31+G*&quot;</span><span class="p">)</span>
        <span class="n">qctask</span><span class="o">.</span><span class="n">set_dft_grid</span><span class="p">(</span><span class="n">radical_points</span><span class="o">=</span><span class="mi">110</span><span class="p">,</span> <span class="n">angular_points</span><span class="o">=</span><span class="mi">590</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">qctask</span><span class="p">),</span> <span class="n">ans</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">elementary_io_verify</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="n">qctask</span><span class="p">)</span></div>

<div class="viewcode-block" id="QcTaskTest.test_set_scf_initial_guess"><a class="viewcode-back" href="../../../../pymatgen.io.tests.test_qchem.html#pymatgen.io.tests.test_qchem.QcTaskTest.test_set_scf_initial_guess">[docs]</a>    <span class="k">def</span> <span class="nf">test_set_scf_initial_guess</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;$comment</span>
<span class="s1"> Test Methane</span>
<span class="s1">$end</span>


<span class="s1">$molecule</span>
<span class="s1"> 0  1</span>
<span class="s1"> C           0.00000000        0.00000000        0.00000000</span>
<span class="s1"> H           0.00000000        0.00000000        1.08900000</span>
<span class="s1"> H           1.02671900        0.00000000       -0.36300000</span>
<span class="s1"> H          -0.51336000       -0.88916500       -0.36300000</span>
<span class="s1"> Cl         -0.51336000        0.88916500       -0.36300000</span>
<span class="s1">$end</span>


<span class="s1">$rem</span>
<span class="s1">    jobtype = sp</span>
<span class="s1">   exchange = b3lyp</span>
<span class="s1">      basis = 6-31+g*</span>
<span class="s1">  scf_guess = gwh</span>
<span class="s1">$end</span>

<span class="s1">&#39;&#39;&#39;</span>
        <span class="n">qctask</span> <span class="o">=</span> <span class="n">QcTask</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Test Methane&quot;</span><span class="p">,</span> <span class="n">exchange</span><span class="o">=</span><span class="s2">&quot;B3LYP&quot;</span><span class="p">,</span>
                        <span class="n">jobtype</span><span class="o">=</span><span class="s2">&quot;SP&quot;</span><span class="p">,</span>
                        <span class="n">basis_set</span><span class="o">=</span><span class="s2">&quot;6-31+G*&quot;</span><span class="p">)</span>
        <span class="n">qctask</span><span class="o">.</span><span class="n">set_scf_initial_guess</span><span class="p">(</span><span class="s2">&quot;GWH&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">qctask</span><span class="p">),</span> <span class="n">ans</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">elementary_io_verify</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="n">qctask</span><span class="p">)</span></div>

<div class="viewcode-block" id="QcTaskTest.test_geom_opt_max_cycles"><a class="viewcode-back" href="../../../../pymatgen.io.tests.test_qchem.html#pymatgen.io.tests.test_qchem.QcTaskTest.test_geom_opt_max_cycles">[docs]</a>    <span class="k">def</span> <span class="nf">test_geom_opt_max_cycles</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;$comment</span>
<span class="s1"> Test Methane</span>
<span class="s1">$end</span>


<span class="s1">$molecule</span>
<span class="s1"> 1  2</span>
<span class="s1"> C           0.00000000        0.00000000        0.00000000</span>
<span class="s1"> H           0.00000000        0.00000000        1.08900000</span>
<span class="s1"> H           1.02671900        0.00000000       -0.36300000</span>
<span class="s1"> H          -0.51336000       -0.88916500       -0.36300000</span>
<span class="s1"> Cl         -0.51336000        0.88916500       -0.36300000</span>
<span class="s1">$end</span>


<span class="s1">$rem</span>
<span class="s1">              jobtype = sp</span>
<span class="s1">             exchange = b3lyp</span>
<span class="s1">                basis = 6-31+g*</span>
<span class="s1">  geom_opt_max_cycles = 100</span>
<span class="s1">$end</span>

<span class="s1">&#39;&#39;&#39;</span>
        <span class="n">qctask</span> <span class="o">=</span> <span class="n">QcTask</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Test Methane&quot;</span><span class="p">,</span> <span class="n">exchange</span><span class="o">=</span><span class="s2">&quot;B3LYP&quot;</span><span class="p">,</span>
                        <span class="n">jobtype</span><span class="o">=</span><span class="s2">&quot;SP&quot;</span><span class="p">,</span> <span class="n">charge</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">spin_multiplicity</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                        <span class="n">basis_set</span><span class="o">=</span><span class="s2">&quot;6-31+G*&quot;</span><span class="p">)</span>
        <span class="n">qctask</span><span class="o">.</span><span class="n">set_geom_max_iterations</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">qctask</span><span class="p">),</span> <span class="n">ans</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">elementary_io_verify</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="n">qctask</span><span class="p">)</span></div>

<div class="viewcode-block" id="QcTaskTest.test_set_geom_opt_coords_type"><a class="viewcode-back" href="../../../../pymatgen.io.tests.test_qchem.html#pymatgen.io.tests.test_qchem.QcTaskTest.test_set_geom_opt_coords_type">[docs]</a>    <span class="k">def</span> <span class="nf">test_set_geom_opt_coords_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;$comment</span>
<span class="s1"> Test Methane</span>
<span class="s1">$end</span>


<span class="s1">$molecule</span>
<span class="s1"> 0  1</span>
<span class="s1"> C           0.00000000        0.00000000        0.00000000</span>
<span class="s1"> H           0.00000000        0.00000000        1.08900000</span>
<span class="s1"> H           1.02671900        0.00000000       -0.36300000</span>
<span class="s1"> H          -0.51336000       -0.88916500       -0.36300000</span>
<span class="s1"> Cl         -0.51336000        0.88916500       -0.36300000</span>
<span class="s1">$end</span>


<span class="s1">$rem</span>
<span class="s1">          jobtype = sp</span>
<span class="s1">         exchange = b3lyp</span>
<span class="s1">            basis = 6-31+g*</span>
<span class="s1">  geom_opt_coords = 0</span>
<span class="s1">$end</span>

<span class="s1">&#39;&#39;&#39;</span>
        <span class="n">qctask</span> <span class="o">=</span> <span class="n">QcTask</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Test Methane&quot;</span><span class="p">,</span> <span class="n">exchange</span><span class="o">=</span><span class="s2">&quot;B3LYP&quot;</span><span class="p">,</span>
                        <span class="n">jobtype</span><span class="o">=</span><span class="s2">&quot;SP&quot;</span><span class="p">,</span>
                        <span class="n">basis_set</span><span class="o">=</span><span class="s2">&quot;6-31+G*&quot;</span><span class="p">)</span>
        <span class="n">qctask</span><span class="o">.</span><span class="n">set_geom_opt_coords_type</span><span class="p">(</span><span class="s2">&quot;cartesian&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">qctask</span><span class="p">),</span> <span class="n">ans</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">elementary_io_verify</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="n">qctask</span><span class="p">)</span></div>

<div class="viewcode-block" id="QcTaskTest.test_scale_geom_opt_threshold"><a class="viewcode-back" href="../../../../pymatgen.io.tests.test_qchem.html#pymatgen.io.tests.test_qchem.QcTaskTest.test_scale_geom_opt_threshold">[docs]</a>    <span class="k">def</span> <span class="nf">test_scale_geom_opt_threshold</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;$comment</span>
<span class="s1"> Test Methane</span>
<span class="s1">$end</span>


<span class="s1">$molecule</span>
<span class="s1"> 0  1</span>
<span class="s1"> C           0.00000000        0.00000000        0.00000000</span>
<span class="s1"> H           0.00000000        0.00000000        1.08900000</span>
<span class="s1"> H           1.02671900        0.00000000       -0.36300000</span>
<span class="s1"> H          -0.51336000       -0.88916500       -0.36300000</span>
<span class="s1"> Cl         -0.51336000        0.88916500       -0.36300000</span>
<span class="s1">$end</span>


<span class="s1">$rem</span>
<span class="s1">                    jobtype = sp</span>
<span class="s1">                   exchange = b3lyp</span>
<span class="s1">                      basis = 6-31+g*</span>
<span class="s1">  geom_opt_tol_displacement = 120</span>
<span class="s1">        geom_opt_tol_energy = 10</span>
<span class="s1">      geom_opt_tol_gradient = 30</span>
<span class="s1">$end</span>

<span class="s1">&#39;&#39;&#39;</span>
        <span class="n">qctask</span> <span class="o">=</span> <span class="n">QcTask</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Test Methane&quot;</span><span class="p">,</span> <span class="n">exchange</span><span class="o">=</span><span class="s2">&quot;B3LYP&quot;</span><span class="p">,</span>
                        <span class="n">jobtype</span><span class="o">=</span><span class="s2">&quot;SP&quot;</span><span class="p">,</span>
                        <span class="n">basis_set</span><span class="o">=</span><span class="s2">&quot;6-31+G*&quot;</span><span class="p">)</span>
        <span class="n">qctask</span><span class="o">.</span><span class="n">scale_geom_opt_threshold</span><span class="p">(</span><span class="n">gradient</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">displacement</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
                                        <span class="n">energy</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">qctask</span><span class="p">),</span> <span class="n">ans</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">elementary_io_verify</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="n">qctask</span><span class="p">)</span></div>

<div class="viewcode-block" id="QcTaskTest.test_set_geom_opt_use_gdiis"><a class="viewcode-back" href="../../../../pymatgen.io.tests.test_qchem.html#pymatgen.io.tests.test_qchem.QcTaskTest.test_set_geom_opt_use_gdiis">[docs]</a>    <span class="k">def</span> <span class="nf">test_set_geom_opt_use_gdiis</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;$comment</span>
<span class="s1"> Test Methane</span>
<span class="s1">$end</span>


<span class="s1">$molecule</span>
<span class="s1"> 0  1</span>
<span class="s1"> C           0.00000000        0.00000000        0.00000000</span>
<span class="s1"> H           0.00000000        0.00000000        1.08900000</span>
<span class="s1"> H           1.02671900        0.00000000       -0.36300000</span>
<span class="s1"> H          -0.51336000       -0.88916500       -0.36300000</span>
<span class="s1"> Cl         -0.51336000        0.88916500       -0.36300000</span>
<span class="s1">$end</span>


<span class="s1">$rem</span>
<span class="s1">            jobtype = sp</span>
<span class="s1">           exchange = b3lyp</span>
<span class="s1">              basis = 6-31+g*</span>
<span class="s1">  geom_opt_max_diis = -1</span>
<span class="s1">$end</span>

<span class="s1">&#39;&#39;&#39;</span>
        <span class="n">qctask</span> <span class="o">=</span> <span class="n">QcTask</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Test Methane&quot;</span><span class="p">,</span> <span class="n">exchange</span><span class="o">=</span><span class="s2">&quot;B3LYP&quot;</span><span class="p">,</span>
                        <span class="n">jobtype</span><span class="o">=</span><span class="s2">&quot;SP&quot;</span><span class="p">,</span>
                        <span class="n">basis_set</span><span class="o">=</span><span class="s2">&quot;6-31+G*&quot;</span><span class="p">)</span>
        <span class="n">qctask</span><span class="o">.</span><span class="n">set_geom_opt_use_gdiis</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">qctask</span><span class="p">),</span> <span class="n">ans</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">elementary_io_verify</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="n">qctask</span><span class="p">)</span></div>

<div class="viewcode-block" id="QcTaskTest.test_disable_symmetry"><a class="viewcode-back" href="../../../../pymatgen.io.tests.test_qchem.html#pymatgen.io.tests.test_qchem.QcTaskTest.test_disable_symmetry">[docs]</a>    <span class="k">def</span> <span class="nf">test_disable_symmetry</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;$comment</span>
<span class="s1"> Test Methane</span>
<span class="s1">$end</span>


<span class="s1">$molecule</span>
<span class="s1"> 0  1</span>
<span class="s1"> C           0.00000000        0.00000000        0.00000000</span>
<span class="s1"> H           0.00000000        0.00000000        1.08900000</span>
<span class="s1"> H           1.02671900        0.00000000       -0.36300000</span>
<span class="s1"> H          -0.51336000       -0.88916500       -0.36300000</span>
<span class="s1"> Cl         -0.51336000        0.88916500       -0.36300000</span>
<span class="s1">$end</span>


<span class="s1">$rem</span>
<span class="s1">     jobtype = sp</span>
<span class="s1">    exchange = b3lyp</span>
<span class="s1">       basis = 6-31+g*</span>
<span class="s1">  sym_ignore = True</span>
<span class="s1">    symmetry = False</span>
<span class="s1">$end</span>

<span class="s1">&#39;&#39;&#39;</span>
        <span class="n">qctask</span> <span class="o">=</span> <span class="n">QcTask</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Test Methane&quot;</span><span class="p">,</span> <span class="n">exchange</span><span class="o">=</span><span class="s2">&quot;B3LYP&quot;</span><span class="p">,</span>
                        <span class="n">jobtype</span><span class="o">=</span><span class="s2">&quot;SP&quot;</span><span class="p">,</span>
                        <span class="n">basis_set</span><span class="o">=</span><span class="s2">&quot;6-31+G*&quot;</span><span class="p">)</span>
        <span class="n">qctask</span><span class="o">.</span><span class="n">disable_symmetry</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">qctask</span><span class="p">),</span> <span class="n">ans</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">elementary_io_verify</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="n">qctask</span><span class="p">)</span></div>

<div class="viewcode-block" id="QcTaskTest.test_use_cosmo"><a class="viewcode-back" href="../../../../pymatgen.io.tests.test_qchem.html#pymatgen.io.tests.test_qchem.QcTaskTest.test_use_cosmo">[docs]</a>    <span class="k">def</span> <span class="nf">test_use_cosmo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;$comment</span>
<span class="s1"> Test Methane</span>
<span class="s1">$end</span>


<span class="s1">$molecule</span>
<span class="s1"> 0  1</span>
<span class="s1"> C           0.00000000        0.00000000        0.00000000</span>
<span class="s1"> H           0.00000000        0.00000000        1.08900000</span>
<span class="s1"> H           1.02671900        0.00000000       -0.36300000</span>
<span class="s1"> H          -0.51336000       -0.88916500       -0.36300000</span>
<span class="s1"> Cl         -0.51336000        0.88916500       -0.36300000</span>
<span class="s1">$end</span>


<span class="s1">$rem</span>
<span class="s1">             jobtype = sp</span>
<span class="s1">            exchange = b3lyp</span>
<span class="s1">               basis = 6-31+g*</span>
<span class="s1">  solvent_dielectric = 35.0</span>
<span class="s1">      solvent_method = cosmo</span>
<span class="s1">$end</span>

<span class="s1">&#39;&#39;&#39;</span>
        <span class="n">qctask</span> <span class="o">=</span> <span class="n">QcTask</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Test Methane&quot;</span><span class="p">,</span> <span class="n">exchange</span><span class="o">=</span><span class="s2">&quot;B3LYP&quot;</span><span class="p">,</span>
                        <span class="n">jobtype</span><span class="o">=</span><span class="s2">&quot;SP&quot;</span><span class="p">,</span>
                        <span class="n">basis_set</span><span class="o">=</span><span class="s2">&quot;6-31+G*&quot;</span><span class="p">)</span>
        <span class="n">qctask</span><span class="o">.</span><span class="n">use_cosmo</span><span class="p">(</span><span class="n">dielectric_constant</span><span class="o">=</span><span class="mf">35.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">qctask</span><span class="p">),</span> <span class="n">ans</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">elementary_io_verify</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="n">qctask</span><span class="p">)</span></div>

<div class="viewcode-block" id="QcTaskTest.test_wrap_comment"><a class="viewcode-back" href="../../../../pymatgen.io.tests.test_qchem.html#pymatgen.io.tests.test_qchem.QcTaskTest.test_wrap_comment">[docs]</a>    <span class="k">def</span> <span class="nf">test_wrap_comment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;$comment</span>
<span class="s1"> 5_2_2_methoxyethoxy_ethoxy_6_nitro_1_3_dihydro_2_1_3_benzothiadiazole</span>
<span class="s1">singlet neutral B3lYP/6-31+G* geometry optimization</span>
<span class="s1">$end</span>


<span class="s1">$molecule</span>
<span class="s1"> 0  1</span>
<span class="s1"> C           0.00000000        0.00000000        0.00000000</span>
<span class="s1"> H           0.00000000        0.00000000        1.08900000</span>
<span class="s1"> H           1.02671900        0.00000000       -0.36300000</span>
<span class="s1"> H          -0.51336000       -0.88916500       -0.36300000</span>
<span class="s1"> Cl         -0.51336000        0.88916500       -0.36300000</span>
<span class="s1">$end</span>


<span class="s1">$rem</span>
<span class="s1">   jobtype = sp</span>
<span class="s1">  exchange = b3lyp</span>
<span class="s1">     basis = 6-31+g*</span>
<span class="s1">$end</span>

<span class="s1">&#39;&#39;&#39;</span>
        <span class="n">qctask</span> <span class="o">=</span> <span class="n">QcTask</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;    5_2_2_methoxyethoxy_ethoxy_6_nitro_1_3_dihydro_2_1_3_benzothiadiazole singlet &quot;</span>
                                   <span class="s2">&quot;neutral B3lYP/6-31+G* geometry optimization&quot;</span><span class="p">,</span> <span class="n">exchange</span><span class="o">=</span><span class="s2">&quot;B3LYP&quot;</span><span class="p">,</span>
                        <span class="n">jobtype</span><span class="o">=</span><span class="s2">&quot;SP&quot;</span><span class="p">,</span>
                        <span class="n">basis_set</span><span class="o">=</span><span class="s2">&quot;6-31+G*&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">qctask</span><span class="p">),</span> <span class="n">ans</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">elementary_io_verify</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="n">qctask</span><span class="p">)</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39; MgBPh42 singlet neutral PBE-D3/6-31+G* geometry optimization</span>
<span class="s1">&lt;SCF Fix Strategy&gt;{</span>
<span class="s1">    &quot;current_method_id&quot;: 1,</span>
<span class="s1">    &quot;methods&quot;: [</span>
<span class="s1">        &quot;increase_iter&quot;,</span>
<span class="s1">        &quot;diis_gdm&quot;,</span>
<span class="s1">        &quot;gwh&quot;,</span>
<span class="s1">        &quot;rca&quot;,</span>
<span class="s1">        &quot;gdm&quot;,</span>
<span class="s1">        &quot;core+gdm&quot;</span>
<span class="s1">    ]</span>
<span class="s1">}&lt;/SCF Fix Strategy&gt;&#39;&#39;&#39;</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;$comment</span>
<span class="s1"> MgBPh42 singlet neutral PBE-D3/6-31+G* geometry optimization</span>
<span class="s1">&lt;SCF Fix Strategy&gt;{</span>
<span class="s1">    &quot;current_method_id&quot;: 1,</span>
<span class="s1">    &quot;methods&quot;: [</span>
<span class="s1">        &quot;increase_iter&quot;,</span>
<span class="s1">        &quot;diis_gdm&quot;,</span>
<span class="s1">        &quot;gwh&quot;,</span>
<span class="s1">        &quot;rca&quot;,</span>
<span class="s1">        &quot;gdm&quot;,</span>
<span class="s1">        &quot;core+gdm&quot;</span>
<span class="s1">    ]</span>
<span class="s1">}&lt;/SCF Fix Strategy&gt;</span>
<span class="s1">$end</span>


<span class="s1">$molecule</span>
<span class="s1"> 0  1</span>
<span class="s1"> C           0.00000000        0.00000000        0.00000000</span>
<span class="s1"> H           0.00000000        0.00000000        1.08900000</span>
<span class="s1"> H           1.02671900        0.00000000       -0.36300000</span>
<span class="s1"> H          -0.51336000       -0.88916500       -0.36300000</span>
<span class="s1"> Cl         -0.51336000        0.88916500       -0.36300000</span>
<span class="s1">$end</span>


<span class="s1">$rem</span>
<span class="s1">   jobtype = sp</span>
<span class="s1">  exchange = b3lyp</span>
<span class="s1">     basis = 6-31+g*</span>
<span class="s1">$end</span>

<span class="s1">&#39;&#39;&#39;</span>
        <span class="n">qctask</span> <span class="o">=</span> <span class="n">QcTask</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">exchange</span><span class="o">=</span><span class="s2">&quot;B3LYP&quot;</span><span class="p">,</span> <span class="n">jobtype</span><span class="o">=</span><span class="s2">&quot;SP&quot;</span><span class="p">,</span> <span class="n">basis_set</span><span class="o">=</span><span class="s2">&quot;6-31+G*&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">qctask</span><span class="p">),</span> <span class="n">ans</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">elementary_io_verify</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="n">qctask</span><span class="p">)</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot; 5_2_2_methoxyethoxy_ethoxy_6_nitro_1_3_dihydro_2_1_3_benzothiadiazole singlet neutral &quot;</span> \
                <span class="s2">&quot;B3lYP/6-31+G* geometry optimization&quot;</span> <span class="o">+</span> \
                <span class="sd">&#39;&#39;&#39;&lt;SCF Fix Strategy&gt;{</span>
<span class="sd">    &quot;current_method_id&quot;: 1,</span>
<span class="sd">    &quot;methods&quot;: [</span>
<span class="sd">        &quot;increase_iter&quot;,</span>
<span class="sd">        &quot;diis_gdm&quot;,</span>
<span class="sd">        &quot;gwh&quot;,</span>
<span class="sd">        &quot;rca&quot;,</span>
<span class="sd">        &quot;gdm&quot;,</span>
<span class="sd">        &quot;core+gdm&quot;</span>
<span class="sd">    ]</span>
<span class="sd">}&lt;/SCF Fix Strategy&gt;&#39;&#39;&#39;</span>
        <span class="n">qctask</span> <span class="o">=</span> <span class="n">QcTask</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">exchange</span><span class="o">=</span><span class="s2">&quot;B3LYP&quot;</span><span class="p">,</span> <span class="n">jobtype</span><span class="o">=</span><span class="s2">&quot;SP&quot;</span><span class="p">,</span> <span class="n">basis_set</span><span class="o">=</span><span class="s2">&quot;6-31+G*&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">elementary_io_verify</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">qctask</span><span class="p">),</span> <span class="n">qctask</span><span class="p">)</span></div>

<div class="viewcode-block" id="QcTaskTest.test_use_pcm_qc41"><a class="viewcode-back" href="../../../../pymatgen.io.tests.test_qchem.html#pymatgen.io.tests.test_qchem.QcTaskTest.test_use_pcm_qc41">[docs]</a>    <span class="k">def</span> <span class="nf">test_use_pcm_qc41</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;$comment</span>
<span class="s1"> Test Methane</span>
<span class="s1">$end</span>


<span class="s1">$molecule</span>
<span class="s1"> 0  1</span>
<span class="s1"> C           0.00000000        0.00000000        0.00000000</span>
<span class="s1"> H           0.00000000        0.00000000        1.08900000</span>
<span class="s1"> H           1.02671900        0.00000000       -0.36300000</span>
<span class="s1"> H          -0.51336000       -0.88916500       -0.36300000</span>
<span class="s1"> Cl         -0.51336000        0.88916500       -0.36300000</span>
<span class="s1">$end</span>


<span class="s1">$rem</span>
<span class="s1">         jobtype = sp</span>
<span class="s1">        exchange = b3lyp</span>
<span class="s1">           basis = 6-31+g*</span>
<span class="s1">  solvent_method = pcm</span>
<span class="s1">$end</span>


<span class="s1">$pcm</span>
<span class="s1">     radii   uff</span>
<span class="s1">    theory   ssvpe</span>
<span class="s1">  vdwscale   1.1</span>
<span class="s1">$end</span>


<span class="s1">$pcm_solvent</span>
<span class="s1">  dielectric   78.3553</span>
<span class="s1">$end</span>

<span class="s1">&#39;&#39;&#39;</span>
        <span class="n">qctask</span> <span class="o">=</span> <span class="n">QcTask</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Test Methane&quot;</span><span class="p">,</span> <span class="n">exchange</span><span class="o">=</span><span class="s2">&quot;B3LYP&quot;</span><span class="p">,</span>
                        <span class="n">jobtype</span><span class="o">=</span><span class="s2">&quot;SP&quot;</span><span class="p">,</span>
                        <span class="n">basis_set</span><span class="o">=</span><span class="s2">&quot;6-31+G*&quot;</span><span class="p">)</span>
        <span class="n">qctask</span><span class="o">.</span><span class="n">use_pcm</span><span class="p">(</span><span class="n">solvent_key</span><span class="o">=</span><span class="s2">&quot;pcm_solvent&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">qctask</span><span class="p">),</span> <span class="n">ans</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">elementary_io_verify</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="n">qctask</span><span class="p">)</span>

        <span class="n">qctask</span> <span class="o">=</span> <span class="n">QcTask</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Test Methane&quot;</span><span class="p">,</span> <span class="n">exchange</span><span class="o">=</span><span class="s2">&quot;B3LYP&quot;</span><span class="p">,</span>
                        <span class="n">jobtype</span><span class="o">=</span><span class="s2">&quot;SP&quot;</span><span class="p">,</span>
                        <span class="n">basis_set</span><span class="o">=</span><span class="s2">&quot;6-31+G*&quot;</span><span class="p">)</span>
        <span class="n">qctask</span><span class="o">.</span><span class="n">use_pcm</span><span class="p">(</span><span class="n">pcm_params</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Radii&quot;</span><span class="p">:</span> <span class="s2">&quot;FF&quot;</span><span class="p">,</span>
                                   <span class="s2">&quot;Theory&quot;</span><span class="p">:</span> <span class="s2">&quot;CPCM&quot;</span><span class="p">,</span>
                                   <span class="s2">&quot;SASrad&quot;</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">,</span>
                                   <span class="s2">&quot;HPoints&quot;</span><span class="p">:</span> <span class="mi">1202</span><span class="p">},</span>
                       <span class="n">solvent_params</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Dielectric&quot;</span><span class="p">:</span> <span class="mf">20.0</span><span class="p">,</span>
                                       <span class="s2">&quot;Temperature&quot;</span><span class="p">:</span> <span class="mf">300.75</span><span class="p">,</span>
                                       <span class="s2">&quot;NSolventAtoms&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
                                       <span class="s2">&quot;SolventAtom&quot;</span><span class="p">:</span> <span class="p">[[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">186</span><span class="p">,</span> <span class="mf">1.30</span><span class="p">],</span>
                                                       <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">187</span><span class="p">,</span> <span class="mf">1.01</span><span class="p">]]},</span>
                       <span class="n">radii_force_field</span><span class="o">=</span><span class="s2">&quot;OPLSAA&quot;</span><span class="p">,</span>
                       <span class="n">solvent_key</span><span class="o">=</span><span class="s2">&quot;pcm_solvent&quot;</span><span class="p">)</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;$comment</span>
<span class="s1"> Test Methane</span>
<span class="s1">$end</span>


<span class="s1">$molecule</span>
<span class="s1"> 0  1</span>
<span class="s1"> C           0.00000000        0.00000000        0.00000000</span>
<span class="s1"> H           0.00000000        0.00000000        1.08900000</span>
<span class="s1"> H           1.02671900        0.00000000       -0.36300000</span>
<span class="s1"> H          -0.51336000       -0.88916500       -0.36300000</span>
<span class="s1"> Cl         -0.51336000        0.88916500       -0.36300000</span>
<span class="s1">$end</span>


<span class="s1">$rem</span>
<span class="s1">         jobtype = sp</span>
<span class="s1">        exchange = b3lyp</span>
<span class="s1">           basis = 6-31+g*</span>
<span class="s1">      force_fied = oplsaa</span>
<span class="s1">  solvent_method = pcm</span>
<span class="s1">$end</span>


<span class="s1">$pcm</span>
<span class="s1">   hpoints   1202</span>
<span class="s1">     radii   bondi</span>
<span class="s1">    sasrad   1.5</span>
<span class="s1">    theory   cpcm</span>
<span class="s1">  vdwscale   1.1</span>
<span class="s1">$end</span>


<span class="s1">$pcm_solvent</span>
<span class="s1">     dielectric   20.0</span>
<span class="s1">  nsolventatoms   2</span>
<span class="s1">    solventatom   8    1    186  1.30</span>
<span class="s1">    solventatom   1    2    187  1.01</span>
<span class="s1">    temperature   300.75</span>
<span class="s1">$end</span>

<span class="s1">&#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">qctask</span><span class="p">),</span> <span class="n">ans</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">elementary_io_verify</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="n">qctask</span><span class="p">)</span></div>

<div class="viewcode-block" id="QcTaskTest.test_use_pcm_qc42"><a class="viewcode-back" href="../../../../pymatgen.io.tests.test_qchem.html#pymatgen.io.tests.test_qchem.QcTaskTest.test_use_pcm_qc42">[docs]</a>    <span class="k">def</span> <span class="nf">test_use_pcm_qc42</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;$comment</span>
<span class="s1"> Test Methane</span>
<span class="s1">$end</span>


<span class="s1">$molecule</span>
<span class="s1"> 0  1</span>
<span class="s1"> C           0.00000000        0.00000000        0.00000000</span>
<span class="s1"> H           0.00000000        0.00000000        1.08900000</span>
<span class="s1"> H           1.02671900        0.00000000       -0.36300000</span>
<span class="s1"> H          -0.51336000       -0.88916500       -0.36300000</span>
<span class="s1"> Cl         -0.51336000        0.88916500       -0.36300000</span>
<span class="s1">$end</span>


<span class="s1">$rem</span>
<span class="s1">         jobtype = sp</span>
<span class="s1">        exchange = b3lyp</span>
<span class="s1">           basis = 6-31+g*</span>
<span class="s1">  solvent_method = pcm</span>
<span class="s1">$end</span>


<span class="s1">$pcm</span>
<span class="s1">     radii   uff</span>
<span class="s1">    theory   ssvpe</span>
<span class="s1">  vdwscale   1.1</span>
<span class="s1">$end</span>


<span class="s1">$solvent</span>
<span class="s1">  dielectric   78.3553</span>
<span class="s1">$end</span>

<span class="s1">&#39;&#39;&#39;</span>
        <span class="n">qctask</span> <span class="o">=</span> <span class="n">QcTask</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Test Methane&quot;</span><span class="p">,</span> <span class="n">exchange</span><span class="o">=</span><span class="s2">&quot;B3LYP&quot;</span><span class="p">,</span>
                        <span class="n">jobtype</span><span class="o">=</span><span class="s2">&quot;SP&quot;</span><span class="p">,</span>
                        <span class="n">basis_set</span><span class="o">=</span><span class="s2">&quot;6-31+G*&quot;</span><span class="p">)</span>
        <span class="n">qctask</span><span class="o">.</span><span class="n">use_pcm</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">qctask</span><span class="p">),</span> <span class="n">ans</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">elementary_io_verify</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="n">qctask</span><span class="p">)</span>

        <span class="n">qctask</span> <span class="o">=</span> <span class="n">QcTask</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Test Methane&quot;</span><span class="p">,</span> <span class="n">exchange</span><span class="o">=</span><span class="s2">&quot;B3LYP&quot;</span><span class="p">,</span>
                        <span class="n">jobtype</span><span class="o">=</span><span class="s2">&quot;SP&quot;</span><span class="p">,</span>
                        <span class="n">basis_set</span><span class="o">=</span><span class="s2">&quot;6-31+G*&quot;</span><span class="p">)</span>
        <span class="n">qctask</span><span class="o">.</span><span class="n">use_pcm</span><span class="p">(</span><span class="n">pcm_params</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Radii&quot;</span><span class="p">:</span> <span class="s2">&quot;FF&quot;</span><span class="p">,</span>
                                   <span class="s2">&quot;Theory&quot;</span><span class="p">:</span> <span class="s2">&quot;CPCM&quot;</span><span class="p">,</span>
                                   <span class="s2">&quot;SASrad&quot;</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">,</span>
                                   <span class="s2">&quot;HPoints&quot;</span><span class="p">:</span> <span class="mi">1202</span><span class="p">},</span>
                       <span class="n">solvent_params</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Dielectric&quot;</span><span class="p">:</span> <span class="mf">20.0</span><span class="p">,</span>
                                       <span class="s2">&quot;Temperature&quot;</span><span class="p">:</span> <span class="mf">300.75</span><span class="p">,</span>
                                       <span class="s2">&quot;NSolventAtoms&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
                                       <span class="s2">&quot;SolventAtom&quot;</span><span class="p">:</span> <span class="p">[[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">186</span><span class="p">,</span> <span class="mf">1.30</span><span class="p">],</span>
                                                       <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">187</span><span class="p">,</span> <span class="mf">1.01</span><span class="p">]]},</span>
                       <span class="n">radii_force_field</span><span class="o">=</span><span class="s2">&quot;OPLSAA&quot;</span><span class="p">)</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;$comment</span>
<span class="s1"> Test Methane</span>
<span class="s1">$end</span>


<span class="s1">$molecule</span>
<span class="s1"> 0  1</span>
<span class="s1"> C           0.00000000        0.00000000        0.00000000</span>
<span class="s1"> H           0.00000000        0.00000000        1.08900000</span>
<span class="s1"> H           1.02671900        0.00000000       -0.36300000</span>
<span class="s1"> H          -0.51336000       -0.88916500       -0.36300000</span>
<span class="s1"> Cl         -0.51336000        0.88916500       -0.36300000</span>
<span class="s1">$end</span>


<span class="s1">$rem</span>
<span class="s1">         jobtype = sp</span>
<span class="s1">        exchange = b3lyp</span>
<span class="s1">           basis = 6-31+g*</span>
<span class="s1">      force_fied = oplsaa</span>
<span class="s1">  solvent_method = pcm</span>
<span class="s1">$end</span>


<span class="s1">$pcm</span>
<span class="s1">   hpoints   1202</span>
<span class="s1">     radii   bondi</span>
<span class="s1">    sasrad   1.5</span>
<span class="s1">    theory   cpcm</span>
<span class="s1">  vdwscale   1.1</span>
<span class="s1">$end</span>


<span class="s1">$solvent</span>
<span class="s1">     dielectric   20.0</span>
<span class="s1">  nsolventatoms   2</span>
<span class="s1">    solventatom   8    1    186  1.30</span>
<span class="s1">    solventatom   1    2    187  1.01</span>
<span class="s1">    temperature   300.75</span>
<span class="s1">$end</span>

<span class="s1">&#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">qctask</span><span class="p">),</span> <span class="n">ans</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">elementary_io_verify</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="n">qctask</span><span class="p">)</span></div>

<div class="viewcode-block" id="QcTaskTest.test_ghost_atoms"><a class="viewcode-back" href="../../../../pymatgen.io.tests.test_qchem.html#pymatgen.io.tests.test_qchem.QcTaskTest.test_ghost_atoms">[docs]</a>    <span class="k">def</span> <span class="nf">test_ghost_atoms</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">qctask</span> <span class="o">=</span> <span class="n">QcTask</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">charge</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">spin_multiplicity</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">exchange</span><span class="o">=</span><span class="s2">&quot;B3LYP&quot;</span><span class="p">,</span> <span class="n">ghost_atoms</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;$molecule</span>
<span class="s2"> 0  1</span>
<span class="s2"> C           0.00000000        0.00000000        0.00000000</span>
<span class="s2"> H           0.00000000        0.00000000        1.08900000</span>
<span class="s2"> @H          1.02671900        0.00000000       -0.36300000</span>
<span class="s2"> H          -0.51336000       -0.88916500       -0.36300000</span>
<span class="s2"> @Cl        -0.51336000        0.88916500       -0.36300000</span>
<span class="s2">$end</span>


<span class="s2">$rem</span>
<span class="s2">   jobtype = sp</span>
<span class="s2">  exchange = b3lyp</span>
<span class="s2">     basis = 6-31+g*</span>
<span class="s2">$end</span>

<span class="s2">&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">qctask</span><span class="p">),</span> <span class="n">ans</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">elementary_io_verify</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="n">qctask</span><span class="p">)</span>
        <span class="n">mol1</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
        <span class="n">mol1</span><span class="o">.</span><span class="n">set_charge_and_spin</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">mol2</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">water_mol</span><span class="p">)</span>
        <span class="n">mol2</span><span class="o">.</span><span class="n">set_charge_and_spin</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">qctask</span> <span class="o">=</span> <span class="n">QcTask</span><span class="p">([</span><span class="n">mol1</span><span class="p">,</span> <span class="n">mol2</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Test Fragments&quot;</span><span class="p">,</span> <span class="n">exchange</span><span class="o">=</span><span class="s2">&quot;B3LYP&quot;</span><span class="p">,</span>
                        <span class="n">jobtype</span><span class="o">=</span><span class="s2">&quot;bsse&quot;</span><span class="p">,</span> <span class="n">charge</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">spin_multiplicity</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">basis_set</span><span class="o">=</span><span class="s2">&quot;6-31++G**&quot;</span><span class="p">,</span>
                        <span class="n">ghost_atoms</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">elementary_io_verify</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">qctask</span><span class="p">),</span> <span class="n">qctask</span><span class="p">)</span>
        <span class="n">qctask</span> <span class="o">=</span> <span class="n">QcTask</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">charge</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">spin_multiplicity</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">exchange</span><span class="o">=</span><span class="s2">&quot;B3LYP&quot;</span><span class="p">,</span> <span class="n">ghost_atoms</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">qctask</span><span class="o">.</span><span class="n">spin_multiplicity</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="TestQcInput"><a class="viewcode-back" href="../../../../pymatgen.io.tests.test_qchem.html#pymatgen.io.tests.test_qchem.TestQcInput">[docs]</a><span class="k">class</span> <span class="nc">TestQcInput</span><span class="p">(</span><span class="n">PymatgenTest</span><span class="p">):</span>
<div class="viewcode-block" id="TestQcInput.test_str_and_from_string"><a class="viewcode-back" href="../../../../pymatgen.io.tests.test_qchem.html#pymatgen.io.tests.test_qchem.TestQcInput.test_str_and_from_string">[docs]</a>    <span class="k">def</span> <span class="nf">test_str_and_from_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;$comment</span>
<span class="s1"> Test Methane Opt</span>
<span class="s1">$end</span>


<span class="s1">$molecule</span>
<span class="s1"> 0  1</span>
<span class="s1"> C           0.00000000        0.00000000        0.00000000</span>
<span class="s1"> H           0.00000000        0.00000000        1.08900000</span>
<span class="s1"> H           1.02671900        0.00000000       -0.36300000</span>
<span class="s1"> H          -0.51336000       -0.88916500       -0.36300000</span>
<span class="s1"> Cl         -0.51336000        0.88916500       -0.36300000</span>
<span class="s1">$end</span>


<span class="s1">$rem</span>
<span class="s1">   jobtype = opt</span>
<span class="s1">  exchange = b3lyp</span>
<span class="s1">     basis = 6-31+g*</span>
<span class="s1">$end</span>


<span class="s1">@@@</span>


<span class="s1">$comment</span>
<span class="s1"> Test Methane Frequency</span>
<span class="s1">$end</span>


<span class="s1">$molecule</span>
<span class="s1"> read</span>
<span class="s1">$end</span>


<span class="s1">$rem</span>
<span class="s1">   jobtype = freq</span>
<span class="s1">  exchange = b3lyp</span>
<span class="s1">     basis = 6-31+g*</span>
<span class="s1">$end</span>


<span class="s1">@@@</span>


<span class="s1">$comment</span>
<span class="s1"> Test Methane Single Point Energy</span>
<span class="s1">$end</span>


<span class="s1">$molecule</span>
<span class="s1"> read</span>
<span class="s1">$end</span>


<span class="s1">$rem</span>
<span class="s1">   jobtype = sp</span>
<span class="s1">  exchange = b3lyp</span>
<span class="s1">     basis = 6-311+g(3df,2p)</span>
<span class="s1">$end</span>

<span class="s1">&#39;&#39;&#39;</span>
        <span class="n">qctask1</span> <span class="o">=</span> <span class="n">QcTask</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Test Methane Opt&quot;</span><span class="p">,</span> <span class="n">exchange</span><span class="o">=</span><span class="s2">&quot;B3LYP&quot;</span><span class="p">,</span>
                         <span class="n">jobtype</span><span class="o">=</span><span class="s2">&quot;Opt&quot;</span><span class="p">,</span> <span class="n">basis_set</span><span class="o">=</span><span class="s2">&quot;6-31+G*&quot;</span><span class="p">)</span>
        <span class="n">qctask2</span> <span class="o">=</span> <span class="n">QcTask</span><span class="p">(</span><span class="n">molecule</span><span class="o">=</span><span class="s2">&quot;read&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Test Methane Frequency&quot;</span><span class="p">,</span>
                         <span class="n">exchange</span><span class="o">=</span><span class="s2">&quot;B3LYP&quot;</span><span class="p">,</span> <span class="n">jobtype</span><span class="o">=</span><span class="s2">&quot;Freq&quot;</span><span class="p">,</span> <span class="n">basis_set</span><span class="o">=</span><span class="s2">&quot;6-31+G*&quot;</span><span class="p">)</span>
        <span class="n">qctask3</span> <span class="o">=</span> <span class="n">QcTask</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Test Methane Single Point Energy&quot;</span><span class="p">,</span>
                         <span class="n">exchange</span><span class="o">=</span><span class="s2">&quot;B3LYP&quot;</span><span class="p">,</span> <span class="n">jobtype</span><span class="o">=</span><span class="s2">&quot;SP&quot;</span><span class="p">,</span>
                         <span class="n">basis_set</span><span class="o">=</span><span class="s2">&quot;6-311+G(3df,2p)&quot;</span><span class="p">)</span>
        <span class="n">qcinp1</span> <span class="o">=</span> <span class="n">QcInput</span><span class="p">(</span><span class="n">jobs</span><span class="o">=</span><span class="p">[</span><span class="n">qctask1</span><span class="p">,</span> <span class="n">qctask2</span><span class="p">,</span> <span class="n">qctask3</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">qcinp1</span><span class="p">),</span> <span class="n">ans</span><span class="p">)</span>
        <span class="n">qcinp2</span> <span class="o">=</span> <span class="n">QcInput</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="n">ans</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">qcinp1</span><span class="o">.</span><span class="n">as_dict</span><span class="p">(),</span> <span class="n">qcinp2</span><span class="o">.</span><span class="n">as_dict</span><span class="p">())</span>

        <span class="n">qcinp_mgbf4</span> <span class="o">=</span> <span class="n">QcInput</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">test_dir</span><span class="p">,</span> <span class="s2">&quot;MgBF4_b_overalpped.qcinp&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">qcinp_mgbf4</span><span class="o">.</span><span class="n">jobs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">ghost_atoms</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">])</span></div>

<div class="viewcode-block" id="TestQcInput.test_to_and_from_dict"><a class="viewcode-back" href="../../../../pymatgen.io.tests.test_qchem.html#pymatgen.io.tests.test_qchem.TestQcInput.test_to_and_from_dict">[docs]</a>    <span class="k">def</span> <span class="nf">test_to_and_from_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">qctask1</span> <span class="o">=</span> <span class="n">QcTask</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Test Methane Opt&quot;</span><span class="p">,</span> <span class="n">exchange</span><span class="o">=</span><span class="s2">&quot;B3LYP&quot;</span><span class="p">,</span>
                         <span class="n">jobtype</span><span class="o">=</span><span class="s2">&quot;Opt&quot;</span><span class="p">,</span> <span class="n">basis_set</span><span class="o">=</span><span class="s2">&quot;6-31+G*&quot;</span><span class="p">)</span>
        <span class="n">qctask2</span> <span class="o">=</span> <span class="n">QcTask</span><span class="p">(</span><span class="n">molecule</span><span class="o">=</span><span class="s2">&quot;read&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Test Methane Frequency&quot;</span><span class="p">,</span>
                         <span class="n">exchange</span><span class="o">=</span><span class="s2">&quot;B3LYP&quot;</span><span class="p">,</span> <span class="n">jobtype</span><span class="o">=</span><span class="s2">&quot;Freq&quot;</span><span class="p">,</span>
                         <span class="n">basis_set</span><span class="o">=</span><span class="s2">&quot;6-31+G*&quot;</span><span class="p">)</span>
        <span class="n">qctask3</span> <span class="o">=</span> <span class="n">QcTask</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Test Methane Single Point Energy&quot;</span><span class="p">,</span>
                         <span class="n">exchange</span><span class="o">=</span><span class="s2">&quot;B3LYP&quot;</span><span class="p">,</span> <span class="n">jobtype</span><span class="o">=</span><span class="s2">&quot;SP&quot;</span><span class="p">,</span>
                         <span class="n">basis_set</span><span class="o">=</span><span class="s2">&quot;6-311+G(3df,2p)&quot;</span><span class="p">)</span>
        <span class="n">qcinp1</span> <span class="o">=</span> <span class="n">QcInput</span><span class="p">(</span><span class="n">jobs</span><span class="o">=</span><span class="p">[</span><span class="n">qctask1</span><span class="p">,</span> <span class="n">qctask2</span><span class="p">,</span> <span class="n">qctask3</span><span class="p">])</span>
        <span class="n">d1</span> <span class="o">=</span> <span class="n">qcinp1</span><span class="o">.</span><span class="n">as_dict</span><span class="p">()</span>
        <span class="n">qcinp2</span> <span class="o">=</span> <span class="n">QcInput</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">d1</span><span class="p">)</span>
        <span class="n">d2</span> <span class="o">=</span> <span class="n">qcinp2</span><span class="o">.</span><span class="n">as_dict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">d1</span><span class="p">,</span> <span class="n">d2</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="TestQcOutput"><a class="viewcode-back" href="../../../../pymatgen.io.tests.test_qchem.html#pymatgen.io.tests.test_qchem.TestQcOutput">[docs]</a><span class="k">class</span> <span class="nc">TestQcOutput</span><span class="p">(</span><span class="n">PymatgenTest</span><span class="p">):</span>
<div class="viewcode-block" id="TestQcOutput.test_energy"><a class="viewcode-back" href="../../../../pymatgen.io.tests.test_qchem.html#pymatgen.io.tests.test_qchem.TestQcOutput.test_energy">[docs]</a>    <span class="k">def</span> <span class="nf">test_energy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ref_energies_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">{</span>
<span class="s1">    &quot;hf-rimp2.qcout&quot;: {</span>
<span class="s1">        &quot;RIMP2&quot;: -2726.6860779805256,</span>
<span class="s1">        &quot;SCF&quot;: -2721.541435904716</span>
<span class="s1">    },</span>
<span class="s1">    &quot;hf_b3lyp.qcout&quot;: {</span>
<span class="s1">        &quot;SCF&quot;: -2733.1747178920828</span>
<span class="s1">    },</span>
<span class="s1">    &quot;hf_ccsd(t).qcout&quot;: {</span>
<span class="s1">        &quot;CCSD&quot;: -2726.7627121001865,</span>
<span class="s1">        &quot;CCSD(T)&quot;: -2726.8283514003333,</span>
<span class="s1">        &quot;MP2&quot;: -2726.685664155242,</span>
<span class="s1">        &quot;SCF&quot;: -2721.5414360843106</span>
<span class="s1">    },</span>
<span class="s1">    &quot;hf_cosmo.qcout&quot;: {</span>
<span class="s1">        &quot;SCF&quot;: -2721.1752937496067</span>
<span class="s1">    },</span>
<span class="s1">    &quot;hf_hf.qcout&quot;: {</span>
<span class="s1">        &quot;SCF&quot;: -2721.541435904716</span>
<span class="s1">    },</span>
<span class="s1">    &quot;hf_lxygjos.qcout&quot;: {</span>
<span class="s1">        &quot;SCF&quot;: -2724.0769973875713,</span>
<span class="s1">        &quot;XYGJ-OS&quot;: -2726.3445157759393</span>
<span class="s1">    },</span>
<span class="s1">    &quot;hf_mosmp2.qcout&quot;: {</span>
<span class="s1">        &quot;MOS-MP2&quot;: -2725.302538779482,</span>
<span class="s1">        &quot;SCF&quot;: -2721.541435904716</span>
<span class="s1">    },</span>
<span class="s1">    &quot;hf_mp2.qcout&quot;: {</span>
<span class="s1">        &quot;MP2&quot;: -2726.685661962005,</span>
<span class="s1">        &quot;SCF&quot;: -2721.541435904716</span>
<span class="s1">    },</span>
<span class="s1">    &quot;hf_pcm.qcout&quot;: {</span>
<span class="s1">        &quot;SCF&quot;: -2720.703940318968</span>
<span class="s1">    },</span>
<span class="s1">    &quot;hf_qcisd(t).qcout&quot;: {</span>
<span class="s1">        &quot;QCISD&quot;: -2726.7853751012344,</span>
<span class="s1">        &quot;QCISD(T)&quot;: -2726.8346541282745,</span>
<span class="s1">        &quot;SCF&quot;: -2721.5414360843106</span>
<span class="s1">    },</span>
<span class="s1">    &quot;hf_riccsd(t).qcout&quot;: {</span>
<span class="s1">        &quot;CCSD&quot;: -2726.7641790658904,</span>
<span class="s1">        &quot;CCSD(T)&quot;: -2726.829853468723,</span>
<span class="s1">        &quot;MP2&quot;: -2726.6860802173014,</span>
<span class="s1">        &quot;SCF&quot;: -2721.5414360843106</span>
<span class="s1">    },</span>
<span class="s1">    &quot;hf_tpssh.qcout&quot;: {</span>
<span class="s1">        &quot;SCF&quot;: -2732.938974944255</span>
<span class="s1">    },</span>
<span class="s1">    &quot;hf_xyg3.qcout&quot;: {</span>
<span class="s1">        &quot;SCF&quot;: -2728.769906036435,</span>
<span class="s1">        &quot;XYG3&quot;: -2731.0640917605806</span>
<span class="s1">    },</span>
<span class="s1">    &quot;hf_xygjos.qcout&quot;: {</span>
<span class="s1">        &quot;SCF&quot;: -2724.0769973875713,</span>
<span class="s1">        &quot;XYGJ-OS&quot;: -2726.3447230967517</span>
<span class="s1">    }</span>
<span class="s1">}&#39;&#39;&#39;</span>
        <span class="n">ref_energies</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">ref_energies_text</span><span class="p">)</span>
        <span class="n">parsed_energies</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="c1"># noinspection PyUnresolvedReferences</span>
        <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">test_dir</span><span class="p">,</span> <span class="s2">&quot;qchem_energies&quot;</span><span class="p">,</span>
                                                         <span class="s2">&quot;*.qcout&quot;</span><span class="p">)):</span>
            <span class="n">molname</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
            <span class="n">qcout</span> <span class="o">=</span> <span class="n">QcOutput</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
            <span class="n">d</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">qcout</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;energies&quot;</span><span class="p">])</span>
            <span class="n">parsed_energies</span><span class="p">[</span><span class="n">molname</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">ref_energies</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span>
                         <span class="nb">sorted</span><span class="p">(</span><span class="n">parsed_energies</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
        <span class="n">mols</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">ref_energies</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">molname</span> <span class="ow">in</span> <span class="n">mols</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">ref_energies</span><span class="p">[</span><span class="n">molname</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span>
                             <span class="nb">sorted</span><span class="p">(</span><span class="n">parsed_energies</span><span class="p">[</span><span class="n">molname</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
            <span class="n">methods</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">ref_energies</span><span class="p">[</span><span class="n">molname</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="k">for</span> <span class="n">method</span> <span class="ow">in</span> <span class="n">methods</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertAlmostEqual</span><span class="p">(</span><span class="n">ref_energies</span><span class="p">[</span><span class="n">molname</span><span class="p">][</span><span class="n">method</span><span class="p">],</span>
                                       <span class="n">parsed_energies</span><span class="p">[</span><span class="n">molname</span><span class="p">][</span><span class="n">method</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span></div>

<div class="viewcode-block" id="TestQcOutput.test_unable_to_determine_lambda_in_geom_opt"><a class="viewcode-back" href="../../../../pymatgen.io.tests.test_qchem.html#pymatgen.io.tests.test_qchem.TestQcOutput.test_unable_to_determine_lambda_in_geom_opt">[docs]</a>    <span class="k">def</span> <span class="nf">test_unable_to_determine_lambda_in_geom_opt</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">test_dir</span><span class="p">,</span> <span class="s2">&quot;unable_to_determine_lambda_in_geom_opt.qcout&quot;</span><span class="p">)</span>
        <span class="n">qcout</span> <span class="o">=</span> <span class="n">QcOutput</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">qcout</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;has_error&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">qcout</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;errors&#39;</span><span class="p">],</span>
                         <span class="p">[</span><span class="s1">&#39;Lamda Determination Failed&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;Geometry optimization failed&#39;</span><span class="p">])</span></div>

<div class="viewcode-block" id="TestQcOutput.test_geom_opt"><a class="viewcode-back" href="../../../../pymatgen.io.tests.test_qchem.html#pymatgen.io.tests.test_qchem.TestQcOutput.test_geom_opt">[docs]</a>    <span class="k">def</span> <span class="nf">test_geom_opt</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">test_dir</span><span class="p">,</span> <span class="s2">&quot;thiophene_wfs_5_carboxyl.qcout&quot;</span><span class="p">)</span>
        <span class="n">qcout</span> <span class="o">=</span> <span class="n">QcOutput</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">qcout</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;jobtype&quot;</span><span class="p">],</span> <span class="s2">&quot;opt&quot;</span><span class="p">)</span>
        <span class="n">ans_energies</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">u&#39;SCF&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">20179.886441383995</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">u&#39;SCF&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">20180.12187218424</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">u&#39;SCF&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">20180.150524404988</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">u&#39;SCF&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">20180.151628362753</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">u&#39;SCF&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">20180.151810235497</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">u&#39;SCF&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">20180.15180854295</span><span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">qcout</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;energies&quot;</span><span class="p">],</span> <span class="n">ans_energies</span><span class="p">)</span>
        <span class="n">ans_mol1</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;Full Formula (H4 C5 S1 O2)</span>
<span class="s1">Reduced Formula: H4C5SO2</span>
<span class="s1">Charge = -1, Spin Mult = 2</span>
<span class="s1">Sites (12)</span>
<span class="s1">0 C     0.158839    -0.165379     0.000059</span>
<span class="s1">1 C    -0.520531    -1.366720     0.000349</span>
<span class="s1">2 C    -1.930811    -1.198460    -0.000041</span>
<span class="s1">3 C    -2.297971     0.127429    -0.000691</span>
<span class="s1">4 S    -0.938312     1.189630     0.000400</span>
<span class="s1">5 H    -0.014720    -2.325340     0.000549</span>
<span class="s1">6 H    -2.641720    -2.017721    -0.000161</span>
<span class="s1">7 H    -3.301032     0.535659    -0.001261</span>
<span class="s1">8 C     1.603079     0.076231    -0.000101</span>
<span class="s1">9 O     2.131988     1.173581    -0.000330</span>
<span class="s1">10 O     2.322109    -1.079218    -0.000021</span>
<span class="s1">11 H     3.262059    -0.820188    -0.000171&#39;&#39;&#39;</span>
        <span class="n">ans_mol_last</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;Full Formula (H4 C5 S1 O2)</span>
<span class="s1">Reduced Formula: H4C5SO2</span>
<span class="s1">Charge = -1, Spin Mult = 2</span>
<span class="s1">Sites (12)</span>
<span class="s1">0 C     0.194695    -0.158362    -0.001887</span>
<span class="s1">1 C    -0.535373    -1.381241    -0.001073</span>
<span class="s1">2 C    -1.927071    -1.199274    -0.000052</span>
<span class="s1">3 C    -2.332651     0.131916     0.000329</span>
<span class="s1">4 S    -0.942111     1.224916    -0.001267</span>
<span class="s1">5 H    -0.038260    -2.345185    -0.001256</span>
<span class="s1">6 H    -2.636299    -2.025939     0.000620</span>
<span class="s1">7 H    -3.339756     0.529895     0.001288</span>
<span class="s1">8 C     1.579982     0.071245    -0.002733</span>
<span class="s1">9 O     2.196383     1.165675    -0.000178</span>
<span class="s1">10 O     2.352341    -1.114671     0.001634</span>
<span class="s1">11 H     3.261096    -0.769470     0.003158&#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">qcout</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;molecules&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">__str__</span><span class="p">(),</span> <span class="n">ans_mol1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">qcout</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;molecules&quot;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span> <span class="n">ans_mol_last</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">qcout</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;has_error&quot;</span><span class="p">])</span>
        <span class="n">ans_gradient</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;max_gradient&#39;</span><span class="p">:</span> <span class="mf">0.07996</span><span class="p">,</span>
                         <span class="s1">&#39;gradients&#39;</span><span class="p">:</span> <span class="p">[(</span><span class="o">-</span><span class="mf">0.0623076</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0157774</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.05e-05</span><span class="p">),</span>
                                       <span class="p">(</span><span class="mf">0.0260287</span><span class="p">,</span> <span class="mf">0.0289157</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="n">e</span><span class="o">-</span><span class="mi">06</span><span class="p">),</span>
                                       <span class="p">(</span><span class="o">-</span><span class="mf">0.015738</span><span class="p">,</span> <span class="mf">0.0103583</span><span class="p">,</span> <span class="mf">1.87e-05</span><span class="p">),</span>
                                       <span class="p">(</span><span class="mf">0.0260219</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0028</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.36e-05</span><span class="p">),</span>
                                       <span class="p">(</span><span class="o">-</span><span class="mf">0.0043158</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0245896</span><span class="p">,</span> <span class="mf">2.83e-05</span><span class="p">),</span>
                                       <span class="p">(</span><span class="mf">4.8e-05</span><span class="p">,</span> <span class="mf">0.000782</span><span class="p">,</span> <span class="mf">1.3e-06</span><span class="p">),</span>
                                       <span class="p">(</span><span class="mf">0.0014679</span><span class="p">,</span> <span class="mf">0.0020277</span><span class="p">,</span> <span class="mf">3.9e-06</span><span class="p">),</span>
                                       <span class="p">(</span><span class="mf">0.0010437</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.29e-05</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.04e-05</span><span class="p">),</span>
                                       <span class="p">(</span><span class="mf">0.0799585</span><span class="p">,</span> <span class="mf">0.0204159</span><span class="p">,</span> <span class="mi">1</span><span class="n">e</span><span class="o">-</span><span class="mi">06</span><span class="p">),</span>
                                       <span class="p">(</span><span class="o">-</span><span class="mf">0.0320357</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0421461</span><span class="p">,</span> <span class="mf">2.1e-06</span><span class="p">),</span>
                                       <span class="p">(</span><span class="o">-</span><span class="mf">0.0237691</span><span class="p">,</span> <span class="mf">0.0247526</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.6e-06</span><span class="p">),</span>
                                       <span class="p">(</span><span class="mf">0.0035975</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0019264</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="n">e</span><span class="o">-</span><span class="mi">07</span><span class="p">)],</span>
                         <span class="s1">&#39;rms_gradient&#39;</span><span class="p">:</span> <span class="mf">0.02244</span><span class="p">},</span>
                        <span class="p">{</span><span class="s1">&#39;max_gradient&#39;</span><span class="p">:</span> <span class="mf">0.02721</span><span class="p">,</span>
                         <span class="s1">&#39;gradients&#39;</span><span class="p">:</span> <span class="p">[(</span><span class="o">-</span><span class="mf">0.0195677</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0008468</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.2e-06</span><span class="p">),</span>
                                       <span class="p">(</span><span class="mf">0.0106798</span><span class="p">,</span> <span class="mf">0.0039494</span><span class="p">,</span> <span class="mf">1.11e-05</span><span class="p">),</span>
                                       <span class="p">(</span><span class="o">-</span><span class="mf">0.0086473</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0012624</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.1e-06</span><span class="p">),</span>
                                       <span class="p">(</span><span class="mf">0.0065018</span><span class="p">,</span> <span class="mf">0.0033749</span><span class="p">,</span> <span class="mi">5</span><span class="n">e</span><span class="o">-</span><span class="mi">07</span><span class="p">),</span>
                                       <span class="p">(</span><span class="mf">0.0002581</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0060831</span><span class="p">,</span> <span class="mf">7.2e-06</span><span class="p">),</span>
                                       <span class="p">(</span><span class="o">-</span><span class="mf">0.0004373</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.000504</span><span class="p">,</span> <span class="mf">1.4e-06</span><span class="p">),</span>
                                       <span class="p">(</span><span class="mf">0.0003216</span><span class="p">,</span> <span class="mf">0.0001059</span><span class="p">,</span> <span class="o">-</span><span class="mi">9</span><span class="n">e</span><span class="o">-</span><span class="mi">07</span><span class="p">),</span>
                                       <span class="p">(</span><span class="o">-</span><span class="mf">0.000814</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.03e-05</span><span class="p">,</span> <span class="mi">3</span><span class="n">e</span><span class="o">-</span><span class="mi">07</span><span class="p">),</span>
                                       <span class="p">(</span><span class="mf">0.0272109</span><span class="p">,</span> <span class="mf">0.001408</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.06e-05</span><span class="p">),</span>
                                       <span class="p">(</span><span class="o">-</span><span class="mf">0.0086971</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.009251</span><span class="p">,</span> <span class="mf">8.3e-06</span><span class="p">),</span>
                                       <span class="p">(</span><span class="o">-</span><span class="mf">0.0080925</span><span class="p">,</span> <span class="mf">0.0112191</span><span class="p">,</span> <span class="mf">2.9e-06</span><span class="p">),</span>
                                       <span class="p">(</span><span class="mf">0.0012838</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0020597</span><span class="p">,</span> <span class="mf">1.1e-06</span><span class="p">)],</span>
                         <span class="s1">&#39;rms_gradient&#39;</span><span class="p">:</span> <span class="mf">0.007037</span><span class="p">},</span>
                        <span class="p">{</span><span class="s1">&#39;max_gradient&#39;</span><span class="p">:</span> <span class="mf">0.003444</span><span class="p">,</span>
                         <span class="s1">&#39;gradients&#39;</span><span class="p">:</span> <span class="p">[(</span><span class="mf">0.0021606</span><span class="p">,</span> <span class="mf">0.0013094</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.68e-05</span><span class="p">),</span>
                                       <span class="p">(</span><span class="mf">0.0005757</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0002616</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="n">e</span><span class="o">-</span><span class="mi">05</span><span class="p">),</span>
                                       <span class="p">(</span><span class="mf">2.73e-05</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0002868</span><span class="p">,</span> <span class="mf">1.5e-05</span><span class="p">),</span>
                                       <span class="p">(</span><span class="mf">0.0001088</span><span class="p">,</span> <span class="mf">0.0006944</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.23e-05</span><span class="p">),</span>
                                       <span class="p">(</span><span class="mf">0.0006912</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0006523</span><span class="p">,</span> <span class="mf">6.1e-06</span><span class="p">),</span>
                                       <span class="p">(</span><span class="o">-</span><span class="mf">0.0004191</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.32e-05</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.3e-06</span><span class="p">),</span>
                                       <span class="p">(</span><span class="mf">0.0002288</span><span class="p">,</span> <span class="mf">3.98e-05</span><span class="p">,</span> <span class="mf">1.8e-06</span><span class="p">),</span>
                                       <span class="p">(</span><span class="o">-</span><span class="mf">8.99e-05</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0002338</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.2e-06</span><span class="p">),</span>
                                       <span class="p">(</span><span class="mf">1.95e-05</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0034439</span><span class="p">,</span> <span class="mf">7.08e-05</span><span class="p">),</span>
                                       <span class="p">(</span><span class="o">-</span><span class="mf">0.0008228</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.18e-05</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.77e-05</span><span class="p">),</span>
                                       <span class="p">(</span><span class="o">-</span><span class="mf">0.0018054</span><span class="p">,</span> <span class="mf">0.0034031</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.21e-05</span><span class="p">),</span>
                                       <span class="p">(</span><span class="o">-</span><span class="mf">0.0006747</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0003834</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="n">e</span><span class="o">-</span><span class="mi">07</span><span class="p">)],</span>
                         <span class="s1">&#39;rms_gradient&#39;</span><span class="p">:</span> <span class="mf">0.001008</span><span class="p">},</span>
                        <span class="p">{</span><span class="s1">&#39;max_gradient&#39;</span><span class="p">:</span> <span class="mf">0.002367</span><span class="p">,</span>
                         <span class="s1">&#39;gradients&#39;</span><span class="p">:</span> <span class="p">[(</span><span class="o">-</span><span class="mf">0.0001646</span><span class="p">,</span> <span class="mf">0.0006149</span><span class="p">,</span> <span class="mf">4.17e-05</span><span class="p">),</span>
                                       <span class="p">(</span><span class="o">-</span><span class="mf">0.0004516</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0003116</span><span class="p">,</span> <span class="mf">1.28e-05</span><span class="p">),</span>
                                       <span class="p">(</span><span class="mf">0.0003366</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.27e-05</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.59e-05</span><span class="p">),</span>
                                       <span class="p">(</span><span class="o">-</span><span class="mf">0.0003164</span><span class="p">,</span> <span class="mf">0.0001775</span><span class="p">,</span> <span class="mf">1.37e-05</span><span class="p">),</span>
                                       <span class="p">(</span><span class="mf">0.0001399</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0001201</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.9e-06</span><span class="p">),</span>
                                       <span class="p">(</span><span class="o">-</span><span class="mf">0.0001374</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.58e-05</span><span class="p">,</span> <span class="mi">9</span><span class="n">e</span><span class="o">-</span><span class="mi">07</span><span class="p">),</span>
                                       <span class="p">(</span><span class="o">-</span><span class="mf">1.19e-05</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.93e-05</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.3e-06</span><span class="p">),</span>
                                       <span class="p">(</span><span class="o">-</span><span class="mf">1.76e-05</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0001233</span><span class="p">,</span> <span class="mf">5.1e-06</span><span class="p">),</span>
                                       <span class="p">(</span><span class="mf">9.73e-05</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0023668</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0001609</span><span class="p">),</span>
                                       <span class="p">(</span><span class="mf">0.0006998</span><span class="p">,</span> <span class="mf">0.0009023</span><span class="p">,</span> <span class="mf">6.31e-05</span><span class="p">),</span>
                                       <span class="p">(</span><span class="o">-</span><span class="mf">0.0002169</span><span class="p">,</span> <span class="mf">0.0014874</span><span class="p">,</span> <span class="mf">4.95e-05</span><span class="p">),</span>
                                       <span class="p">(</span><span class="mf">4.28e-05</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0001724</span><span class="p">,</span> <span class="mi">2</span><span class="n">e</span><span class="o">-</span><span class="mi">07</span><span class="p">)],</span>
                         <span class="s1">&#39;rms_gradient&#39;</span><span class="p">:</span> <span class="mf">0.0005339</span><span class="p">},</span>
                        <span class="p">{</span><span class="s1">&#39;max_gradient&#39;</span><span class="p">:</span> <span class="mf">0.001246</span><span class="p">,</span>
                         <span class="s1">&#39;gradients&#39;</span><span class="p">:</span> <span class="p">[(</span><span class="o">-</span><span class="mf">6.88e-05</span><span class="p">,</span> <span class="mf">0.0001757</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.32e-05</span><span class="p">),</span>
                                       <span class="p">(</span><span class="o">-</span><span class="mf">0.0002264</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0001306</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.93e-05</span><span class="p">),</span>
                                       <span class="p">(</span><span class="mf">0.0001526</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.39e-05</span><span class="p">,</span> <span class="mf">2.05e-05</span><span class="p">),</span>
                                       <span class="p">(</span><span class="o">-</span><span class="mf">0.0001401</span><span class="p">,</span> <span class="mf">3.8e-06</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.05e-05</span><span class="p">),</span>
                                       <span class="p">(</span><span class="mf">1.52e-05</span><span class="p">,</span> <span class="mf">0.0001152</span><span class="p">,</span> <span class="mi">8</span><span class="n">e</span><span class="o">-</span><span class="mi">06</span><span class="p">),</span>
                                       <span class="p">(</span><span class="mf">2.01e-05</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.69e-05</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="n">e</span><span class="o">-</span><span class="mi">06</span><span class="p">),</span>
                                       <span class="p">(</span><span class="o">-</span><span class="mf">3.62e-05</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.51e-05</span><span class="p">,</span> <span class="mf">5.5e-06</span><span class="p">),</span>
                                       <span class="p">(</span><span class="mf">1.01e-05</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.23e-05</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.8e-06</span><span class="p">),</span>
                                       <span class="p">(</span><span class="mf">9.73e-05</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0012462</span><span class="p">,</span> <span class="mf">0.0003246</span><span class="p">),</span>
                                       <span class="p">(</span><span class="mf">0.0003926</span><span class="p">,</span> <span class="mf">0.0008331</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0001269</span><span class="p">),</span>
                                       <span class="p">(</span><span class="o">-</span><span class="mf">0.0002294</span><span class="p">,</span> <span class="mf">0.000281</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0001009</span><span class="p">),</span>
                                       <span class="p">(</span><span class="mf">1.3e-05</span><span class="p">,</span> <span class="mf">6.61e-05</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)],</span>
                         <span class="s1">&#39;rms_gradient&#39;</span><span class="p">:</span> <span class="mf">0.0002814</span><span class="p">},</span>
                        <span class="p">{</span><span class="s1">&#39;max_gradient&#39;</span><span class="p">:</span> <span class="mf">0.0006359</span><span class="p">,</span>
                         <span class="s1">&#39;gradients&#39;</span><span class="p">:</span> <span class="p">[(</span><span class="mf">0.0001036</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0001339</span><span class="p">,</span> <span class="mf">0.0001633</span><span class="p">),</span>
                                       <span class="p">(</span><span class="mf">0.0001003</span><span class="p">,</span> <span class="mf">6.98e-05</span><span class="p">,</span> <span class="mf">3.43e-05</span><span class="p">),</span>
                                       <span class="p">(</span><span class="o">-</span><span class="mf">8.28e-05</span><span class="p">,</span> <span class="mf">1.1e-05</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.31e-05</span><span class="p">),</span>
                                       <span class="p">(</span><span class="mf">6.2e-05</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0001068</span><span class="p">,</span> <span class="mf">3.41e-05</span><span class="p">),</span>
                                       <span class="p">(</span><span class="o">-</span><span class="mf">5.02e-05</span><span class="p">,</span> <span class="mf">0.0001346</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.18e-05</span><span class="p">),</span>
                                       <span class="p">(</span><span class="mf">8.72e-05</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.3e-06</span><span class="p">,</span> <span class="mf">1.5e-06</span><span class="p">),</span>
                                       <span class="p">(</span><span class="o">-</span><span class="mf">1.7e-05</span><span class="p">,</span> <span class="mf">4.9e-06</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.05e-05</span><span class="p">),</span>
                                       <span class="p">(</span><span class="mf">1.29e-05</span><span class="p">,</span> <span class="mf">5.9e-05</span><span class="p">,</span> <span class="mf">1.26e-05</span><span class="p">),</span>
                                       <span class="p">(</span><span class="o">-</span><span class="mf">0.0001059</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.4e-06</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0006359</span><span class="p">),</span>
                                       <span class="p">(</span><span class="o">-</span><span class="mf">1.48e-05</span><span class="p">,</span> <span class="mf">0.0002152</span><span class="p">,</span> <span class="mf">0.0002469</span><span class="p">),</span>
                                       <span class="p">(</span><span class="o">-</span><span class="mf">0.0001335</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0003534</span><span class="p">,</span> <span class="mf">0.0001988</span><span class="p">),</span>
                                       <span class="p">(</span><span class="mf">3.83e-05</span><span class="p">,</span> <span class="mf">0.0001124</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="n">e</span><span class="o">-</span><span class="mi">07</span><span class="p">)],</span>
                         <span class="s1">&#39;rms_gradient&#39;</span><span class="p">:</span> <span class="mf">0.0001535</span><span class="p">}]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">qcout</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;gradients&quot;</span><span class="p">],</span> <span class="n">ans_gradient</span><span class="p">)</span>
        <span class="n">ans_inp</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;$molecule</span>
<span class="s1"> -1  2</span>
<span class="s1"> C           0.15884000       -0.16538000        0.00006000</span>
<span class="s1"> C          -0.52053000       -1.36672000        0.00035000</span>
<span class="s1"> C          -1.93081000       -1.19846000       -0.00004000</span>
<span class="s1"> C          -2.29797000        0.12743000       -0.00069000</span>
<span class="s1"> S          -0.93831000        1.18963000        0.00040000</span>
<span class="s1"> H          -0.01472000       -2.32534000        0.00055000</span>
<span class="s1"> H          -2.64172000       -2.01772000       -0.00016000</span>
<span class="s1"> H          -3.30103000        0.53566000       -0.00126000</span>
<span class="s1"> C           1.60308000        0.07623000       -0.00010000</span>
<span class="s1"> O           2.13199000        1.17358000       -0.00033000</span>
<span class="s1"> O           2.32211000       -1.07922000       -0.00002000</span>
<span class="s1"> H           3.26206000       -0.82019000       -0.00017000</span>
<span class="s1">$end</span>


<span class="s1">$rem</span>
<span class="s1">   jobtype = opt</span>
<span class="s1">  exchange = b3lyp</span>
<span class="s1">     basis = 6-31+g*</span>
<span class="s1">$end</span>

<span class="s1">&#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">qcout</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;input&#39;</span><span class="p">]),</span> <span class="n">ans_inp</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">qcout</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;gracefully_terminated&#39;</span><span class="p">])</span>
        <span class="n">ans_scf_iter</span> <span class="o">=</span> <span class="p">[[(</span><span class="o">-</span><span class="mf">743.3130310589</span><span class="p">,</span> <span class="mf">0.0561</span><span class="p">),</span>
                         <span class="p">(</span><span class="o">-</span><span class="mf">741.3557302205</span><span class="p">,</span> <span class="mf">0.00841</span><span class="p">),</span>
                         <span class="p">(</span><span class="o">-</span><span class="mf">740.7031048846</span><span class="p">,</span> <span class="mf">0.0157</span><span class="p">),</span>
                         <span class="p">(</span><span class="o">-</span><span class="mf">741.5589873953</span><span class="p">,</span> <span class="mf">0.00303</span><span class="p">),</span>
                         <span class="p">(</span><span class="o">-</span><span class="mf">741.5918010434</span><span class="p">,</span> <span class="mf">0.00118</span><span class="p">),</span>
                         <span class="p">(</span><span class="o">-</span><span class="mf">741.5966923809</span><span class="p">,</span> <span class="mf">0.000332</span><span class="p">),</span>
                         <span class="p">(</span><span class="o">-</span><span class="mf">741.5970287119</span><span class="p">,</span> <span class="mf">0.000158</span><span class="p">),</span>
                         <span class="p">(</span><span class="o">-</span><span class="mf">741.5971282029</span><span class="p">,</span> <span class="mf">4.38e-05</span><span class="p">),</span>
                         <span class="p">(</span><span class="o">-</span><span class="mf">741.5971448077</span><span class="p">,</span> <span class="mf">2.17e-05</span><span class="p">),</span>
                         <span class="p">(</span><span class="o">-</span><span class="mf">741.5971501973</span><span class="p">,</span> <span class="mf">7.7e-06</span><span class="p">),</span>
                         <span class="p">(</span><span class="o">-</span><span class="mf">741.5971533576</span><span class="p">,</span> <span class="mf">5.05e-06</span><span class="p">),</span>
                         <span class="p">(</span><span class="o">-</span><span class="mf">741.5971541122</span><span class="p">,</span> <span class="mf">2.7e-06</span><span class="p">),</span>
                         <span class="p">(</span><span class="o">-</span><span class="mf">741.5971544119</span><span class="p">,</span> <span class="mf">9.48e-07</span><span class="p">),</span>
                         <span class="p">(</span><span class="o">-</span><span class="mf">741.5971544408</span><span class="p">,</span> <span class="mf">2.61e-07</span><span class="p">),</span>
                         <span class="p">(</span><span class="o">-</span><span class="mf">741.5971544436</span><span class="p">,</span> <span class="mf">1.21e-07</span><span class="p">),</span>
                         <span class="p">(</span><span class="o">-</span><span class="mf">741.5971544441</span><span class="p">,</span> <span class="mf">5.45e-08</span><span class="p">),</span>
                         <span class="p">(</span><span class="o">-</span><span class="mf">741.5971544442</span><span class="p">,</span> <span class="mf">1.77e-08</span><span class="p">),</span>
                         <span class="p">(</span><span class="o">-</span><span class="mf">741.5971544442</span><span class="p">,</span> <span class="mf">7.79e-09</span><span class="p">)],</span>
                        <span class="p">[(</span><span class="o">-</span><span class="mf">741.5552794274</span><span class="p">,</span> <span class="mf">0.00265</span><span class="p">),</span>
                         <span class="p">(</span><span class="o">-</span><span class="mf">741.6048574279</span><span class="p">,</span> <span class="mf">0.000515</span><span class="p">),</span>
                         <span class="p">(</span><span class="o">-</span><span class="mf">741.6037290502</span><span class="p">,</span> <span class="mf">0.000807</span><span class="p">),</span>
                         <span class="p">(</span><span class="o">-</span><span class="mf">741.6056978336</span><span class="p">,</span> <span class="mf">0.000188</span><span class="p">),</span>
                         <span class="p">(</span><span class="o">-</span><span class="mf">741.6057976553</span><span class="p">,</span> <span class="mf">4.78e-05</span><span class="p">),</span>
                         <span class="p">(</span><span class="o">-</span><span class="mf">741.6058045572</span><span class="p">,</span> <span class="mf">1.54e-05</span><span class="p">),</span>
                         <span class="p">(</span><span class="o">-</span><span class="mf">741.6058057373</span><span class="p">,</span> <span class="mf">4.51e-06</span><span class="p">),</span>
                         <span class="p">(</span><span class="o">-</span><span class="mf">741.6058061671</span><span class="p">,</span> <span class="mf">2.91e-06</span><span class="p">),</span>
                         <span class="p">(</span><span class="o">-</span><span class="mf">741.6058062822</span><span class="p">,</span> <span class="mf">8.32e-07</span><span class="p">),</span>
                         <span class="p">(</span><span class="o">-</span><span class="mf">741.6058063435</span><span class="p">,</span> <span class="mf">7.17e-07</span><span class="p">),</span>
                         <span class="p">(</span><span class="o">-</span><span class="mf">741.6058063636</span><span class="p">,</span> <span class="mf">1.97e-07</span><span class="p">),</span>
                         <span class="p">(</span><span class="o">-</span><span class="mf">741.6058063662</span><span class="p">,</span> <span class="mf">5.03e-08</span><span class="p">),</span>
                         <span class="p">(</span><span class="o">-</span><span class="mf">741.6058063666</span><span class="p">,</span> <span class="mf">3.35e-08</span><span class="p">),</span>
                         <span class="p">(</span><span class="o">-</span><span class="mf">741.6058063666</span><span class="p">,</span> <span class="mf">1.24e-08</span><span class="p">),</span>
                         <span class="p">(</span><span class="o">-</span><span class="mf">741.6058063666</span><span class="p">,</span> <span class="mf">5.25e-09</span><span class="p">)],</span>
                        <span class="p">[(</span><span class="o">-</span><span class="mf">741.6023833754</span><span class="p">,</span> <span class="mf">0.0013</span><span class="p">),</span>
                         <span class="p">(</span><span class="o">-</span><span class="mf">741.6065067966</span><span class="p">,</span> <span class="mf">0.000305</span><span class="p">),</span>
                         <span class="p">(</span><span class="o">-</span><span class="mf">741.6057886337</span><span class="p">,</span> <span class="mf">0.000559</span><span class="p">),</span>
                         <span class="p">(</span><span class="o">-</span><span class="mf">741.6068434004</span><span class="p">,</span> <span class="mf">7.61e-05</span><span class="p">),</span>
                         <span class="p">(</span><span class="o">-</span><span class="mf">741.6068555361</span><span class="p">,</span> <span class="mf">3.4e-05</span><span class="p">),</span>
                         <span class="p">(</span><span class="o">-</span><span class="mf">741.6068589376</span><span class="p">,</span> <span class="mf">5.66e-06</span><span class="p">),</span>
                         <span class="p">(</span><span class="o">-</span><span class="mf">741.6068591778</span><span class="p">,</span> <span class="mf">2.95e-06</span><span class="p">),</span>
                         <span class="p">(</span><span class="o">-</span><span class="mf">741.60685927</span><span class="p">,</span> <span class="mf">1.27e-06</span><span class="p">),</span>
                         <span class="p">(</span><span class="o">-</span><span class="mf">741.6068592962</span><span class="p">,</span> <span class="mf">4.82e-07</span><span class="p">),</span>
                         <span class="p">(</span><span class="o">-</span><span class="mf">741.6068593106</span><span class="p">,</span> <span class="mf">3.84e-07</span><span class="p">),</span>
                         <span class="p">(</span><span class="o">-</span><span class="mf">741.6068593157</span><span class="p">,</span> <span class="mf">9.23e-08</span><span class="p">),</span>
                         <span class="p">(</span><span class="o">-</span><span class="mf">741.6068593162</span><span class="p">,</span> <span class="mf">2.49e-08</span><span class="p">),</span>
                         <span class="p">(</span><span class="o">-</span><span class="mf">741.6068593163</span><span class="p">,</span> <span class="mf">1.52e-08</span><span class="p">),</span>
                         <span class="p">(</span><span class="o">-</span><span class="mf">741.6068593163</span><span class="p">,</span> <span class="mf">5.71e-09</span><span class="p">)],</span>
                        <span class="p">[(</span><span class="o">-</span><span class="mf">741.6012175391</span><span class="p">,</span> <span class="mf">0.000209</span><span class="p">),</span>
                         <span class="p">(</span><span class="o">-</span><span class="mf">741.6068794773</span><span class="p">,</span> <span class="mf">7.2e-05</span><span class="p">),</span>
                         <span class="p">(</span><span class="o">-</span><span class="mf">741.606851035</span><span class="p">,</span> <span class="mf">0.000117</span><span class="p">),</span>
                         <span class="p">(</span><span class="o">-</span><span class="mf">741.606899078</span><span class="p">,</span> <span class="mf">1.53e-05</span><span class="p">),</span>
                         <span class="p">(</span><span class="o">-</span><span class="mf">741.6068997567</span><span class="p">,</span> <span class="mf">6.01e-06</span><span class="p">),</span>
                         <span class="p">(</span><span class="o">-</span><span class="mf">741.6068998747</span><span class="p">,</span> <span class="mf">1.68e-06</span><span class="p">),</span>
                         <span class="p">(</span><span class="o">-</span><span class="mf">741.6068998849</span><span class="p">,</span> <span class="mf">5.32e-07</span><span class="p">),</span>
                         <span class="p">(</span><span class="o">-</span><span class="mf">741.6068998857</span><span class="p">,</span> <span class="mf">2.76e-07</span><span class="p">),</span>
                         <span class="p">(</span><span class="o">-</span><span class="mf">741.606899886</span><span class="p">,</span> <span class="mf">6.41e-08</span><span class="p">),</span>
                         <span class="p">(</span><span class="o">-</span><span class="mf">741.606899886</span><span class="p">,</span> <span class="mf">3.08e-08</span><span class="p">),</span>
                         <span class="p">(</span><span class="o">-</span><span class="mf">741.606899886</span><span class="p">,</span> <span class="mf">9.5e-09</span><span class="p">)],</span>
                        <span class="p">[(</span><span class="o">-</span><span class="mf">741.6067290885</span><span class="p">,</span> <span class="mf">0.0001</span><span class="p">),</span>
                         <span class="p">(</span><span class="o">-</span><span class="mf">741.6069044268</span><span class="p">,</span> <span class="mf">2.64e-05</span><span class="p">),</span>
                         <span class="p">(</span><span class="o">-</span><span class="mf">741.6068991026</span><span class="p">,</span> <span class="mf">5.29e-05</span><span class="p">),</span>
                         <span class="p">(</span><span class="o">-</span><span class="mf">741.6069065234</span><span class="p">,</span> <span class="mf">3.51e-06</span><span class="p">),</span>
                         <span class="p">(</span><span class="o">-</span><span class="mf">741.6069065452</span><span class="p">,</span> <span class="mf">2.49e-06</span><span class="p">),</span>
                         <span class="p">(</span><span class="o">-</span><span class="mf">741.6069065686</span><span class="p">,</span> <span class="mf">3.57e-07</span><span class="p">),</span>
                         <span class="p">(</span><span class="o">-</span><span class="mf">741.6069065693</span><span class="p">,</span> <span class="mf">2.59e-07</span><span class="p">),</span>
                         <span class="p">(</span><span class="o">-</span><span class="mf">741.6069065696</span><span class="p">,</span> <span class="mf">7.05e-08</span><span class="p">),</span>
                         <span class="p">(</span><span class="o">-</span><span class="mf">741.6069065696</span><span class="p">,</span> <span class="mf">4.44e-08</span><span class="p">),</span>
                         <span class="p">(</span><span class="o">-</span><span class="mf">741.6069065697</span><span class="p">,</span> <span class="mf">1.52e-08</span><span class="p">),</span>
                         <span class="p">(</span><span class="o">-</span><span class="mf">741.6069065697</span><span class="p">,</span> <span class="mf">8.17e-09</span><span class="p">)],</span>
                        <span class="p">[(</span><span class="o">-</span><span class="mf">741.6074251344</span><span class="p">,</span> <span class="mf">0.000129</span><span class="p">),</span>
                         <span class="p">(</span><span class="o">-</span><span class="mf">741.6069044127</span><span class="p">,</span> <span class="mf">2.43e-05</span><span class="p">),</span>
                         <span class="p">(</span><span class="o">-</span><span class="mf">741.6068998551</span><span class="p">,</span> <span class="mf">4.95e-05</span><span class="p">),</span>
                         <span class="p">(</span><span class="o">-</span><span class="mf">741.6069064294</span><span class="p">,</span> <span class="mf">4.49e-06</span><span class="p">),</span>
                         <span class="p">(</span><span class="o">-</span><span class="mf">741.606906478</span><span class="p">,</span> <span class="mf">2.77e-06</span><span class="p">),</span>
                         <span class="p">(</span><span class="o">-</span><span class="mf">741.6069065049</span><span class="p">,</span> <span class="mf">5.85e-07</span><span class="p">),</span>
                         <span class="p">(</span><span class="o">-</span><span class="mf">741.6069065068</span><span class="p">,</span> <span class="mf">2.74e-07</span><span class="p">),</span>
                         <span class="p">(</span><span class="o">-</span><span class="mf">741.6069065073</span><span class="p">,</span> <span class="mf">6.99e-08</span><span class="p">),</span>
                         <span class="p">(</span><span class="o">-</span><span class="mf">741.6069065074</span><span class="p">,</span> <span class="mf">3.37e-08</span><span class="p">),</span>
                         <span class="p">(</span><span class="o">-</span><span class="mf">741.6069065075</span><span class="p">,</span> <span class="mf">1.89e-08</span><span class="p">),</span>
                         <span class="p">(</span><span class="o">-</span><span class="mf">741.6069065075</span><span class="p">,</span> <span class="mf">7.38e-09</span><span class="p">)]]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">qcout</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;scf_iteration_energies&#39;</span><span class="p">],</span> <span class="n">ans_scf_iter</span><span class="p">)</span></div>

<div class="viewcode-block" id="TestQcOutput.test_multiple_step_job"><a class="viewcode-back" href="../../../../pymatgen.io.tests.test_qchem.html#pymatgen.io.tests.test_qchem.TestQcOutput.test_multiple_step_job">[docs]</a>    <span class="k">def</span> <span class="nf">test_multiple_step_job</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">test_dir</span><span class="p">,</span> <span class="s2">&quot;CdBr2.qcout&quot;</span><span class="p">)</span>
        <span class="n">qcout</span> <span class="o">=</span> <span class="n">QcOutput</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">qcout</span><span class="o">.</span><span class="n">data</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">qcout</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;jobtype&#39;</span><span class="p">],</span> <span class="s1">&#39;opt&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">qcout</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;jobtype&#39;</span><span class="p">],</span> <span class="s1">&#39;freq&#39;</span><span class="p">)</span>
        <span class="n">ans_thermo_corr_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">{</span>
<span class="s1">    &quot;Rotational Enthalpy&quot;: 0.025714259,</span>
<span class="s1">    &quot;Rotational Entropy&quot;: 0.000833523586,</span>
<span class="s1">    &quot;Total Enthalpy&quot;: 0.199729978,</span>
<span class="s1">    &quot;Total Entropy&quot;: 0.003218965579,</span>
<span class="s1">    &quot;Translational Enthalpy&quot;: 0.038549707,</span>
<span class="s1">    &quot;Translational Entropy&quot;: 0.001851513374,</span>
<span class="s1">    &quot;Vibrational Enthalpy&quot;: 0.109795116,</span>
<span class="s1">    &quot;Vibrational Entropy&quot;: 0.000533928619,</span>
<span class="s1">    &quot;ZPE&quot;: 0.039330241,</span>
<span class="s1">    &quot;Zero point vibrational energy&quot;: 0.039330241,</span>
<span class="s1">    &quot;gas constant (RT)&quot;: 0.025714259</span>
<span class="s1">}&#39;&#39;&#39;</span>
        <span class="n">ans_thermo_corr</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">ans_thermo_corr_text</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">qcout</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;corrections&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span>
                         <span class="nb">sorted</span><span class="p">(</span><span class="n">ans_thermo_corr</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">ref</span> <span class="ow">in</span> <span class="n">ans_thermo_corr</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertAlmostEqual</span><span class="p">(</span><span class="n">qcout</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;corrections&#39;</span><span class="p">][</span><span class="n">k</span><span class="p">],</span> <span class="n">ref</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">qcout</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;molecules&#39;</span><span class="p">]),</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">ans_mol1</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;Full Formula (Cd1 Br2)</span>
<span class="s1">Reduced Formula: CdBr2</span>
<span class="s1">Charge = 0, Spin Mult = 1</span>
<span class="s1">Sites (3)</span>
<span class="s1">0 Br     0.000000     0.000000    -2.453720</span>
<span class="s1">1 Cd     0.000000     0.000000     0.000000</span>
<span class="s1">2 Br     0.000000     0.000000     2.453720&#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">qcout</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;molecules&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]),</span> <span class="n">ans_mol1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">qcout</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;has_error&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">qcout</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;gradients&#39;</span><span class="p">],</span> <span class="p">[])</span>
        <span class="n">ans_inp</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;$molecule</span>
<span class="s1"> read</span>
<span class="s1">$end</span>


<span class="s1">$rem</span>
<span class="s1">         jobtype = freq</span>
<span class="s1">        exchange = b3lyp</span>
<span class="s1">           basis = gen</span>
<span class="s1">             ecp = gen</span>
<span class="s1">  max_scf_cycles = 100</span>
<span class="s1">       scf_guess = gwh</span>
<span class="s1">$end</span>


<span class="s1">$basis</span>
<span class="s1"> Br</span>
<span class="s1"> srlc</span>
<span class="s1"> ****</span>
<span class="s1"> Cd</span>
<span class="s1"> srsc</span>
<span class="s1"> ****</span>
<span class="s1">$end</span>


<span class="s1">$ecp</span>
<span class="s1"> Br</span>
<span class="s1"> srlc</span>
<span class="s1"> ****</span>
<span class="s1"> Cd</span>
<span class="s1"> srsc</span>
<span class="s1"> ****</span>
<span class="s1">$end</span>

<span class="s1">&#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">qcout</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;input&#39;</span><span class="p">]),</span> <span class="n">ans_inp</span><span class="p">)</span>
        <span class="n">ans_freq</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;vib_mode&#39;</span><span class="p">:</span> <span class="p">((</span><span class="mf">0.17</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.475</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
                                  <span class="p">(</span><span class="o">-</span><span class="mf">0.236</span><span class="p">,</span> <span class="mf">0.659</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
                                  <span class="p">(</span><span class="mf">0.17</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.475</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)),</span>
                     <span class="s1">&#39;frequency&#39;</span><span class="p">:</span> <span class="mf">61.36</span><span class="p">},</span>
                    <span class="p">{</span><span class="s1">&#39;vib_mode&#39;</span><span class="p">:</span> <span class="p">((</span><span class="o">-</span><span class="mf">0.475</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.17</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
                                  <span class="p">(</span><span class="mf">0.659</span><span class="p">,</span> <span class="mf">0.236</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
                                  <span class="p">(</span><span class="o">-</span><span class="mf">0.475</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.17</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)),</span>
                     <span class="s1">&#39;frequency&#39;</span><span class="p">:</span> <span class="mf">61.36</span><span class="p">},</span>
                    <span class="p">{</span><span class="s1">&#39;vib_mode&#39;</span><span class="p">:</span> <span class="p">((</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.707</span><span class="p">),</span>
                                  <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
                                  <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.707</span><span class="p">)),</span>
                     <span class="s1">&#39;frequency&#39;</span><span class="p">:</span> <span class="mf">199.94</span><span class="p">},</span>
                    <span class="p">{</span><span class="s1">&#39;vib_mode&#39;</span><span class="p">:</span> <span class="p">((</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.505</span><span class="p">),</span>
                                  <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">),</span>
                                  <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.505</span><span class="p">)),</span>
                     <span class="s1">&#39;frequency&#39;</span><span class="p">:</span> <span class="mf">311.74</span><span class="p">}]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">qcout</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;frequencies&#39;</span><span class="p">],</span> <span class="n">ans_freq</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertAlmostEqual</span><span class="p">(</span><span class="n">qcout</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="s1">&#39;energies&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>
                               <span class="o">-</span><span class="mf">5296.720741780598</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="n">ans_scf_iter_ene</span> <span class="o">=</span> <span class="p">[[(</span><span class="o">-</span><span class="mf">176.9147092199</span><span class="p">,</span> <span class="mf">0.779</span><span class="p">),</span>
                             <span class="p">(</span><span class="o">-</span><span class="mf">156.8236033975</span><span class="p">,</span> <span class="mf">0.115</span><span class="p">),</span>
                             <span class="p">(</span><span class="o">-</span><span class="mf">152.9396694452</span><span class="p">,</span> <span class="mf">0.157</span><span class="p">),</span>
                             <span class="p">(</span><span class="o">-</span><span class="mf">183.2743425778</span><span class="p">,</span> <span class="mf">0.138</span><span class="p">),</span>
                             <span class="p">(</span><span class="o">-</span><span class="mf">182.2994943574</span><span class="p">,</span> <span class="mf">0.142</span><span class="p">),</span>
                             <span class="p">(</span><span class="o">-</span><span class="mf">181.990425533</span><span class="p">,</span> <span class="mf">0.143</span><span class="p">),</span>
                             <span class="p">(</span><span class="o">-</span><span class="mf">182.1690180647</span><span class="p">,</span> <span class="mf">0.142</span><span class="p">),</span>
                             <span class="p">(</span><span class="o">-</span><span class="mf">106.6454708618</span><span class="p">,</span> <span class="mf">0.239</span><span class="p">),</span>
                             <span class="p">(</span><span class="o">-</span><span class="mf">193.8056267625</span><span class="p">,</span> <span class="mf">0.0432</span><span class="p">),</span>
                             <span class="p">(</span><span class="o">-</span><span class="mf">193.0854096948</span><span class="p">,</span> <span class="mf">0.0455</span><span class="p">),</span>
                             <span class="p">(</span><span class="o">-</span><span class="mf">194.6340538334</span><span class="p">,</span> <span class="mf">0.0062</span><span class="p">),</span>
                             <span class="p">(</span><span class="o">-</span><span class="mf">194.6495072245</span><span class="p">,</span> <span class="mf">0.00205</span><span class="p">),</span>
                             <span class="p">(</span><span class="o">-</span><span class="mf">194.6508787796</span><span class="p">,</span> <span class="mf">0.000189</span><span class="p">),</span>
                             <span class="p">(</span><span class="o">-</span><span class="mf">194.6508984743</span><span class="p">,</span> <span class="mf">2.18e-05</span><span class="p">),</span>
                             <span class="p">(</span><span class="o">-</span><span class="mf">194.6508986262</span><span class="p">,</span> <span class="mf">2.17e-06</span><span class="p">)]]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">qcout</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="s1">&#39;scf_iteration_energies&#39;</span><span class="p">],</span>
                         <span class="n">ans_scf_iter_ene</span><span class="p">)</span></div>

<div class="viewcode-block" id="TestQcOutput.test_solvent_method"><a class="viewcode-back" href="../../../../pymatgen.io.tests.test_qchem.html#pymatgen.io.tests.test_qchem.TestQcOutput.test_solvent_method">[docs]</a>    <span class="k">def</span> <span class="nf">test_solvent_method</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">test_dir</span><span class="p">,</span> <span class="s2">&quot;thiophene_wfs_5_carboxyl.qcout&quot;</span><span class="p">)</span>
        <span class="n">qcout</span> <span class="o">=</span> <span class="n">QcOutput</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">qcout</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;solvent_method&quot;</span><span class="p">],</span> <span class="s2">&quot;NA&quot;</span><span class="p">)</span>

        <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">test_dir</span><span class="p">,</span> <span class="s2">&quot;qchem_energies&quot;</span><span class="p">,</span> <span class="s2">&quot;hf_cosmo.qcout&quot;</span><span class="p">)</span>
        <span class="n">qcout</span> <span class="o">=</span> <span class="n">QcOutput</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">qcout</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;solvent_method&quot;</span><span class="p">],</span> <span class="s2">&quot;cosmo&quot;</span><span class="p">)</span>

        <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">test_dir</span><span class="p">,</span> <span class="s2">&quot;qchem_energies&quot;</span><span class="p">,</span> <span class="s2">&quot;hf_pcm.qcout&quot;</span><span class="p">)</span>
        <span class="n">qcout</span> <span class="o">=</span> <span class="n">QcOutput</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">qcout</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;solvent_method&quot;</span><span class="p">],</span> <span class="s2">&quot;pcm&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="TestQcOutput.test_failed_message"><a class="viewcode-back" href="../../../../pymatgen.io.tests.test_qchem.html#pymatgen.io.tests.test_qchem.TestQcOutput.test_failed_message">[docs]</a>    <span class="k">def</span> <span class="nf">test_failed_message</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">scf_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">test_dir</span><span class="p">,</span> <span class="s2">&quot;hf.qcout&quot;</span><span class="p">)</span>
        <span class="n">scf_qcout</span> <span class="o">=</span> <span class="n">QcOutput</span><span class="p">(</span><span class="n">scf_file</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">scf_qcout</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;has_error&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">scf_qcout</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;errors&#39;</span><span class="p">],</span>
                         <span class="p">[</span><span class="s1">&#39;Bad SCF convergence&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;Molecular charge is not found&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;Geometry optimization failed&#39;</span><span class="p">])</span>
        <span class="n">geom_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">test_dir</span><span class="p">,</span> <span class="s2">&quot;hf_opt_failed.qcout&quot;</span><span class="p">)</span>
        <span class="n">geom_qcout</span> <span class="o">=</span> <span class="n">QcOutput</span><span class="p">(</span><span class="n">geom_file</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">geom_qcout</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;has_error&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">geom_qcout</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;errors&#39;</span><span class="p">],</span>
                         <span class="p">[</span><span class="s1">&#39;Geometry optimization failed&#39;</span><span class="p">])</span></div>

<div class="viewcode-block" id="TestQcOutput.test_abnormal_exit"><a class="viewcode-back" href="../../../../pymatgen.io.tests.test_qchem.html#pymatgen.io.tests.test_qchem.TestQcOutput.test_abnormal_exit">[docs]</a>    <span class="k">def</span> <span class="nf">test_abnormal_exit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">no_reading_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">test_dir</span><span class="p">,</span> <span class="s2">&quot;no_reading.qcout&quot;</span><span class="p">)</span>
        <span class="n">no_reading_qcout</span> <span class="o">=</span> <span class="n">QcOutput</span><span class="p">(</span><span class="n">no_reading_file</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">no_reading_qcout</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;has_error&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">no_reading_qcout</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;errors&#39;</span><span class="p">],</span>
                         <span class="p">[</span><span class="s1">&#39;Exit Code 134&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;Molecular charge is not found&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;No input text&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;Bad SCF convergence&#39;</span><span class="p">])</span>
        <span class="n">exit_code_134_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">test_dir</span><span class="p">,</span> <span class="s2">&quot;exit_code_134.qcout&quot;</span><span class="p">)</span>
        <span class="n">ec134_qcout</span> <span class="o">=</span> <span class="n">QcOutput</span><span class="p">(</span><span class="n">exit_code_134_file</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">ec134_qcout</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;has_error&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ec134_qcout</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;errors&#39;</span><span class="p">],</span>
                         <span class="p">[</span><span class="s1">&#39;Exit Code 134&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;Molecular charge is not found&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;Bad SCF convergence&#39;</span><span class="p">])</span></div>

<div class="viewcode-block" id="TestQcOutput.test_chelp_and_mulliken_charges"><a class="viewcode-back" href="../../../../pymatgen.io.tests.test_qchem.html#pymatgen.io.tests.test_qchem.TestQcOutput.test_chelp_and_mulliken_charges">[docs]</a>    <span class="k">def</span> <span class="nf">test_chelp_and_mulliken_charges</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">test_dir</span><span class="p">,</span> <span class="s1">&#39;chelpg_charges.qcout&#39;</span><span class="p">)</span>
        <span class="n">qcout</span> <span class="o">=</span> <span class="n">QcOutput</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="n">mulliken_charges</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.393961</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.281545</span><span class="p">,</span> <span class="mf">0.066432</span><span class="p">,</span> <span class="mf">0.019364</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.186041</span><span class="p">,</span>
                            <span class="o">-</span><span class="mf">0.16007</span><span class="p">,</span> <span class="mf">0.315659</span><span class="p">,</span> <span class="mf">0.30631</span><span class="p">,</span> <span class="mf">0.064257</span><span class="p">,</span> <span class="mf">0.056438</span><span class="p">,</span>
                            <span class="o">-</span><span class="mf">0.17695</span><span class="p">,</span> <span class="mf">0.16976</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.13326</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.131853</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.178711</span><span class="p">,</span>
                            <span class="mf">0.163697</span><span class="p">,</span> <span class="mf">0.170148</span><span class="p">,</span> <span class="mf">0.143329</span><span class="p">,</span> <span class="mf">0.152702</span><span class="p">,</span> <span class="mf">0.152929</span><span class="p">,</span>
                            <span class="mf">0.170475</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.451542</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.441554</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.709834</span><span class="p">,</span>
                            <span class="o">-</span><span class="mf">0.592718</span><span class="p">,</span> <span class="mf">0.20506</span><span class="p">,</span> <span class="mf">0.211043</span><span class="p">,</span> <span class="mf">0.204389</span><span class="p">,</span> <span class="mf">0.546173</span><span class="p">,</span>
                            <span class="o">-</span><span class="mf">0.414558</span><span class="p">,</span> <span class="mf">0.346511</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">qcout</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;charges&#39;</span><span class="p">][</span><span class="s1">&#39;mulliken&#39;</span><span class="p">],</span>
                         <span class="n">mulliken_charges</span><span class="p">)</span>
        <span class="n">chelpg_charges</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.399404</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.277179</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.057502</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.110085</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.07107</span><span class="p">,</span>
                          <span class="o">-</span><span class="mf">0.274987</span><span class="p">,</span> <span class="mf">0.475781</span><span class="p">,</span> <span class="mf">0.423117</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.054079</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.101424</span><span class="p">,</span>
                          <span class="o">-</span><span class="mf">0.05793</span><span class="p">,</span> <span class="mf">0.115179</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.116069</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.10949</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.06664</span><span class="p">,</span>
                          <span class="mf">0.161442</span><span class="p">,</span> <span class="mf">0.135438</span><span class="p">,</span> <span class="mf">0.158081</span><span class="p">,</span> <span class="mf">0.125881</span><span class="p">,</span> <span class="mf">0.125324</span><span class="p">,</span>
                          <span class="mf">0.115863</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.425251</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.42309</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.602375</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.458844</span><span class="p">,</span>
                          <span class="mf">0.140267</span><span class="p">,</span> <span class="mf">0.139084</span><span class="p">,</span> <span class="mf">0.139995</span><span class="p">,</span> <span class="mf">0.698011</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.487911</span><span class="p">,</span>
                          <span class="mf">0.341061</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">qcout</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;charges&#39;</span><span class="p">][</span><span class="s1">&#39;chelpg&#39;</span><span class="p">],</span> <span class="n">chelpg_charges</span><span class="p">)</span></div>

<div class="viewcode-block" id="TestQcOutput.test_no_message_scf_opt_fail"><a class="viewcode-back" href="../../../../pymatgen.io.tests.test_qchem.html#pymatgen.io.tests.test_qchem.TestQcOutput.test_no_message_scf_opt_fail">[docs]</a>    <span class="k">def</span> <span class="nf">test_no_message_scf_opt_fail</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">so_failfile</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">test_dir</span><span class="p">,</span> <span class="s1">&#39;scf_opt_no_message_fail.qcout&#39;</span><span class="p">)</span>
        <span class="n">so_failqcout</span> <span class="o">=</span> <span class="n">QcOutput</span><span class="p">(</span><span class="n">so_failfile</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">so_failqcout</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;has_error&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">so_failqcout</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;errors&#39;</span><span class="p">],</span>
                         <span class="p">[</span><span class="s1">&#39;Exit Code 134&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;Molecular charge is not found&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;Bad SCF convergence&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;Geometry optimization failed&#39;</span><span class="p">])</span>
        <span class="n">o_failfile</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">test_dir</span><span class="p">,</span> <span class="s1">&#39;opt_fail_no_message.qcout&#39;</span><span class="p">)</span>
        <span class="n">o_failqcout</span> <span class="o">=</span> <span class="n">QcOutput</span><span class="p">(</span><span class="n">o_failfile</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">o_failqcout</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;errors&#39;</span><span class="p">],</span>
                         <span class="p">[</span><span class="s1">&#39;Geometry optimization failed&#39;</span><span class="p">])</span>
        <span class="n">s_failfile</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">test_dir</span><span class="p">,</span> <span class="s1">&#39;scf_no_message_fail.qcout&#39;</span><span class="p">)</span>
        <span class="n">s_failqcout</span> <span class="o">=</span> <span class="n">QcOutput</span><span class="p">(</span><span class="n">s_failfile</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">s_failqcout</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;errors&#39;</span><span class="p">],</span>
                         <span class="p">[</span><span class="s1">&#39;Exit Code 134&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;Molecular charge is not found&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;Bad SCF convergence&#39;</span><span class="p">])</span>
        <span class="n">so_successfile</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">test_dir</span><span class="p">,</span>
                                      <span class="s1">&#39;thiophene_wfs_5_carboxyl.qcout&#39;</span><span class="p">)</span>
        <span class="n">so_successqcout</span> <span class="o">=</span> <span class="n">QcOutput</span><span class="p">(</span><span class="n">so_successfile</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">so_successqcout</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;has_error&#39;</span><span class="p">])</span></div>

<div class="viewcode-block" id="TestQcOutput.test_negative_eigen"><a class="viewcode-back" href="../../../../pymatgen.io.tests.test_qchem.html#pymatgen.io.tests.test_qchem.TestQcOutput.test_negative_eigen">[docs]</a>    <span class="k">def</span> <span class="nf">test_negative_eigen</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">test_dir</span><span class="p">,</span> <span class="s2">&quot;negative_eigen.qcout&quot;</span><span class="p">)</span>
        <span class="n">qcout</span> <span class="o">=</span> <span class="n">QcOutput</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">qcout</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;has_error&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">qcout</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;errors&quot;</span><span class="p">],</span>
                         <span class="p">[</span><span class="s1">&#39;Negative Eigen&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;Molecular charge is not found&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;Bad SCF convergence&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;Geometry optimization failed&#39;</span><span class="p">])</span></div>

<div class="viewcode-block" id="TestQcOutput.test_insufficient_memory"><a class="viewcode-back" href="../../../../pymatgen.io.tests.test_qchem.html#pymatgen.io.tests.test_qchem.TestQcOutput.test_insufficient_memory">[docs]</a>    <span class="k">def</span> <span class="nf">test_insufficient_memory</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">test_dir</span><span class="p">,</span> <span class="s2">&quot;insufficient_memory.qcout&quot;</span><span class="p">)</span>
        <span class="n">qcout</span> <span class="o">=</span> <span class="n">QcOutput</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">qcout</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;has_error&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">qcout</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;errors&#39;</span><span class="p">],</span>
                         <span class="p">[</span><span class="s1">&#39;Insufficient static memory&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;Molecular charge is not found&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;Bad SCF convergence&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;Geometry optimization failed&#39;</span><span class="p">])</span></div>

<div class="viewcode-block" id="TestQcOutput.test_freq_seg_too_small"><a class="viewcode-back" href="../../../../pymatgen.io.tests.test_qchem.html#pymatgen.io.tests.test_qchem.TestQcOutput.test_freq_seg_too_small">[docs]</a>    <span class="k">def</span> <span class="nf">test_freq_seg_too_small</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">test_dir</span><span class="p">,</span> <span class="s2">&quot;freq_seg_too_small.qcout&quot;</span><span class="p">)</span>
        <span class="n">qcout</span> <span class="o">=</span> <span class="n">QcOutput</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">qcout</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;has_error&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">qcout</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;errors&#39;</span><span class="p">],</span>
                         <span class="p">[</span><span class="s1">&#39;Freq Job Too Small&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;Exit Code 134&#39;</span><span class="p">])</span></div>

<div class="viewcode-block" id="TestQcOutput.test_not_enough_total_memory"><a class="viewcode-back" href="../../../../pymatgen.io.tests.test_qchem.html#pymatgen.io.tests.test_qchem.TestQcOutput.test_not_enough_total_memory">[docs]</a>    <span class="k">def</span> <span class="nf">test_not_enough_total_memory</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">test_dir</span><span class="p">,</span> <span class="s2">&quot;not_enough_total_memory.qcout&quot;</span><span class="p">)</span>
        <span class="n">qcout</span> <span class="o">=</span> <span class="n">QcOutput</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">qcout</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;has_error&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">qcout</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;errors&quot;</span><span class="p">],</span>
                         <span class="p">[</span><span class="s1">&#39;Not Enough Total Memory&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;Exit Code 134&#39;</span><span class="p">])</span></div>

<div class="viewcode-block" id="TestQcOutput.test_killed"><a class="viewcode-back" href="../../../../pymatgen.io.tests.test_qchem.html#pymatgen.io.tests.test_qchem.TestQcOutput.test_killed">[docs]</a>    <span class="k">def</span> <span class="nf">test_killed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">test_dir</span><span class="p">,</span> <span class="s2">&quot;killed.qcout&quot;</span><span class="p">)</span>
        <span class="n">qcout</span> <span class="o">=</span> <span class="n">QcOutput</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">qcout</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;has_error&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">qcout</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;has_error&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">qcout</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;errors&quot;</span><span class="p">],</span>
                         <span class="p">[</span><span class="s1">&#39;Killed&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;Molecular charge is not found&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;Bad SCF convergence&#39;</span><span class="p">])</span></div>

<div class="viewcode-block" id="TestQcOutput.test_gdm_scf"><a class="viewcode-back" href="../../../../pymatgen.io.tests.test_qchem.html#pymatgen.io.tests.test_qchem.TestQcOutput.test_gdm_scf">[docs]</a>    <span class="k">def</span> <span class="nf">test_gdm_scf</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">test_dir</span><span class="p">,</span> <span class="s2">&quot;gmd_scf.qcout&quot;</span><span class="p">)</span>
        <span class="n">qcout</span> <span class="o">=</span> <span class="n">QcOutput</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">qcout</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;has_error&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">qcout</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;errors&#39;</span><span class="p">],</span>
                         <span class="p">[</span><span class="s1">&#39;Exit Code 134&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;Bad SCF convergence&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;Geometry optimization failed&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">qcout</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;scf_iteration_energies&#39;</span><span class="p">]),</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">qcout</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;scf_iteration_energies&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span> <span class="mi">192</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertAlmostEqual</span><span class="p">(</span><span class="n">qcout</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;scf_iteration_energies&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                               <span class="o">-</span><span class="mf">1944.945908459</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span></div>

<div class="viewcode-block" id="TestQcOutput.test_crazy_scf_values"><a class="viewcode-back" href="../../../../pymatgen.io.tests.test_qchem.html#pymatgen.io.tests.test_qchem.TestQcOutput.test_crazy_scf_values">[docs]</a>    <span class="k">def</span> <span class="nf">test_crazy_scf_values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">test_dir</span><span class="p">,</span> <span class="s2">&quot;crazy_scf_values.qcout&quot;</span><span class="p">)</span>
        <span class="n">qcout</span> <span class="o">=</span> <span class="n">QcOutput</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="p">[(</span><span class="o">-</span><span class="mf">28556254.06737586</span><span class="p">,</span> <span class="mf">6.49e-06</span><span class="p">),</span>
               <span class="p">(</span><span class="o">-</span><span class="mf">28556254.067382727</span><span class="p">,</span> <span class="mf">9.45e-06</span><span class="p">),</span>
               <span class="p">(</span><span class="o">-</span><span class="mf">28556254.067382865</span><span class="p">,</span> <span class="mf">6.14e-06</span><span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">qcout</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;scf_iteration_energies&quot;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">3</span><span class="p">:],</span> <span class="n">ans</span><span class="p">)</span></div>

<div class="viewcode-block" id="TestQcOutput.test_crowd_gradient_number"><a class="viewcode-back" href="../../../../pymatgen.io.tests.test_qchem.html#pymatgen.io.tests.test_qchem.TestQcOutput.test_crowd_gradient_number">[docs]</a>    <span class="k">def</span> <span class="nf">test_crowd_gradient_number</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">test_dir</span><span class="p">,</span> <span class="s2">&quot;crowd_gradient_number.qcout&quot;</span><span class="p">)</span>
        <span class="n">qcout</span> <span class="o">=</span> <span class="n">QcOutput</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">qcout</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;gradients&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;gradients&#39;</span><span class="p">],</span>
                         <span class="p">[(</span><span class="o">-</span><span class="mf">0.0307525</span><span class="p">,</span> <span class="mf">0.0206536</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0396255</span><span class="p">),</span>
                          <span class="p">(</span><span class="mf">0.0008938</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.000609</span><span class="p">,</span> <span class="mf">0.0082746</span><span class="p">),</span>
                          <span class="p">(</span><span class="mf">0.042143</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0240514</span><span class="p">,</span> <span class="mf">0.0380298</span><span class="p">),</span>
                          <span class="p">(</span><span class="o">-</span><span class="mf">0.0843578</span><span class="p">,</span> <span class="mf">0.0002757</span><span class="p">,</span> <span class="mf">0.0884924</span><span class="p">),</span>
                          <span class="p">(</span><span class="mf">0.0356689</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0444656</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0710646</span><span class="p">),</span>
                          <span class="p">(</span><span class="o">-</span><span class="mf">0.0190554</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0308886</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0297994</span><span class="p">),</span>
                          <span class="p">(</span><span class="mf">0.0470543</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0263915</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0690973</span><span class="p">),</span>
                          <span class="p">(</span><span class="o">-</span><span class="mf">0.0297801</span><span class="p">,</span> <span class="mf">0.0296872</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0104344</span><span class="p">),</span>
                          <span class="p">(</span><span class="mf">0.0504581</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0014272</span><span class="p">,</span> <span class="mf">0.0262245</span><span class="p">),</span>
                          <span class="p">(</span><span class="o">-</span><span class="mf">0.0927323</span><span class="p">,</span> <span class="mf">0.0750046</span><span class="p">,</span> <span class="mf">0.0128003</span><span class="p">),</span>
                          <span class="p">(</span><span class="mf">0.0183242</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0084638</span><span class="p">,</span> <span class="mf">0.0127388</span><span class="p">),</span>
                          <span class="p">(</span><span class="o">-</span><span class="mf">0.0083989</span><span class="p">,</span> <span class="mf">0.0111579</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0002461</span><span class="p">),</span>
                          <span class="p">(</span><span class="o">-</span><span class="mf">0.0316941</span><span class="p">,</span> <span class="mf">267.34455</span><span class="p">,</span> <span class="mf">878.3493251</span><span class="p">),</span>
                          <span class="p">(</span><span class="mf">0.017459</span><span class="p">,</span> <span class="mf">0.0487124</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0276365</span><span class="p">),</span>
                          <span class="p">(</span><span class="o">-</span><span class="mf">0.3699134</span><span class="p">,</span> <span class="mf">0.0110442</span><span class="p">,</span> <span class="mf">0.0260809</span><span class="p">),</span>
                          <span class="p">(</span><span class="mf">0.363931</span><span class="p">,</span> <span class="mf">0.24044</span><span class="p">,</span> <span class="mf">0.5192852</span><span class="p">),</span>
                          <span class="p">(</span><span class="mf">0.026669</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0284192</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0347528</span><span class="p">),</span>
                          <span class="p">(</span><span class="mf">0.0047475</span><span class="p">,</span> <span class="mf">0.0049706</span><span class="p">,</span> <span class="mf">0.0148794</span><span class="p">),</span>
                          <span class="p">(</span><span class="o">-</span><span class="mf">0.077804</span><span class="p">,</span> <span class="mf">0.003402</span><span class="p">,</span> <span class="mf">0.000852</span><span class="p">),</span>
                          <span class="p">(</span><span class="o">-</span><span class="mf">6772.1697035</span><span class="p">,</span> <span class="o">-</span><span class="mf">267.4471902</span><span class="p">,</span> <span class="o">-</span><span class="mf">878.585931</span><span class="p">),</span>
                          <span class="p">(</span><span class="o">-</span><span class="mf">0.0029556</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0616073</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0180577</span><span class="p">),</span>
                          <span class="p">(</span><span class="o">-</span><span class="mf">0.0001915</span><span class="p">,</span> <span class="mf">0.0021213</span><span class="p">,</span> <span class="mf">0.0006193</span><span class="p">),</span>
                          <span class="p">(</span><span class="mf">0.0320436</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0073456</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.01509</span><span class="p">),</span>
                          <span class="p">(</span><span class="mf">0.0155112</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0035725</span><span class="p">,</span> <span class="mf">0.0015675</span><span class="p">),</span>
                          <span class="p">(</span><span class="o">-</span><span class="mf">0.0034309</span><span class="p">,</span> <span class="mf">0.0170739</span><span class="p">,</span> <span class="mf">0.0074455</span><span class="p">),</span>
                          <span class="p">(</span><span class="o">-</span><span class="mf">0.0088735</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0129874</span><span class="p">,</span> <span class="mf">0.0092329</span><span class="p">),</span>
                          <span class="p">(</span><span class="o">-</span><span class="mf">0.0271963</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0258714</span><span class="p">,</span> <span class="mf">0.0246954</span><span class="p">),</span>
                          <span class="p">(</span><span class="mf">0.0025065</span><span class="p">,</span> <span class="mf">0.0062934</span><span class="p">,</span> <span class="mf">0.0209733</span><span class="p">),</span>
                          <span class="p">(</span><span class="mf">0.0152829</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0080239</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.018902</span><span class="p">),</span>
                          <span class="p">(</span><span class="mf">0.0461304</span><span class="p">,</span> <span class="mf">0.0071952</span><span class="p">,</span> <span class="mf">0.0012227</span><span class="p">),</span>
                          <span class="p">(</span><span class="o">-</span><span class="mf">0.0272755</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0280053</span><span class="p">,</span> <span class="mf">0.0325455</span><span class="p">),</span>
                          <span class="p">(</span><span class="mf">0.0122118</span><span class="p">,</span> <span class="mf">0.027816</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0167773</span><span class="p">),</span>
                          <span class="p">(</span><span class="mf">0.0168893</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0014211</span><span class="p">,</span> <span class="mf">0.0039917</span><span class="p">),</span>
                          <span class="p">(</span><span class="o">-</span><span class="mf">0.0048723</span><span class="p">,</span> <span class="mf">0.0026667</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0159952</span><span class="p">),</span>
                          <span class="p">(</span><span class="o">-</span><span class="mf">0.1840467</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1425887</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3235801</span><span class="p">),</span>
                          <span class="p">(</span><span class="mf">0.015975</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0922797</span><span class="p">,</span> <span class="mf">0.0640925</span><span class="p">),</span>
                          <span class="p">(</span><span class="mf">0.0267234</span><span class="p">,</span> <span class="mf">0.1031154</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0299014</span><span class="p">),</span>
                          <span class="p">(</span><span class="o">-</span><span class="mf">0.0175591</span><span class="p">,</span> <span class="mf">0.0081813</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0165425</span><span class="p">),</span>
                          <span class="p">(</span><span class="mf">0.0119225</span><span class="p">,</span> <span class="mf">0.0113174</span><span class="p">,</span> <span class="mf">0.0154056</span><span class="p">),</span>
                          <span class="p">(</span><span class="mf">0.0138491</span><span class="p">,</span> <span class="mf">0.0083436</span><span class="p">,</span> <span class="mf">0.0188022</span><span class="p">),</span>
                          <span class="p">(</span><span class="o">-</span><span class="mf">0.0151146</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0015971</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0054462</span><span class="p">)])</span></div>

<div class="viewcode-block" id="TestQcOutput.test_nbo_charges"><a class="viewcode-back" href="../../../../pymatgen.io.tests.test_qchem.html#pymatgen.io.tests.test_qchem.TestQcOutput.test_nbo_charges">[docs]</a>    <span class="k">def</span> <span class="nf">test_nbo_charges</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">test_dir</span><span class="p">,</span> <span class="s2">&quot;quinoxaline_anion.qcout&quot;</span><span class="p">)</span>
        <span class="n">qcout</span> <span class="o">=</span> <span class="n">QcOutput</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.29291</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.29807</span><span class="p">,</span> <span class="mf">0.12715</span><span class="p">,</span> <span class="mf">0.12715</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.29807</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.29291</span><span class="p">,</span>
               <span class="mf">0.21284</span><span class="p">,</span> <span class="mf">0.22287</span><span class="p">,</span> <span class="mf">0.22287</span><span class="p">,</span> <span class="mf">0.21284</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.10866</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.10866</span><span class="p">,</span>
               <span class="mf">0.19699</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5602</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5602</span><span class="p">,</span> <span class="mf">0.19699</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">qcout</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;charges&quot;</span><span class="p">][</span><span class="s2">&quot;nbo&quot;</span><span class="p">],</span> <span class="n">ans</span><span class="p">)</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">test_dir</span><span class="p">,</span> <span class="s2">&quot;tfsi_nbo.qcout&quot;</span><span class="p">)</span>
        <span class="n">qcout</span> <span class="o">=</span> <span class="n">QcOutput</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="p">[</span><span class="mf">2.2274</span><span class="p">,</span> <span class="mf">2.23584</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.94183</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.94575</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.94719</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.9423</span><span class="p">,</span>
               <span class="mf">0.86201</span><span class="p">,</span> <span class="mf">0.85672</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.35698</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.35373</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.35782</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.35647</span><span class="p">,</span>
               <span class="o">-</span><span class="mf">0.35646</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.35787</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.26555</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">qcout</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;charges&quot;</span><span class="p">][</span><span class="s2">&quot;nbo&quot;</span><span class="p">],</span> <span class="n">ans</span><span class="p">)</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">test_dir</span><span class="p">,</span> <span class="s2">&quot;crowd_nbo_charges.qcout&quot;</span><span class="p">)</span>
        <span class="n">qcout</span> <span class="o">=</span> <span class="n">QcOutput</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span>
            <span class="n">qcout</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;charges&quot;</span><span class="p">][</span><span class="s2">&quot;nbo&quot;</span><span class="p">],</span>
            <span class="p">[</span><span class="o">-</span><span class="mf">0.33917</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6104</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.15912</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.17751</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.61817</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3357</span><span class="p">,</span> <span class="mf">0.24671</span><span class="p">,</span>
             <span class="mf">0.19942</span><span class="p">,</span> <span class="mf">0.19325</span><span class="p">,</span> <span class="mf">0.2362</span><span class="p">,</span> <span class="mf">0.23982</span><span class="p">,</span> <span class="mf">0.21985</span><span class="p">,</span> <span class="mf">0.2305</span><span class="p">,</span> <span class="mf">0.20444</span><span class="p">,</span>
             <span class="mf">0.23179</span><span class="p">,</span> <span class="mf">0.20491</span><span class="p">,</span> <span class="mf">0.85965</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.59655</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.59561</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.14789</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.13859</span><span class="p">,</span>
             <span class="o">-</span><span class="mf">0.32712</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.33359</span><span class="p">,</span> <span class="mf">0.21602</span><span class="p">,</span> <span class="mf">0.22383</span><span class="p">,</span> <span class="mf">0.2123</span><span class="p">,</span> <span class="mf">0.22759</span><span class="p">,</span> <span class="mf">0.2507</span><span class="p">,</span>
             <span class="mf">0.20098</span><span class="p">,</span> <span class="mf">0.18631</span><span class="p">,</span> <span class="mf">0.24945</span><span class="p">,</span> <span class="mf">0.19709</span><span class="p">,</span> <span class="mf">0.20274</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.34831</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.56307</span><span class="p">,</span>
             <span class="o">-</span><span class="mf">0.14572</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1431</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.55866</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3572</span><span class="p">,</span> <span class="mf">0.22695</span><span class="p">,</span> <span class="mf">0.21983</span><span class="p">,</span> <span class="mf">0.1963</span><span class="p">,</span>
             <span class="mf">0.20977</span><span class="p">,</span> <span class="mf">0.22298</span><span class="p">,</span> <span class="mf">0.20875</span><span class="p">,</span> <span class="mf">0.21081</span><span class="p">,</span> <span class="mf">0.19586</span><span class="p">,</span> <span class="mf">0.24708</span><span class="p">,</span> <span class="mf">0.20067</span><span class="p">,</span>
             <span class="o">-</span><span class="mf">0.34288</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.55793</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.16806</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.15609</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.56464</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.34695</span><span class="p">,</span>
             <span class="mf">0.22555</span><span class="p">,</span> <span class="mf">0.20417</span><span class="p">,</span> <span class="mf">0.206</span><span class="p">,</span> <span class="mf">0.20825</span><span class="p">,</span> <span class="mf">0.22409</span><span class="p">,</span> <span class="mf">0.25415</span><span class="p">,</span> <span class="mf">0.20977</span><span class="p">,</span>
             <span class="mf">0.18976</span><span class="p">,</span> <span class="mf">0.24647</span><span class="p">,</span> <span class="mf">0.1993</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.33605</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.59395</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.15985</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.18024</span><span class="p">,</span>
             <span class="o">-</span><span class="mf">0.60646</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.32742</span><span class="p">,</span> <span class="mf">0.22909</span><span class="p">,</span> <span class="mf">0.19347</span><span class="p">,</span> <span class="mf">0.21872</span><span class="p">,</span> <span class="mf">0.2203</span><span class="p">,</span> <span class="mf">0.23518</span><span class="p">,</span>
             <span class="mf">0.25185</span><span class="p">,</span> <span class="mf">0.23523</span><span class="p">,</span> <span class="mf">0.18666</span><span class="p">,</span> <span class="mf">0.22737</span><span class="p">,</span> <span class="mf">0.2205</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.35902</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.56138</span><span class="p">,</span>
             <span class="o">-</span><span class="mf">0.14552</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.14903</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.55491</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3493</span><span class="p">,</span> <span class="mf">0.22826</span><span class="p">,</span> <span class="mf">0.21789</span><span class="p">,</span> <span class="mf">0.19075</span><span class="p">,</span>
             <span class="mf">0.20898</span><span class="p">,</span> <span class="mf">0.21343</span><span class="p">,</span> <span class="mf">0.21715</span><span class="p">,</span> <span class="mf">0.20794</span><span class="p">,</span> <span class="mf">0.19695</span><span class="p">,</span> <span class="mf">0.2429</span><span class="p">,</span> <span class="mf">0.18482</span><span class="p">,</span>
             <span class="o">-</span><span class="mf">0.33943</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.55659</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.16437</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.14503</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.56155</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.34131</span><span class="p">,</span>
             <span class="mf">0.22339</span><span class="p">,</span> <span class="mf">0.20483</span><span class="p">,</span> <span class="mf">0.19376</span><span class="p">,</span> <span class="mf">0.23395</span><span class="p">,</span> <span class="mf">0.20784</span><span class="p">,</span> <span class="mf">0.2096</span><span class="p">,</span> <span class="mf">0.21945</span><span class="p">,</span>
             <span class="mf">0.19192</span><span class="p">,</span> <span class="mf">0.23089</span><span class="p">,</span> <span class="mf">0.20493</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.32963</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.56949</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1446</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.15244</span><span class="p">,</span>
             <span class="o">-</span><span class="mf">0.55482</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.34848</span><span class="p">,</span> <span class="mf">0.22802</span><span class="p">,</span> <span class="mf">0.20471</span><span class="p">,</span> <span class="mf">0.19704</span><span class="p">,</span> <span class="mf">0.20744</span><span class="p">,</span> <span class="mf">0.22332</span><span class="p">,</span>
             <span class="mf">0.2206</span><span class="p">,</span> <span class="mf">0.20734</span><span class="p">,</span> <span class="mf">0.18871</span><span class="p">,</span> <span class="mf">0.22907</span><span class="p">,</span> <span class="mf">0.20741</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.33856</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.564</span><span class="p">,</span>
             <span class="o">-</span><span class="mf">0.16575</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.17422</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.56032</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3426</span><span class="p">,</span> <span class="mf">0.22585</span><span class="p">,</span> <span class="mf">0.20169</span><span class="p">,</span> <span class="mf">0.20529</span><span class="p">,</span>
             <span class="mf">0.20836</span><span class="p">,</span> <span class="mf">0.21329</span><span class="p">,</span> <span class="mf">0.25353</span><span class="p">,</span> <span class="mf">0.23374</span><span class="p">,</span> <span class="mf">0.19306</span><span class="p">,</span> <span class="mf">0.23582</span><span class="p">,</span> <span class="mf">0.20196</span><span class="p">,</span>
             <span class="o">-</span><span class="mf">0.34069</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.56522</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.17228</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.17503</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.55505</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.34264</span><span class="p">,</span>
             <span class="mf">0.22696</span><span class="p">,</span> <span class="mf">0.19604</span><span class="p">,</span> <span class="mf">0.20515</span><span class="p">,</span> <span class="mf">0.23964</span><span class="p">,</span> <span class="mf">0.2437</span><span class="p">,</span> <span class="mf">0.2111</span><span class="p">,</span> <span class="mf">0.21204</span><span class="p">,</span>
             <span class="mf">0.19975</span><span class="p">,</span> <span class="mf">0.2347</span><span class="p">,</span> <span class="mf">0.18835</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.34324</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.55184</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.16086</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.15907</span><span class="p">,</span>
             <span class="o">-</span><span class="mf">0.56319</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3384</span><span class="p">,</span> <span class="mf">0.23866</span><span class="p">,</span> <span class="mf">0.19808</span><span class="p">,</span> <span class="mf">0.19728</span><span class="p">,</span> <span class="mf">0.20205</span><span class="p">,</span> <span class="mf">0.24698</span><span class="p">,</span>
             <span class="mf">0.21416</span><span class="p">,</span> <span class="mf">0.20398</span><span class="p">,</span> <span class="mf">0.20475</span><span class="p">,</span> <span class="mf">0.2265</span><span class="p">,</span> <span class="mf">0.20141</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.34339</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.56344</span><span class="p">,</span>
             <span class="o">-</span><span class="mf">0.14955</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.14878</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.55906</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.34506</span><span class="p">,</span> <span class="mf">0.23937</span><span class="p">,</span> <span class="mf">0.20027</span><span class="p">,</span> <span class="mf">0.19671</span><span class="p">,</span>
             <span class="mf">0.2085</span><span class="p">,</span> <span class="mf">0.21693</span><span class="p">,</span> <span class="mf">0.22164</span><span class="p">,</span> <span class="mf">0.20863</span><span class="p">,</span> <span class="mf">0.20703</span><span class="p">,</span> <span class="mf">0.22889</span><span class="p">,</span> <span class="mf">0.1916</span><span class="p">])</span></div>

<div class="viewcode-block" id="TestQcOutput.test_simple_aimd"><a class="viewcode-back" href="../../../../pymatgen.io.tests.test_qchem.html#pymatgen.io.tests.test_qchem.TestQcOutput.test_simple_aimd">[docs]</a>    <span class="k">def</span> <span class="nf">test_simple_aimd</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">test_dir</span><span class="p">,</span> <span class="s2">&quot;h2o_aimd.qcout&quot;</span><span class="p">)</span>
        <span class="n">qcout</span> <span class="o">=</span> <span class="n">QcOutput</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">qcout</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;molecules&quot;</span><span class="p">]),</span> <span class="mi">11</span><span class="p">)</span></div>

<div class="viewcode-block" id="TestQcOutput.test_homo_lumo"><a class="viewcode-back" href="../../../../pymatgen.io.tests.test_qchem.html#pymatgen.io.tests.test_qchem.TestQcOutput.test_homo_lumo">[docs]</a>    <span class="k">def</span> <span class="nf">test_homo_lumo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">test_dir</span><span class="p">,</span> <span class="s2">&quot;quinoxaline_anion.qcout&quot;</span><span class="p">)</span>
        <span class="n">qcout</span> <span class="o">=</span> <span class="n">QcOutput</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">qcout</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;HOMO/LUMOs&quot;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                        <span class="p">[</span><span class="mf">1.00682120282</span><span class="p">,</span> <span class="mf">2.80277253758</span><span class="p">]):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertAlmostEqual</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">test_dir</span><span class="p">,</span> <span class="s2">&quot;qchem_energies&quot;</span><span class="p">,</span> <span class="s2">&quot;hf_ccsd(t).qcout&quot;</span><span class="p">)</span>
        <span class="n">qcout</span> <span class="o">=</span> <span class="n">QcOutput</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertArrayAlmostEqual</span><span class="p">(</span><span class="n">qcout</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;HOMO/LUMOs&quot;</span><span class="p">],</span>
                              <span class="p">[[</span><span class="o">-</span><span class="mf">17.741823053011334</span><span class="p">,</span> <span class="mf">5.224585929721129</span><span class="p">],</span>
                               <span class="p">[</span><span class="o">-</span><span class="mf">17.741823053011334</span><span class="p">,</span> <span class="mf">5.224585929721129</span><span class="p">]],</span> <span class="mi">4</span><span class="p">)</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">test_dir</span><span class="p">,</span> <span class="s2">&quot;crowd_gradient_number.qcout&quot;</span><span class="p">)</span>
        <span class="n">qcout</span> <span class="o">=</span> <span class="n">QcOutput</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertArrayAlmostEqual</span><span class="p">(</span>
            <span class="n">qcout</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;HOMO/LUMOs&quot;</span><span class="p">],</span> <span class="p">[[</span><span class="o">-</span><span class="mf">5.741602245683116</span><span class="p">,</span>
                                                        <span class="o">-</span><span class="mf">4.544301303455358</span><span class="p">],</span>
                                                       <span class="p">[</span><span class="o">-</span><span class="mf">4.9796834642654515</span><span class="p">,</span>
                                                        <span class="o">-</span><span class="mf">4.2993988379996795</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">4.761992383860404</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.8095939070883236</span><span class="p">]],</span> <span class="mi">4</span><span class="p">)</span></div>

<div class="viewcode-block" id="TestQcOutput.test_bsse"><a class="viewcode-back" href="../../../../pymatgen.io.tests.test_qchem.html#pymatgen.io.tests.test_qchem.TestQcOutput.test_bsse">[docs]</a>    <span class="k">def</span> <span class="nf">test_bsse</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">test_dir</span><span class="p">,</span> <span class="s2">&quot;bsse.qcout&quot;</span><span class="p">)</span>
        <span class="n">qcout</span> <span class="o">=</span> <span class="n">QcOutput</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertAlmostEqual</span><span class="p">(</span><span class="n">qcout</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;bsse&quot;</span><span class="p">],</span> <span class="o">-</span><span class="mf">0.164210762949</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">qcout</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;jobtype&quot;</span><span class="p">],</span> <span class="s2">&quot;bsse&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="TestQcOutput.test_hirshfeld_charge"><a class="viewcode-back" href="../../../../pymatgen.io.tests.test_qchem.html#pymatgen.io.tests.test_qchem.TestQcOutput.test_hirshfeld_charge">[docs]</a>    <span class="k">def</span> <span class="nf">test_hirshfeld_charge</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">test_dir</span><span class="p">,</span> <span class="s2">&quot;hirshfeld_population.qcout&quot;</span><span class="p">)</span>
        <span class="n">qcout</span> <span class="o">=</span> <span class="n">QcOutput</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">qcout</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;charges&quot;</span><span class="p">][</span><span class="s2">&quot;hirshfeld&quot;</span><span class="p">],</span>
                         <span class="p">[</span><span class="o">-</span><span class="mf">0.286309</span><span class="p">,</span> <span class="mf">0.143134</span><span class="p">,</span> <span class="mf">0.143176</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">qcout</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;has_error&quot;</span><span class="p">])</span></div>

<div class="viewcode-block" id="TestQcOutput.test_ghost_atoms"><a class="viewcode-back" href="../../../../pymatgen.io.tests.test_qchem.html#pymatgen.io.tests.test_qchem.TestQcOutput.test_ghost_atoms">[docs]</a>    <span class="k">def</span> <span class="nf">test_ghost_atoms</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">test_dir</span><span class="p">,</span> <span class="s2">&quot;ghost_atoms.qcout&quot;</span><span class="p">)</span>
        <span class="n">qcout</span> <span class="o">=</span> <span class="n">QcOutput</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="n">elements</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="o">.</span><span class="n">specie</span><span class="o">.</span><span class="n">symbol</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">qcout</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;molecules&quot;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">sites</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">elements</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">])</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">test_dir</span><span class="p">,</span> <span class="s2">&quot;MgBF4_b_overalpped.qcout&quot;</span><span class="p">)</span>
        <span class="n">qcout</span> <span class="o">=</span> <span class="n">QcOutput</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">qcout</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;input&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">ghost_atoms</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">])</span></div>

<div class="viewcode-block" id="TestQcOutput.test_final_energy"><a class="viewcode-back" href="../../../../pymatgen.io.tests.test_qchem.html#pymatgen.io.tests.test_qchem.TestQcOutput.test_final_energy">[docs]</a>    <span class="k">def</span> <span class="nf">test_final_energy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">test_dir</span><span class="p">,</span> <span class="s2">&quot;thiophene_wfs_5_carboxyl.qcout&quot;</span><span class="p">)</span>
        <span class="n">qcout</span> <span class="o">=</span> <span class="n">QcOutput</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">qcout</span><span class="o">.</span><span class="n">final_energy</span><span class="p">,</span> <span class="o">-</span><span class="mf">20180.15180854295</span><span class="p">)</span></div>

<div class="viewcode-block" id="TestQcOutput.test_final_structure"><a class="viewcode-back" href="../../../../pymatgen.io.tests.test_qchem.html#pymatgen.io.tests.test_qchem.TestQcOutput.test_final_structure">[docs]</a>    <span class="k">def</span> <span class="nf">test_final_structure</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">test_dir</span><span class="p">,</span> <span class="s2">&quot;thiophene_wfs_5_carboxyl.qcout&quot;</span><span class="p">)</span>
        <span class="n">qcout</span> <span class="o">=</span> <span class="n">QcOutput</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;Full Formula (H4 C5 S1 O2)</span>
<span class="s1">Reduced Formula: H4C5SO2</span>
<span class="s1">Charge = -1, Spin Mult = 2</span>
<span class="s1">Sites (12)</span>
<span class="s1">0 C     0.194695    -0.158362    -0.001887</span>
<span class="s1">1 C    -0.535373    -1.381241    -0.001073</span>
<span class="s1">2 C    -1.927071    -1.199274    -0.000052</span>
<span class="s1">3 C    -2.332651     0.131916     0.000329</span>
<span class="s1">4 S    -0.942111     1.224916    -0.001267</span>
<span class="s1">5 H    -0.038260    -2.345185    -0.001256</span>
<span class="s1">6 H    -2.636299    -2.025939     0.000620</span>
<span class="s1">7 H    -3.339756     0.529895     0.001288</span>
<span class="s1">8 C     1.579982     0.071245    -0.002733</span>
<span class="s1">9 O     2.196383     1.165675    -0.000178</span>
<span class="s1">10 O     2.352341    -1.114671     0.001634</span>
<span class="s1">11 H     3.261096    -0.769470     0.003158&#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">qcout</span><span class="o">.</span><span class="n">final_structure</span><span class="o">.</span><span class="n">__str__</span><span class="p">(),</span> <span class="n">ans</span><span class="p">)</span></div>

<div class="viewcode-block" id="TestQcOutput.test_time_nan_values"><a class="viewcode-back" href="../../../../pymatgen.io.tests.test_qchem.html#pymatgen.io.tests.test_qchem.TestQcOutput.test_time_nan_values">[docs]</a>    <span class="k">def</span> <span class="nf">test_time_nan_values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">test_dir</span><span class="p">,</span> <span class="s2">&quot;time_nan_values.qcout&quot;</span><span class="p">)</span>
        <span class="n">qcout</span> <span class="o">=</span> <span class="n">QcOutput</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">qcout</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;has_error&quot;</span><span class="p">])</span></div>

<div class="viewcode-block" id="TestQcOutput.test_pcm_solvent_deprecated"><a class="viewcode-back" href="../../../../pymatgen.io.tests.test_qchem.html#pymatgen.io.tests.test_qchem.TestQcOutput.test_pcm_solvent_deprecated">[docs]</a>    <span class="k">def</span> <span class="nf">test_pcm_solvent_deprecated</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">test_dir</span><span class="p">,</span> <span class="s2">&quot;pcm_solvent_deprecated.qcout&quot;</span><span class="p">)</span>
        <span class="n">qcout</span> <span class="o">=</span> <span class="n">QcOutput</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">qcout</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;has_error&quot;</span><span class="p">])</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;pcm_solvent deprecated&#39;</span><span class="p">,</span>
               <span class="s1">&#39;Molecular charge is not found&#39;</span><span class="p">,</span>
               <span class="s1">&#39;No input text&#39;</span><span class="p">,</span>
               <span class="s1">&#39;Bad SCF convergence&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">qcout</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;errors&quot;</span><span class="p">],</span> <span class="n">ans</span><span class="p">)</span></div>

<div class="viewcode-block" id="TestQcOutput.test_qc43_batch_job"><a class="viewcode-back" href="../../../../pymatgen.io.tests.test_qchem.html#pymatgen.io.tests.test_qchem.TestQcOutput.test_qc43_batch_job">[docs]</a>    <span class="k">def</span> <span class="nf">test_qc43_batch_job</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">test_dir</span><span class="p">,</span> <span class="s2">&quot;qchem43_batch_job.qcout&quot;</span><span class="p">)</span>
        <span class="n">qcout</span> <span class="o">=</span> <span class="n">QcOutput</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">qcout</span><span class="o">.</span><span class="n">data</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">qcout</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;scf_iteration_energies&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]),</span> <span class="mi">22</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="s2">&quot;pcm_solvent deprecated&quot;</span> <span class="ow">in</span> <span class="n">qcout</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;errors&quot;</span><span class="p">])</span></div>

<div class="viewcode-block" id="TestQcOutput.test_output_file_wierd_encoding"><a class="viewcode-back" href="../../../../pymatgen.io.tests.test_qchem.html#pymatgen.io.tests.test_qchem.TestQcOutput.test_output_file_wierd_encoding">[docs]</a>    <span class="k">def</span> <span class="nf">test_output_file_wierd_encoding</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">test_dir</span><span class="p">,</span> <span class="s2">&quot;ferrocenium_1pos.qcout&quot;</span><span class="p">)</span>
        <span class="n">qcout</span> <span class="o">=</span> <span class="n">QcOutput</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">qcout</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;has_error&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">qcout</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;frequencies&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;frequency&quot;</span><span class="p">],</span> <span class="o">-</span><span class="mf">157.11</span><span class="p">)</span></div>

<div class="viewcode-block" id="TestQcOutput.test_homo_lumo_nan_values"><a class="viewcode-back" href="../../../../pymatgen.io.tests.test_qchem.html#pymatgen.io.tests.test_qchem.TestQcOutput.test_homo_lumo_nan_values">[docs]</a>    <span class="k">def</span> <span class="nf">test_homo_lumo_nan_values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">test_dir</span><span class="p">,</span> <span class="s2">&quot;homo_lumo_nan_values.qcout&quot;</span><span class="p">)</span>
        <span class="n">qcout</span> <span class="o">=</span> <span class="n">QcOutput</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">qcout</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;has_error&quot;</span><span class="p">])</span></div>

<div class="viewcode-block" id="TestQcOutput.test_ordinal_not_in_range"><a class="viewcode-back" href="../../../../pymatgen.io.tests.test_qchem.html#pymatgen.io.tests.test_qchem.TestQcOutput.test_ordinal_not_in_range">[docs]</a>    <span class="k">def</span> <span class="nf">test_ordinal_not_in_range</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">test_dir</span><span class="p">,</span> <span class="s2">&quot;ordinal_not_in_range.qcout.gz&quot;</span><span class="p">)</span>
        <span class="n">qcout</span> <span class="o">=</span> <span class="n">QcOutput</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">qcout</span><span class="o">.</span><span class="n">data</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span></div>

<div class="viewcode-block" id="TestQcOutput.test_aux_mpi_time_in_the_end_of_job"><a class="viewcode-back" href="../../../../pymatgen.io.tests.test_qchem.html#pymatgen.io.tests.test_qchem.TestQcOutput.test_aux_mpi_time_in_the_end_of_job">[docs]</a>    <span class="k">def</span> <span class="nf">test_aux_mpi_time_in_the_end_of_job</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">test_dir</span><span class="p">,</span> <span class="s2">&quot;aux_mpi_time_mol.qcout&quot;</span><span class="p">)</span>
        <span class="n">qcout</span> <span class="o">=</span> <span class="n">QcOutput</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">qcout</span><span class="o">.</span><span class="n">data</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span></div></div>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">unittest</span><span class="o">.</span><span class="n">main</span><span class="p">()</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../../index.html">pymatgen 4.5.2 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../../index.html" >Module code</a> &#187;</li> 
      </ul>
    </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2011, Pymatgen Development Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.8.
    </div>
<div class="footer">This page uses <a href="http://analytics.google.com/">
Google Analytics</a> to collect statistics. You can disable it by blocking
the JavaScript coming from www.google-analytics.com.
<script type="text/javascript">
  (function() {
    var ga = document.createElement('script');
    ga.src = ('https:' == document.location.protocol ?
              'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    ga.setAttribute('async', 'true');
    document.documentElement.firstChild.appendChild(ga);
  })();
</script>
</div>

  </body>
</html>